/*! jworg-content-theme - v0.1.0 - 2025-01-01 03:43:44 PM GMT+0000 */
!function(){"use strict";var a,b,c,d,e,f={},g={};a=function(a){this.message=a},a.prototype=$.extend(new Error,{name:"Module Exception"}),e=function(a){return new(b(a))},c=function(b,c){if(!c)return void delete f[b];if(f.hasOwnProperty(b))throw new a("Cannot redefine module with name '"+b+"'.");f[b]=c},d=function(a){return g.hasOwnProperty(a)||(g[a]=e(a)),g[a]},b=function(b){if(!f.hasOwnProperty(b))throw new a("Module with name '"+b+"' has not been defined.");return f[b]},window.jscore={},window.module=window.jscore.module={construct:e,define:c,get:d,require:b}}(),function(){"use strict";function a(){var a=_.toArray(arguments);return _.reduce(a,function(a,b){return b?0===a.length?b:("/"!==a[a.length-1]&&(a+="/"),"/"===b[0]&&(b=b.slice(1)),a+b):a},"")}function b(b){var d,e,f,g=$("base"),h=g.attr("href")||"";return g.length>0&&(d=c(h)),!b.origin&&d&&(b.origin=d.origin),b.path&&"/"!==b.path[0]&&(b.path=d?a(d.path,b.path):a(window.location.pathname,b.path)),e=query.build(b.query)||"",b.hash?(f=b.hash.path||"",f+=query.build(b.hash.query)||"",f=f.length?"#"+f:""):f="",a(b.origin,b.path)+e+f}function c(a){var b,c=e.exec(a||window.location.href),d={},f={};if(c=c||[],b=c[8]?c[8].split("?"):[],c[6])try{d=query.parse({rebuild:!0,query:c[6]})}catch(a){d={}}if(b[1])try{f=query.parse({rebuild:!0,query:b[1]})}catch(a){f={}}return c={origin:c[1],path:c[4],query:d,hash:{path:b[0],query:f}}}function d(a){var b=c(window.location),d=b.path.split("/"),e=new RegExp("/#|jw.org|^"+b.origin+"|^/"+d[1],"g");return a&&!a.match(e)}var e=/^((https?):\/\/([^\/]+)){0,1}([^?#]+){0,1}(\?([^#]+)){0,1}(\#(.+)){0,1}$/;jscore.module.define("url",{build:b,parse:c,join:a,isExternal:d})}(),function(){"use strict";var a,b,c,d,e=$("body").data("ui-core-settings")||{};a=_.extend({},e),b=function(a){var b=$("#pageConfig");return a=a.toLowerCase(),b.data(a)},c=function(b){var c=a[b];return"function"==typeof c&&(c=c()),c},d=function(b){a=_.extend(a,b)},jscore.module.define("settings",{getPageConfig:b,getSetting:c,setSettings:d})}(),function(){"use strict";var a=module.require("settings");a.setSettings({ARCHIVE_MIMETYPE:"application/zip",AUDIO_FORMATS:"MP3,AAC",AUDIO_STREAM_FORMAT:"MP3",AUDIO_STREAM_MIMETYPE:"audio/mpeg",VIDEO_FORMATS:"MP4,M4V,3GP",VIDEO_STREAM_MIMETYPES:["video/mp4","video/x-m4v","video/x-w4v"],WINDOW_WIDTH:640,WINDOW_HEIGHT:600,TEXT_HIGHLIGHT_CLASS:"jwac-textHighlight",DEPRECATED_HIGHLIGHT_CLASS:"highlight",DEPRECATED_HIGHLIGHT_ADD_CLASS:"addHighlight",IMAGE_GALLERY_IMAGE_RATIO:.625,BASE_URL:function(){return $("base").attr("href")},DOWNLOAD_WINDOW_URL:function(){return a.getSetting("BASE_URL")+"download/"},IS_MOBILE_LAYOUT:function(){return window.innerWidth<520},IS_SMALL_LAYOUT:function(){return window.innerWidth<760},IS_RTL:function(){return $("body").hasClass("dir-rtl")},VIDEO_THUMBNAIL:function(){return a.getPageConfig("ASSETS_BASE_URL")+"/images/video_placeholder.png"},VIDEO_BLANK_POSTER:function(){return a.getPageConfig("ASSETS_BASE_URL")+"/images/video_poster.png"},COVER_IMAGE:function(){return a.getPageConfig("ASSETS_BASE_URL")+"/images/cvr_placeholder.jpg"},TEMPLATE_URL:function(){return a.getPageConfig("ASSETS_BASE_URL")+"/templates/"},PAGE_ID:function(){return $("body").attr("id")}})}(),function(){"use strict";var a={isAndroid:function(){return!!navigator.userAgent.match(/Android/i)},isFlashInstalled:function(){try{if(new ActiveXObject("ShockwaveFlash.ShockwaveFlash"))return!0}catch(a){if(void 0!==navigator.mimeTypes["application/x-shockwave-flash"])return!0}return!1},isIOS:function(){return!!navigator.userAgent.match(/(iPad|iPhone|iPod)/i)},isIE:function(){var a=navigator.userAgent,b=!!a.match(/MSIE/i),c=!!a.match(/Trident\/7\./i);return b||c},isFF:function(){return navigator.userAgent.toLowerCase().indexOf("firefox")>-1},isWindowsPhone:function(){return navigator.userAgent.toLowerCase().indexOf("windows phone")>-1},supportsAudioMuteControl:function(){var a=document.createElement("audio"),b=!0;return a.muted=!0,b=b&&a.muted,a.muted=!1,b=b&&!a.muted},supportsHTML5Video:function(){var a=Modernizr.video.h264||"";return a=!!a.replace(/no/,"")},supportsMP3Audio:function(){return!!(Modernizr.audio.mp3||"").replace(/no/,"")},supportsTemplating:function(){var a=$("html"),b=a.hasClass("ie7");return!a.hasClass("ie6")&&!b}};jscore.module.define("browser",a)}(),function(){"use strict";var a,b={};a={listen:function(a,c){return b.hasOwnProperty(a)||(b[a]=[]),-1===b[a].indexOf(c)&&b[a].push(c),this},stopListening:function(a,c){b.hasOwnProperty(a)&&(c||delete b[a],b[a]=_.reject(b[a],function(a){return c===a}))},send:function(a,c){if(b.hasOwnProperty(a)){var d;for(d=0;d<b[a].length;d++)(0,b[a][d])(c)}return this}},jscore.module.define("signal",a)}(),function(){"use strict";var a=function(a){return a=a||"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",a.replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"===a?b:3&b|8).toString(16)})};jscore.module.define("guid",{generate:a})}(),function(){"use strict";var a,b,c=module.require("url"),d=module.require("settings"),e={},f="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest;b=function(a){if(e.hasOwnProperty(a))return e[a]},a=function(a,b){e[a]=b},$.getJSONCached=function(a,b){var d=c.parse(a),e=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""),g=d.origin&&d.origin!==e,h=!f&&g;return $.getCached(a,h?"jsonp":"json",b)},$.getCached=function(c,e,f){var g,h=b(c);return h||(g={url:c,dataType:e},h=f&&f.includeJWT?$.get(d.getPageConfig("JWT_LOCATION")).then(function(a){return g.headers={Authorization:"Bearer "+a.trim()},$.ajax(g)}):$.ajax(g),a(c,h),h)}}(),function(){"use strict";var a,b,c={};a=function(a){if(void 0===window.JSON)return c[a];var b=Modernizr.localstorage?window.localStorage[a]:$.cookie(a);if(void 0!==b&&null!==b)return window.JSON.parse(b)},b=function(a,b){if(void 0===window.JSON)return void(c[a]=b);var d=window.JSON.stringify(b);if(!Modernizr.localstorage)return void $.cookie(a,d);try{window.localStorage[a]=d}catch(a){}},$.storedData=function(c,d){if(void 0===c.substr)throw new TypeError("$.storedData key should be a string");return void 0===d?a(c):(b(c,d),this)},$.removeStoredData=function(a){if(void 0===window.JSON)return delete c[a],this;if(!Modernizr.localstorage)return $.removeCookie(a),this;try{delete window.localStorage[a]}catch(a){}return this}}(),function(){"use strict";$.fn.exists=function(){return this.length>0},String.prototype.format=function(){var a,b=Array.prototype.slice.call(arguments),c=this.split("%s"),d="";for(a=0;a<c.length;a++)d+=c[a],d+=void 0===b[a]||null===b[a]?"":b[a];return d},$.fn.getAttributes=function(a,b,c){c=void 0===c||c;var d=c?{}:[];return this.length?($.each(this[0].attributes,function(e,f){if(void 0===a||0===f.name.indexOf(a))if(c){var g=f.name;void 0!==a&&b&&(g=f.name.substr(a.length)),d[g]=f.value}else d.push(f.value)}),d):this}}(),function(){"use strict";var a,b=jscore.module.require("settings"),c=jscore.module.require("guid"),d=!1;try{Object.defineProperty({},"test",{get:function(){},set:function(){}}),d=!0}catch(a){}a=Class.extend({TEMPLATE_NAME:"",init:function(){this.id=this.__createID()},on:function(a,b){$(this).on(a,b)},trigger:function(a,b){$(this).trigger(a,b)},_buildStateContext:function(){return{}},_draw:function(){var a,b,c=this,e=this._prepareTemplateContext(),f=$.proxy(this._injectHTML,this),g=$.proxy(this._onFirstRender,this);return a=function(a){return c._renderTemplate(a).then(f).then(function(){c.trigger("UIController:injectedHTML",a)})},this._redraw=function(){return d?c.__formalityPromise():a(b)},e.then(function(c){return b=c,a(c).then(function(){g(b)})})},_injectHTML:function(a){return this.html=a,this.html},_loadTemplate:function(){return this._fetchTemplate(this.TEMPLATE_NAME)},_fetchTemplate:function(a){var c=b.getSetting("TEMPLATE_URL")+a+".html";return $.getCached(c,"html",!0)},_onFirstRender:function(){},_prepareTemplateContext:function(){var a,b=this;return a=this._buildStateContext(),this._resolveDeferrends(a).then(function(a){return{state:a,controller:b,literals:_t.literals}})},_redraw:function(){return this.__formalityPromise()},_renderTemplate:function(a){return this._loadTemplate().then(function(b){return b=$(b),rivets.bind(b,a),b})},_resolveDeferrends:function(a){var b,c=$.proxy(this._resolveDeferrends,this),d=[];return _.isObject(a)?a.then?a.then(c):(d=_.map(a,function(a,b,d){var e=function(a){d[b]=a};if(a)return a.then?a.then(c).then(e):_.isObject(a)?c(a).then(e):void 0}),$.when.apply($,d).then(function(){return a})):(b=new $.Deferred,b.resolve(a),b)},__createID:function(){return"controller-"+c.generate("xxxxxxxx")},__formalityPromise:function(a){var b=new $.Deferred;return b.resolve(a),b}}),rivets.binders.html=function(a,b){return $(a).html(b||"")},rivets.binders["data-*"]=function(a,b){return void 0!==b?a.setAttribute(this.type,""+b):a.removeAttribute(this.type)},d||(rivets.adapters["."].subscribe=function(){},rivets.adapters["."].unsubscribe=function(){}),jscore.module.define("UIController",a)}(),function(){"use strict";var a,b=jscore.module.require("browser");a=Class.extend({init:function(a){this.resource=a,this.useAkamaiProvider=!1,this.posterImage=""},build:function(a,b,c){var d=this;return this.resource.listFiles(a,b).then(function(a){var b,e=_.groupBy(a,"track");return b=_.reduce(e,function(a,b){return a.concat(d.__filterPlaylistFiles(b,c))},[]),b=d.__convertPlaylistSchema(b)})},setPosterImage:function(a){this.posterImage=a},__convertPlaylistSchema:function(a){var b,c=this;return a=_.groupBy(a,"track"),a=_.map(a,function(a){var d={title:a[0].title,booknum:a[0].booknum,track:a[0].track,image:c.posterImage,duration:Math.round(a[0].duration)};return d.sources=_.map(a,function(a){var b;return c.useAkamaiProvider&&a.file.stream?b=a.file.stream:(b=a.file.url,c.useAkamaiProvider=!1),{height:a.frameHeight,width:a.frameWidth,bitrate:Math.round(a.bitRate),label:a.label,mimeType:a.mimetype,file:b}}),d.sources=_.sortBy(d.sources,"height").reverse(),d.markers=_.reduce(a,function(a,b){return a||(b.markers?b.markers.markers:void 0)},void 0),b=_.chain(a).sortBy("frameWidth").reverse().find(function(a){return!!a.subtitles}).value(),b&&!b.subtitled&&(d.tracks=[{file:b.subtitles.url,kind:"captions",default:!1}]),d.markers=_.map(d.markers||[],function(a){var b={};return b.startTime=c.__parseMarkerTime(a.startTime),b.duration=c.__parseMarkerTime(a.duration),b.endTime=b.startTime+b.duration,_.extend({},a,b)}),d}),a=_.map(a,function(a){return a.provider="",a})},__filterPlaylistFiles:function(a,c){var d,e,f,g,h,i=this;return c=!!c,d=_.groupBy(a,"subtitled"),e=d.true,f=d.false,h=_.reduce(a,function(a,b){return a||!!b.subtitles},!1),g=c&&!h?e||f:f||e,_.filter(g,function(a){return i.useAkamaiProvider=i.__isVideo(a.mimetype)&&!b.supportsHTML5Video()&&b.isFlashInstalled(),!(i.useAkamaiProvider&&a.frameHeight>=720)&&"application/zip"!==a.mimetype})},__isVideo:function(a){return-1!==a.indexOf("video/")},__parseMarkerTime:function(a){var b=a.split(":"),c=parseFloat(b.pop(),10),d=parseInt(b.pop(),10);return 60*parseInt(b.pop(),10)*60+60*d+c}}),jscore.module.define("MediaPlaylist",a)}(),function(){"use strict";var a,b,c=jscore.module.require("MediaPlaylist");a=["MP3","MP4","PDF","EPUB","JWPUB","RTF","TXT","BRL","BES","DAISY","EXE","UPDATEPKG","ISO","ZIP"],b=Class.extend({SUBTITLES_NONE:1,SUBTITLES_ONLY:2,SUBTITLES_BOTH:3,SUBTITLES_TTS:4,init:function(a){this.sourceURL=a,this.pageID=null,this.statusCode=0,this.dataset=null,this.posterImage=null},getFormattedDate:function(){return this.__fetch().then(function(a){return a.dataset.formattedDate})},getPlaylist:function(){var a,b=new c(this);return this.posterImage?b.setPosterImage(this.posterImage):this.pageID&&(a=$(".jsVideoPoster").filter("."+this.pageID).data("src"),b.setPosterImage(a)),b},getLanguage:function(a){return this.__fetch().then(function(b){return a=b.__languageCode(a),a=b.dataset.languages[a]})},getLanguageLocaleCode:function(a){return this.getLanguage(a).then(function(a){return a?a.locale:""})},getLanguageDirection:function(a){return this.getLanguage(a).then(function(a){return a?a.direction:""})},getLanguageName:function(a){return this.getLanguage(a).then(function(a){return a?a.name:""})},getParentPubName:function(){return this.__fetch().then(function(a){return a.dataset.parentPubName})},getPubName:function(){return this.__fetch().then(function(a){return a.dataset.pubName})},hasSubtitles:function(a,b){var c=this;return this.listFiles(a,b).then(function(a){var b,d,e;return b=_.find(a,function(a){return _.has(a,"subtitles")}),_.isEmpty(b)?(a=_.groupBy(a,"subtitled"),d=a.true,e=a.false,d&&e?c.SUBTITLES_BOTH:d?c.SUBTITLES_ONLY:c.SUBTITLES_NONE):c.SUBTITLES_TTS})},isSingleFile:function(){var a=this;return this.listLanguages().then(function(b){return!(Object.keys(b).length>1)&&a.__getLanguageDataset(0).then(function(a){var b,c;return b=Object.keys(a),!(b.length>1)&&(c=a[b[0]],!(c.length>1)&&c[0].file.url)})})},listAllFiles:function(a){return this.__getLanguageDataset(a).then(function(a){return a=a||{},_.reduce(a,function(a,b,c){var d=[];return b=b||[],b=_.map(b,function(a){return a.fileType=c,a}),d=_.filter(b,function(a){return a.file.url.length>0}),d.length>0&&(a=a.concat(d)),a},[])})},listFiles:function(a,b){return b=b||0,this.__getLanguageDataset(a).then(function(a){return _.isNumber(b)&&(b=Object.keys(a)[b]),a=a[b]||[],a=_.filter(a,function(a){return a.file.url.length>0})})},listFileTypes:function(a){return this.__getLanguageDataset(a).then(function(a){return b.sortFileFormats(_.keys(a))})},listLanguages:function(){return this.__fetch().then(function(a){var b,c=Object.keys(a.dataset.files);return b=_.map(a.dataset.languages,function(b,c){return b.code=c,b.isPrimary=void 0===a.dataset.files[b.code].__deferred,b}),b=_.sortBy(b,function(a){return c.indexOf(a.code)})})},listFrameHeights:function(a,b){return this.listFiles(a,b).then(function(a){var b,c,d=[];for(c=0;c<a.length;c++)b=a[c],-1===d.indexOf(b.frameHeight)&&d.push(b.frameHeight);return d.sort(function(a,b){return b-a}),d})},listTrackNums:function(a,b){return this.listFiles(a,b).then(function(a){var b,c,d=[];for(c=0;c<a.length;c++)b=a[c],-1===d.indexOf(b.track)&&d.push(b.track);return d.sort(function(a,b){return a-b}),d})},setPageID:function(a){this.pageID=a||null},setPosterImage:function(a){this.posterImage=a},__fetch:function(){if(this.__fetching)return this.__fetching;var a,c=this,d=new $.Deferred;return this.__fetching=d,this.sourceURL?(a=$.getJSONCached(this.sourceURL,{includeJWT:!0}),a.done(function(e){var f,g,h,i,j=function(a){return!!a.__deferred},k=0;if(c.statusCode=a.status,c.dataset=e,_.each(c.dataset.languages,function(a,b){c.dataset.languages[b].index=k++,c.dataset.languages[b].code=b}),g=Object.keys(c.dataset.files),f=_.filter(c.dataset.files,j),f.length<g.length)return void d.resolve(c);i=_.first(g),c.dataset.files[i]||d.reject(c),h=new b(c.dataset.files[i].__deferred),h.__getLanguageDataset(i).then(function(a){c.dataset.files[i]=a,d.resolve(c)})}),a.fail(function(){c.statusCode=a.status,c.dataset=void 0,d.reject(c)}),d):(d.reject(this),d)},__getLanguageDataset:function(a){return a=a||0,this.__fetch().then(function(c){a=c.__languageCode(a);var d,e,f=c.dataset.files[a].__deferred;return f?(d=new b(f),e=d.__fetch().then(function(b){return b.dataset.files[a]})):(e=new $.Deferred,e.resolve(c.dataset.files[a])),e})},__languageCode:function(a){return _.isFinite(parseInt(a,10))&&(a=_.find(this.dataset.languages,function(b){return b.index===a}).code),a}}),b.sortFileFormats=function(b){var c=0;return b=_.sortBy(b,function(b){var c=a.indexOf(b);return c>-1?c:a.length}),b=_.map(b,function(a){return{name:a,index:c++}})},jscore.module.define("PubMediaResource",b)}(),function(){"use strict";var a,b=module.require("PubMediaResource");a=b.extend({init:function(a,b,c){this._super(a),this.start=b,this.end=c},_filterFiles:function(a){return _.filter(a,function(a){var b,c=!0,d=this,e=this.start.book!==this.end.book||this.start.chapter!==this.end.chapter;return c&=!!a.markers,c&=a.booknum>=this.start.book,c&=a.booknum<=this.end.book,c&=a.booknum!==this.start.book||a.track>=this.start.chapter,!!(c&=a.booknum!==this.end.book||a.track<=this.end.chapter)&&(b=_.pluck(a.markers.markers,"verseNumber"),a.booknum===this.start.book&&a.track===this.start.chapter&&(c&=_.any(b,function(a){return a>=d.start.verse&&(e||a<=d.end.verse)})),a.booknum===this.end.book&&a.track===this.end.chapter&&(c&=_.any(b,function(a){return a<=d.end.verse&&(e||a>=d.start.verse)})),c)},this)},_setStartEndMarkers:function(a){var b,c,d=this;return _.chain(a).sortBy("track").sortBy("booknum").each(function(a){a.booknum===d.start.book&&a.track===d.start.chapter?b=_.chain(a.markers.markers).sortBy("verseNumber").find(function(a){return a.verseNumber>=d.start.verse}).value():b||(b=_.chain(a.markers.marker).sortBy("verseNumber").first().value()),c=a.booknum===d.end.book&&a.track===d.end.chapter?_.chain(a.markers.markers).sortBy("verseNumber").reverse().find(function(a){return a.verseNumber<=d.end.verse}).value():_.chain(a.markers.marker).sortBy("verseNumber").last().value()||c}),this.startMarker=b,this.endMarker=c,a},listFiles:function(a,b){return this._super(a,b).then(this._filterFiles.bind(this)).then(this._setStartEndMarkers.bind(this))}}),module.define("BibleVerseRangeResource",a)}(),function(){"use strict";var a,b,c,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";b=function(a){var b,c,d;for(a=a.replace(/\x0d\x0a/g,"\n"),b="",c=0;c<a.length;c++)d=a.charCodeAt(c),d<128?b+=String.fromCharCode(d):d>127&&d<2048?(b+=String.fromCharCode(d>>6|192),b+=String.fromCharCode(63&d|128)):(b+=String.fromCharCode(d>>12|224),b+=String.fromCharCode(d>>6&63|128),b+=String.fromCharCode(63&d|128));return b},c=function(a){for(var b="",c=0,d=0,e=0,f=0;c<a.length;)d=a.charCodeAt(c),d<128?(b+=String.fromCharCode(d),c++):d>191&&d<224?(e=a.charCodeAt(c+1),b+=String.fromCharCode((31&d)<<6|63&e),c+=2):(e=a.charCodeAt(c+1),f=a.charCodeAt(c+2),b+=String.fromCharCode((15&d)<<12|(63&e)<<6|63&f),c+=3);return b},a={encode:function(a){var c,e,f,g,h,i,j,k="",l=0;for(a=b(a);l<a.length;)c=a.charCodeAt(l++),e=a.charCodeAt(l++),f=a.charCodeAt(l++),g=c>>2,h=(3&c)<<4|e>>4,i=(15&e)<<2|f>>6,j=63&f,isNaN(e)?i=j=64:isNaN(f)&&(j=64),k=k+d.charAt(g)+d.charAt(h)+d.charAt(i)+d.charAt(j);return k},decode:function(a){var b,e,f,g,h,i,j,k="",l=0;for(a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");l<a.length;)g=d.indexOf(a.charAt(l++)),h=d.indexOf(a.charAt(l++)),i=d.indexOf(a.charAt(l++)),j=d.indexOf(a.charAt(l++)),b=g<<2|h>>4,e=(15&h)<<4|i>>2,f=(3&i)<<6|j,k+=String.fromCharCode(b),64!==i&&(k+=String.fromCharCode(e)),64!==j&&(k+=String.fromCharCode(f));return k=c(k)}},jscore.module.define("base64",a)}(window,window.document),function(){"use strict";function a(a,b){return b(a)}function b(a){d.push(a)}var c,d=[];c=function(a){return a},c.literals={},window._t||(window._t=c),module.define("i18n",{addTranslationStringFilter:b,runFilters:function(){0!==d.length&&(window._t.literals=_.mapObject(window._t.literals,function(b){return _.mapObject(b,function(b){return d.reduce(a,b)})}))}})}(),function(){"use strict";var a,b,c=module.require("settings");a=new window.LegalNoticesClient.LegalNoticesClient({languageCode:c.getPageConfig("WT_LANG"),languageClassesMaker:function(a){return"jwac ml-"+a.languageCode+" ms-"+a.script+" dir-"+a.direction},i18nURL:c.getPageConfig("I18N_API_URL"),finderURL:(c.getPageConfig("OPEN_BASE_LINK")||"").split("?")[0]}),b={lib:window.LegalNoticesClient,client:a,canPersistFunctional:function(){return a.canPersistType(window.LegalNoticesClient.CookieDataTypes.FUNCTIONAL)},callIfFunctionalAllowed:function(b,c){return a.callIfAllowed(window.LegalNoticesClient.CookieDataTypes.FUNCTIONAL,b,c)},listenForPrivacySettingsClick:function(a,c){a.find('a[href*="/finder?docid=1011512"], a[href*="/open?docid=1011512"]').click(function(a){a.preventDefault(),c(),b.client.showSettings()}.bind(this))}},module.define("legalNotices",b)}(),module.define("setupClientComponents",function(){"use strict";function a(){return f.initialize(f.vendor.$("body"))}var b,c,d,e,f=window.ClientComponents,g=module.require("signal"),h=module.require("settings"),i=module.require("legalNotices"),j=module.require("LanguageUtils"),k=module.require("FeatureDisabledModal"),l=!1,m=!1,n=h.getPageConfig("ASSETS_BASE_URL")+"/client-components";return d=new f.ConfigBuilder,function(){return c=f.i18n.BaseTranslationStringsProvider.deprecatedExtend({_loadStringsImpl:function(a){var b=h.getPageConfig("WT_LANG");if(a){if(a!==b)throw new Error('TranslationStringsProvider tried to load translation strings for languageID "'+a+'", but the page language is "'+b+'" and so only translation strings for "'+b+'" are available.')}else a=b;return Promise.resolve(_.reduce(window._t.literals.CMSJSUISTR,function(a,b,c){return _.isEmpty(b)||(a[c]=b),a},{}))}}),e=d.enableComponentBundle("all").setLocaleToLanguageIDMapper(function(a){var b='[class^="ml-"][lang="'+a+'"],[class*=" ml-"][lang="'+a+'"]',c=j.getLanguageCodeFromElement($(b));return c||a!==h.getPageConfig("CONTENT_LANG")||(c=h.getPageConfig("WT_LANG")),c}).setTranslationStringsProvider(new c).enableInsightEvents().setInsightConfigProvider(function(){return{endpoint:h.getPageConfig("INSIGHT_EVENTS_URL"),system:"jworg",contextID:$("body").data("insight-context-id"),contextLanguageID:h.getPageConfig("WT_LANG"),referrer:window.history.state?window.history.state.insightEventReferrer:void 0,retainedHashFragments:[/^media(\/\d{1,2})?$/]}}).setAssetsFolderURL(n).setCanAccessCookieDataType(i.client.canPersistType.bind(i.client)).getConfiguration(),b=f.initializers.Base.deprecatedExtend({doInitialization:function(){return Promise.resolve().then(function(){l=!0,g.send("DOMReady"),l=!1})},runBefore:function(){return["FlipbookAnimation","FlipbookGallery"]},runAfter:function(){return["LessonApp"]}}),e.components.DOMReadyInitializer={initializer:b},e.components.Lesson={onInstantiated:function(a){a.receiver().receive("lessonSlideShowing",function(){g.send("CloseAllModals")})}},e.components.LessonAudioModeButton={onInstantiated:function(a){var b=!1;a.receiver().receive("playingMedia",function(){b=!0,g.send("requestSilence"),b=!1}),g.listen("requestSilence",function(){b||a.pausePlayback()}),g.listen("modalOrDialogOpened",function(){a.pausePlayback()})}},e.components.FlipbookGallery={onInstantiated:function(a){a.receiver().receive("slideClicked",function(a,b){var c;c=_.map(b.images,function(a){return{src:a.src,zoom:a.largestSrc,thumburl:a.smallestSrc,selected:a.selected,caption:b.caption}}),g.send("ZoomImage:OpenGalleryForFlipbookImages",c)})}},e.components.LocallyPersistedInputInitializer={onInstantiated:function(a){a.receiver().receive("locallyPersistedInput:notPersisted",function(){var a;m||(a=new k,a.open(),m=!0)})}},i.callIfFunctionalAllowed(function(){var a=f.initializers.Base.deprecatedExtend({selector:_.constant(".cc-make-courseAccordionState"),runBefore:_.constant(["DOMReadyInitializer"]),_initializeSingleInstance:function(a){this.getLanguageConfig(a,e).then(function(b){var c,d=a.data("lesson-ids")||[];(c=_.reduce(d,function(a,c){return a||!!window.localStorage.getItem(c+"-"+b.languageID+"-progress")},!1))&&a.addClass("jsDefaultCollapsed")})}});e.components.CourseAccordionStateInitializer={initializer:a}}).finally(function(){f.configure(e)})}().then(function(){return g.listen("DOMReady",function(){l||a()}),a()})}),module.define("migrateCookies",function(){"use strict";function a(a,b){var d;return c[a]?(localStorage.setItem(c[a],b),!0):(d=a.match(/^(lesson-\d+-\w+)-progress$/))?(localStorage.setItem("userPref-lessonProgress-"+d[1],b),!0):(d=a.match(/^persistentData-AutocompleteFeatured-(\w+)$/))?(localStorage.setItem("userPref-autocomplete-"+d[1],b),!0):(d=a.match(/^persistentData-(\w+)-verified-(\w+)$/))?(localStorage.setItem("userPref-preDisplayVerification-"+d[1]+"-verified-"+d[2],b),!0):!!(d=a.match(/^persistentData-(.+?)(((group|p|synAccordion-|tocTitleExpand)\d+)|undefined)$/))&&(localStorage.setItem("userPref-accordion-"+d[1]+"-"+d[2],b),!0)}function b(){var b,c=[],d=$.cookie("otherContentLang");for(b=0;b<localStorage.length;b++)c.push(localStorage.key(b));c.forEach(function(b){a(b,localStorage.getItem(b))&&localStorage.removeItem(b)}),d&&($.storedData("userPref-otherContentLang",d),$.removeCookie("otherContentLang",{path:"/"}))}var c,d=module.require("legalNotices");c={"persistentData-AutocompleteFeatured-contentLanguageFilter":"userPref-autocomplete-contentLanguageFilter","persistentData-JUMPER_VIEW_MODE":"userPref-viewMode-bibleJumper","persistentData-MUSIC_VIEW_MODE":"userPref-viewMode-music","persistentData-PUBS_VIEW_MODE":"userPref-viewMode-library","persistentData-TOC_VIEW_MODE":"userPref-viewMode-bibleTOC","persistentData-slContentToggleControlState":"userPref-showSignLangTextContent",rubyTextEnabled:"userPref-rubyTextEnabled","userPrefs-theme":"userPref-appearance",lessonAudioModeEnabled:"userPref-lessonAudioModeEnabled"},d.client.on(d.lib.ClientEvents.SETTINGS_CHANGED,function(a){a[d.lib.CookieDataTypes.FUNCTIONAL]&&b()})}),function(a,b,c){"use strict";function d(){var b;l(),j().then(function(){return k.client.on(k.lib.ClientEvents.SETTINGS_CHANGED,function(a){a[k.lib.CookieDataTypes.FUNCTIONAL]?f.setLanguageCookie():$.removeCookie("ckLang",{path:"/"})}.bind(this)),f.setLanguageCookie()}).then(function(){h.send("DOMReady"),f.DOMReady();for(b in f)f.hasOwnProperty(b)&&"function"==typeof f[b].DOMReady&&f[b].DOMReady();$("body").addClass("jsPageReady").focus(),$(a).on("beforeunload",function(){$("body").removeClass("jsPageReady")}),k.client.run(),h.send("PageBooted")})}var e,f,g=module.require("settings"),h=module.require("signal"),i=module.require("url"),j=module.require("setupClientComponents"),k=module.require("legalNotices"),l=module.require("migrateCookies"),m=module.require("i18n"),n=g.getPageConfig("OPEN_BASE_LINK");e={DOMReady:function(){$(b).on("click",'a[href*="#"]:not(.jsNoScroll)',function(a){var b,c,d;b=i.parse($(this).attr("href")),b.hash&&b.hash.path&&!_.contains(b.hash.path,"/")&&(c=b.hash.path,d=$("#"+c),d.attr("tabIndex",0),d.css("outline","none"),d.focus(),"content"===c&&a.preventDefault())})},setLanguageCookie:function(){return k.callIfFunctionalAllowed(function(){var a=g.getPageConfig("WT_LANG"),b=(new Date).getTime(),c={};this._previousPageLang=$.cookie("ckLang"),c.path="/",c.expires=new Date(b+31536e6),$.cookie("ckLang",a,c)}.bind(this))},getPreviousPageLang:function(){return this._previousPageLang}},a._t=a._t||a.opener._t,m.addTranslationStringFilter(function(a){return"https://www.jw.org"!==b.location.origin&&(a=a.replaceAll(b.location.origin+"/finder?",n)),a.replaceAll("https://www.jw.org/finder?",n)}),m.runFilters(),f=a.jworg=Object.create(e),$(b).ready(d),$(a).on("pageshow",function(){h.send("BrowserPageShow")})}(window,window.document),function(){"use strict";var a,b=module.require("signal"),c=module.require("legalNotices");a=function(){var a=$("body").data("insight-context-id");"pa-1011252"!==a&&"pa-1011264"!==a&&c.client.callIfAllowed(c.lib.CookieDataTypes.USAGE,function(){return{contextParams:{savedLang:window.jworg.getPreviousPageLang()}}}).then(function(a){window.ClientComponents.insight.makeEvent("pageLoad",a.returnValue).send()})},b.listen("PageBooted",function(){a()}),module.define("insight",{updateContextID:function(a){$("body").attr("data-insight-context-id",a),$("body").data("insight-context-id",a)},onPageLoad:function(){a()}})}(),function(){"use strict";var a;a={stripRubyText:function(a){var b=$("<div />");return b.html(a),b.find("rt").remove(),b.find("rp").remove(),b.find("ruby").contents().unwrap(),b.html()},removeHTMLEntities:function(a){return $("<p></p>").html(a).text()},safeScreenReaderAttribute:function(a){return $("<p></p>").html(a).text().replace(/(<([^>]+)>)/gi,"")}},module.define("StringUtils",a)}(),function(){"use strict";var a,b=module.require("signal");a=Class.extend({init:function(a){var c=this;this.id=_.uniqueId("headless-"),this.playlist=a,this.skipTo(0),b.listen("requestSilence",function(a){a!==c.id&&c.pause()})},bind:function(a,b){$(this.elem).on(a,b)},nextTrack:function(){var a=this.currentTrack+1;this.skipTo(this.playlist[a]?a:0)},play:function(){this.elem&&(b.send("requestSilence",this.id),this.elem.play())},pause:function(){this.elem&&this.elem.pause()},remove:function(){this.$elem&&this.$elem.remove(),delete this.elem,delete this.$elem},skipTo:function(a){this.__createPlayerElem(this.playlist[a]),this.currentTrack=a},stop:function(){this.pause(),this.skipTo(0)},__createPlayerElem:function(a){var b=_.first(a.sources),c=!1,d=this;this.elem?this.elem.src="":(this.elem=document.createElement("audio"),this.elem.preload="metadata",this.$elem=$(this.elem),this.$elem.addClass("headlessAudioPlayer"),this.$elem.appendTo(document.body)),this.elem.src=b.file,this.$elem.off("canplay"),this.$elem.off("timeupdate"),this.$elem.off("ended"),this.$elem.on("canplay",function(){a.startTime&&!c&&(c=!0,d.elem.currentTime=a.startTime)}),this.$elem.on("timeupdate",function(){a.endTime&&d.elem.currentTime>=a.endTime&&(d.pause(),_.defer(d.stop.bind(d)))}),this.$elem.on("ended",function(){d.nextTrack(),0!==d.currentTrack&&d.elem.play()})}}),module.define("HeadlessAudioPlayer",a)}(),function(){"use strict";var a,b,c=module.require("settings"),d=module.require("url");b={NWTSTY:"NWT"},a=Class.extend({init:function(a){this.setPubSymbol(a)},setPubSymbol:function(a){this.pubSymbol=a?a.toUpperCase():""},getMediaAPIBase:function(a){var e=c.getPageConfig("PUBMEDIA_URL"),f=c.getPageConfig("BIBLE_ALT_LANG_WT_LOCALE")||c.getPageConfig("WT_LANG"),g=this.pubSymbol;return b[this.pubSymbol]&&(g=b[this.pubSymbol]),e=d.parse(e),e.query.pub=g,e.query.langwritten=f,e.query.txtCMSLang=f,e.query.fileformat=a||c.getSetting("AUDIO_STREAM_FORMAT"),e},setTextAPIBase:function(a){this._htmlAPI=d.parse(a)},getTextAPIBase:function(){return this._htmlAPI?this._htmlAPI:this._getAPIBase("BIBLE_HTML_API")},getDataAPIBase:function(){return this._getAPIBase("BIBLE_DATA_API")},getMultimediaAPIBase:function(){return this._getAPIBase("BIBLE_MULTIMEDIA_API")},getHTMLTranslationsAPIBase:function(){return this._getAPIBase("BIBLE_TRANSLATIONS-HTML_API")},_getAPIBase:function(a){var b=a+"_"+this.pubSymbol,e=c.getPageConfig(b),f=c.getPageConfig(a);return d.parse(e||f)},getDataAPIURL:function(){return this._getURL(this.getDataAPIBase())},getMultimediaAPIURL:function(a){var b=this.getMultimediaAPIBase();return b.path=d.join(b.path,a),d.build(b)},getHTMLTranslationsAPIURL:function(){return this._getURL(this.getHTMLTranslationsAPIBase())},getTextAPIURL:function(){return this._getURL(this.getTextAPIBase())},_getURL:function(a){return this.getID&&this.getID()&&(a.path=d.join(a.path,this.getID())),d.build(a)}}),module.define("BibleAPIBase",a)}(),function(){"use strict";var a,b=module.require("BibleAPIBase");a=b.extend({}),a.PUB_SYMBOLS={NWT:"nwt",NWTSTY:"nwtsty"},a.crossReferenceCharacters=function(a){return a||(a=_t("CMSPUBS.MarginalReferenceChars")),_.filter(a.split(" "),_.identity)},module.define("Bible",a)}(),function(){"use strict";var a,b=window.sprintf;a=Class.extend({init:function(a){this.id=a.toString(),this.verse=parseInt(this.id.slice(-3),10),this.chapter=parseInt(this.id.slice(-6,-3),10),this.book=parseInt(this.id.slice(-8,-6),10)}}),a.createVerseId=function(a,c,d){return b("%02d%03d%03d",a,c,d)},module.define("BibleVerse",a)}(),function(){"use strict";var a,b=module.require("BibleAPIBase"),c=module.require("BibleVerse"),d=module.require("BibleVerseRangeResource"),e=module.require("MediaPlaylist"),f=module.require("settings"),g=module.require("url"),h=window.sprintf,i=/^(v?[0-9]+)(-v?[0-9]+)?$/;a=b.extend({init:function(a,b){var d=a.toString().split("-");this.range=a.toString(),this.startRange=_.first(d),this.endRange=_.last(d),this.startRangeIndex=parseInt(this.startRange.replace(/[^0-9]/g,""),10),this.endRangeIndex=parseInt(this.endRange.replace(/[^0-9]/g,""),10),this.start=new c(this.startRange),
this.end=new c(this.endRange),this._super(b)},buildAudioPlaylist:function(){var a,b=this;return a=new e({listFiles:function(){return b.listMediaFiles().then(function(a){return _.filter(a,function(a){return a.mimetype===f.getSetting("AUDIO_STREAM_MIMETYPE")})})}}),a.build().then(function(a){return a=_.map(a,function(a){var c;return a.booknum===b.start.book&&a.track===b.start.chapter&&(c=_.find(a.markers,function(a){return a.verseNumber===b.start.verse}),a.startTime=c?c.startTime:null),a.booknum===b.end.book&&a.track===b.end.chapter&&(c=_.find(a.markers,function(a){return a.verseNumber===b.end.verse}),a.endTime=c?c.endTime:null),a})})},getID:function(){return _.uniq([this.start.id,this.end.id]).join("-")},_hasMediaWithMimetypes:function(a){var b=$.Deferred();return this.listMediaFiles().then(function(c){var d=_.any(c,function(b){return _.contains(a,b.mimetype)});b.resolve(d)}).fail(function(){b.resolve(!1)}),b},hasAudio:function(){return this._hasMediaWithMimetypes([f.getSetting("AUDIO_STREAM_MIMETYPE")])},hasVideo:function(){return this._hasMediaWithMimetypes(f.getSetting("VIDEO_STREAM_MIMETYPES"))},listMediaAPIURLs:function(a){var b,c;return a||(a=f.getSetting("AUDIO_STREAM_FORMAT")+","+f.getSetting("VIDEO_FORMATS")),b=_.range(this.start.book,this.end.book+1),c=this.getMediaAPIBase(a),_.map(b,function(a){return c.query.booknum=a,g.build(c)})},listVerseRangeResources:function(){var a=this.listMediaAPIURLs();return _.map(a,function(a){return new d(a,this.start,this.end)},this)},listMediaFiles:function(){var a=this.listVerseRangeResources(),b=new $.Deferred;return b.resolve([]),_.reduce(a,function(a,b){return a.then(function(a){return b.listFiles().then(a.concat.bind(a))})},b)},isVerseRangeInRange:function(b){return!!b&&(_.isString(b)&&(b=new a(b)),b.startRangeIndex>=this.startRangeIndex&&b.endRangeIndex<=this.endRangeIndex)},doesContainRangesInCollection:function(a){return _.reduce(a.ranges,function(a,b){return a&&this.isVerseRangeInRange(b)}.bind(this),!0)},toRangeString:function(){return this.startRange===this.endRange?"v%s".format(this.startRange):"v%s%sv%s".format(this.startRange,"-",this.endRange)},listAllVersesInRange:function(){var a,b=[];if(this.start.chapter!==this.end.chapter||this.start.verse>this.end.verse)return[this.start,this.end];for(a=this.start.verse;a<=this.end.verse;a++)b.push(new c(h("%02d%03d%03d",this.start.book,this.start.chapter,a)));return b}}),a.allForChapter=function(b,c,d){var e,f;for(b=b?b.toString():"01",c=c?c.toString():"001";c.length<3;)c="0"+c;return e=b+c+"000",f=b+c+"999",new a(e+"-"+f,d)},a.createCitation=function(a,b){var c,d=_t("CMSNUMBERS.BibleMultiCitationSeparator")+" ",e=b?"abbreviatedCitation":"standardCitation";return c=_.reduce(a,function(a,b){return a+b[e]+d},""),c.substring(0,c.length-d.length)},a.isRange=function(a){return i.test(a)},a.compareRangeOrder=function(b,c){var d,e,f;return e=_.isString(b)?new a(b):b,f=_.isString(c)?new a(c):c,d=e.startRangeIndex-f.startRangeIndex,0===d?e.endRangeIndex-f.endRangeIndex:d},a.VERSE_SEPARATOR="-",module.define("BibleVerseRange",a)}(),function(){"use strict";var a,b=module.require("BibleAPIBase"),c=module.require("BibleVerseRange");a=b.extend({init:function(a,b){a=a.toString().split(","),this.ranges=_.map(a,function(a){return new c(a,b)}),this._super(b)},getID:function(){return _.invoke(this.ranges,"getID").join(",")},getRange:function(a){return _.find(this.ranges,function(b){return b.getID()===a.toString()})}}),a.toVerseRangeString=function(a){var b=_.reduce(a,function(a,b){return a+b+","},"");return b.substring(0,b.length-",".length)},a.splitRanges=function(a){return a?a.toString().split(","):[]},module.define("BibleVerseRangeCollection",a)}(),function(){"use strict";var a,b=module.require("BibleAPIBase");a=b.extend({init:function(a){this.bibleVerseRange=a},getID:function(){return this.bibleVerseRange.getID()},getDataAPIBase:function(){return this._getAPIBase("BIBLE_TRANSLATIONS_API")}}),a.getParallelTranslations=function(b){var c=new a(b);return $.getJSONCached(c.getDataAPIURL()).then(function(a){return a.ranges[b.getID()]||{}})},module.define("BibleTranslations",a)}(),function(){"use strict";function a(a){var b=a.split(",");return _.chain(b).map(function(a){return new c(a).listAllVersesInRange()}).flatten().value()}var b,c=module.require("BibleVerseRange"),d=module.require("settings"),e=module.require("url"),f=module.require("PubMediaResource"),g=module.require("Bible");b=Class.extend({init:function(b){_.extend(this,b),this.captionAudioResource=this._createCaptionAudioResource(),this.verses=a(b.source)},hasCaptionAudio:function(){var a=$.Deferred();return!this.docID||this.docID<=0?(a.resolve(!1),a):(this.listCaptionAudioFiles().then(function(b){a.resolve(b.length>0)}).fail(function(){a.resolve(!1)}),a)},_createCaptionAudioResource:function(){var a=this.getMediaAPIBase();return a.query.docid=this.docID,new f(e.build(a))},getMediaAPIBase:function(a){var b=d.getPageConfig("PUBMEDIA_URL"),c=d.getPageConfig("WT_LANG");return b=e.parse(b),b.query.langwritten=c,b.query.txtCMSLang=c,b.query.fileformat=a||d.getSetting("AUDIO_STREAM_FORMAT"),b},listCaptionAudioFiles:function(){return this.captionAudioResource.listFiles()},buildCaptionAudioPlaylist:function(){return this.captionAudioResource.getPlaylist().build()}}),b.fetchMultimedia=function(a,c){var d=new g(a);return $.getJSONCached(d.getMultimediaAPIURL(c)).then(function(a){return _.chain(a.ranges).values().first().value().multimedia}).then(function(a){return _.map(a,function(a){return new b(a)})})},b.multimediaForChapter=function(a,b){function c(b){return b.book===a.bookID&&b.chapter===parseInt(a.id)}return _.chain(b).filter(function(a){return _.some(a.verses,c)}).sortBy("id").sortBy(function(a){var b;return b=_.chain(a.verses).filter(c).sortBy(function(a){return a.verse}).first().value(),b.verse}).value()},module.define("BibleMultimedia",b)}(),function(){"use strict";var a,b=module.require("BibleVerseRange");a=Class.extend({init:function(a){this.rangeCollection=a},render:function(a){return this.rangeCollection?this._fetch(a):$.when(null)},_fetch:function(a){return this.fetched?$.when(this.verses):$.getJSONCached(this.rangeCollection.getTextAPIURL()).then(_.bind(this._parseVerses,this,a))},_parseVerses:function(a,c){var d,e={},f=this;return _.each(c.ranges,function(c,g){d=new b(g,""),e[g]={citation:c.citation,content:f._filterVerseContent(c.html,a),startBook:d.start.book,startChapter:d.start.chapter,validRange:c.validRange}}),this.verses=e,e},_filterVerseContent:function(a,b){return b?this._removeLinks(a):a},_removeLinks:function(a){var b=$("<div></div>").html(a);return b.find(".verseNum a, .chapterNum a").contents().unwrap(),b.find(".xrefLink, .footnoteLink").remove(),b.find("span.verse").removeAttr("id"),b.html()}}),module.define("BibleVerseRangeRenderer",a)}(),function(){"use strict";var a;a=Class.extend({numbers:{},init:function(a){a&&a.length>0&&(this.numbers=JSON.parse(a.html()))},get:function(a){return this.numbers&&_.has(this.numbers,a)?this.numbers[a]:a}}),module.define("LocalizedNumber",a)}(),function(){"use strict";var a,b=module.require("PubMediaResource");a=Class.extend({preload:function(a){var b=new $.Deferred;return $.when.apply($,_.map(a,this._fetchSource)).then(function(){var a=Array.prototype.slice.call(arguments);b.resolve(_.filter(a,_.identity))}),b},_fetchSource:function(a){var c=new b(a.link),d=new $.Deferred;return c.listFiles().done(function(){d.resolve(_.extend({},a,{pubMedia:c}))}).fail(function(){d.resolve()}),d}}),module.define("PubMediaResourcePreloader",a)}(),function(){"use strict";var a,b=/ml-([^\s]+)/,c=/ms-([^\s]+)/,d=module.require("settings"),e=d.getPageConfig("I18N_API_URL");a={addLanguageAttrs:function(a,b,c,d,e){var f,g;f=d?"dir-"+d:"",g=e?"ms-"+e:"",a.addClass(c).addClass(f).addClass(g).attr("lang",b).attr("xml:lang",b).attr("dir",d)},transferLanguageAttrs:function(b,c){var d,e=b.attr("lang"),f=b.attr("dir"),g=this.findLanguageScriptClass(b.attr("class")),h=this.getLanguageScriptFromClass(g),i=b.hasClass("showRuby");d=this.findLanguageCodeClass(b.attr("class")),a.addLanguageAttrs(c,e,d,f,h),i&&c.addClass("showRuby")},findLanguageCodeClass:function(a){return a=a||"",_.find(a.split(/\s+/),function(a){return b.test(a)})},getLanguageCodeFromClass:function(a){var c=a.match(b);return c?c[1]:void 0},getLanguageCodeFromElement:function(a){var b=this.findLanguageCodeClass($(a).attr("class"));return b?this.getLanguageCodeFromClass(b):void 0},findLanguageScriptClass:function(a){return a=a||"",_.find(a.split(/\s+/),function(a){return c.test(a)})},getLanguageScriptFromClass:function(a){var b=a.match(c);return b?b[1]:void 0},getLanguageModelByLocale:function(a){var b='[class^="ml-"][lang="'+a+'"],[class*=" ml-"][lang="'+a+'"]',c=$(b).attr("class");if(b&&c)return{dir:$(b).attr("dir"),code:this.getLanguageCodeFromClass(c),script:this.getLanguageScriptFromClass(c)}},createLanguageClasses:function(a){var b,c,d;return b=a.code?"ml-"+a.code:"",c=a.direction?"dir-"+a.direction:"",d=a.script?"ms-"+a.script:"",[b,c,d].join(" ")},listLanguages:function(){return $.getJSONCached(e+"/languages")}},module.define("LanguageUtils",a)}(),function(){"use strict";var a;a={transferArticleClasses:function(a){$("#article").hasClass("showRuby")&&a.addClass("showRuby"),a.addClass("jwac")}},module.define("ArticleContentUtils",a)}(),function(){"use strict";var a;a=Class.extend({init:function(a,b){this.pathParts=this._parsePath(this._splitPath(a)),this.callback=b},_splitPath:function(a){var b=a.split("/");return _.chain(b).map(function(a){return a.trim()}).filter(function(a){return""!==a}).value()},_parsePath:function(a){return _.map(a,function(a){var b,c;return":"===a.substr(0,1)?(b="param",c=a.substr(1)):(b="path",c=a),{type:b,name:c}})},match:function(a){var b,c=this._splitPath(a),d={};if(c.length<this.pathParts.length)return!1;for(b=0;b<this.pathParts.length;b++){if("path"===this.pathParts[b].type&&c[b]!==this.pathParts[b].name)return!1;"param"===this.pathParts[b].type&&(d[this.pathParts[b].name]=c[b])}return d},navigate:function(a){var b=this.match(a);return!!b&&this.callback(b)}}),module.define("Route",a)}(),function(){"use strict";function a(a){return a.length<=1?a[0]:_.chain(a).filter(function(a){return a.getResolution()<=720}).sortBy(function(a){return a.getResolution()}).last().value()}module.define("defaultMediaPlayerSourceSelectionFn",a)}(),function(){"use strict";var a,b,c=window.MediaPlayer.behaviors.RememberPlaybackRateUserPreferenceBehavior;a={get:function(a){var b;return b="audio"===a?"userPref-audio-playbackRate":"userPref-video-playbackRate",localStorage.getItem(b)},set:function(a,b){var c;c="audio"===a?"userPref-audio-playbackRate":"userPref-video-playbackRate",localStorage.setItem(c,b)}},b=new c(a),module.define("rememberPlaybackRateBehavior",b)}(),function(){"use strict";var a,b,c=window.MediaPlayer.behaviors.RememberMaxResolutionUserPreferenceBehavior;b={get:function(){return localStorage.getItem("userPref-preferredResolution")||720},set:function(a){localStorage.setItem("userPref-preferredResolution",a)}},a=new c(b),module.define("rememberResolutionBehavior",a)}(),function(){"use strict";var a,b,c,d=window.MediaPlayer.behaviors.BaseBehavior;c={get:function(){return localStorage.getItem("userPref-subtitlesMode")},set:function(a){localStorage.setItem("userPref-subtitlesMode",a)}},a=d.extend({bind:function(a){a.on("settingChanged:subtitlesMode",function(a){c.set(a)})},getSubtitlesMode:function(){return c.get()?c.get():"SUBTITLES_OFF"}}),b=new a,module.define("rememberSubtitlesBehavior",b)}(),function(){"use strict";var a,b,c,d,e=window.MediaPlayer.behaviors.BaseBehavior,f=module.require("signal"),g=module.require("url"),h=g.parse().query.ts,i={};f.listen("StreamingControllerInitialized",function(a){i[a.getPlayerID()]=a}),f.listen("StreamingControllerDestroyed",function(a){delete i[a.getPlayerID()]}),$(".cmm-app").length>0&&(c=g.parse(),c.query.ts&&delete c.query.ts,d=g.build(c),window.history&&window.history.replaceState?window.history.replaceState(null,"",d):window.location.href=d),a=e.extend({bind:function(a){var b,c=this;h&&(a.once("ready",function(){b=a.getCurrentItem()}),a.once("itemPlaying",function(){function d(b){b>g&&(a.off("timeChanged",d),a.isPlaying()&&a.pause())}var e=h.split("-"),f=c.convertTimestampToSeconds(e[0]),g=c.convertTimestampToSeconds(e[e.length-1]);Object.keys(i).length>1||a.getCurrentItem()===b&&(f>a.getCurrentItemDuration()||(g>f&&g<a.getCurrentItemDuration()&&(a.once("currentItemChanged",function(){a.off("timeChanged",d)}),a.once("seekEnded",function(){a.once("seekStarted",function(){a.off("timeChanged",d)})}),a.on("timeChanged",d)),a.seek(f)))}))},convertTimestampToSeconds:function(a){var b=a.split(":");return Number(_.reduce(b,function(a,b){return 60*a+Number(b)}))}}),b=new a,module.define("timestampPlaybackBehavior",b)}(),function(){"use strict";function a(a){for(var b=a.parent();0===b.find(".relatedImage:first").length&&0!==b.parent().length&&!b.hasClass("synopsis");)b=b.parent();return b.find(".relatedImage:first img").attr("src")||b.find(".relatedImage:first").data("src")||""}module.define("configureDownloadModal",function(b,c){b.setCoverImage(a(c)),b.setDefaultPubName($(".onPageTitle").html()),b.setTitle&&c.data("onpagetitle")&&b.setTitle(c.data("onpagetitle"))})}(),function(){"use strict";var a={},b=module.require("settings");a.create=function(a){var c=b.getPageConfig("FINDER_BASE_LINK");return c="?"===c.substring(c.length-1)?c:c+"?",c+$.param(a)},module.define("FinderLink",a)}(),function(){"use strict";function a(a,b){var c,d=_.debounce(a,300);return c=new MutationObserver(d),c.observe(b,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["class"]}),c}module.define("ClassPresenceObserver",{create:a})}(),function(){"use strict";var a;a=function(a,b){this.elem=a,this.options=_.extend({filterDataAttribute:"tags",highlightClass:"highlighted",isFilteredClass:"filtered"},b),this.disabled=!1},a.prototype={resetFilter:function(){this.elem.removeClass(this.options.isFilteredClass),this.__filterableElements().removeClass(this.options.highlightClass)},filterResults:function(a){var b=this;this.disabled||(this.resetFilter(),void 0!==a&&(this.__filterableElements().each(function(){var c=$(this);-1!==c.data(b.options.filterDataAttribute).indexOf(a)&&c.addClass(b.options.highlightClass)}),this.elem.addClass(b.options.isFilteredClass)),this.elem.trigger("on:filter:FilteringContainer"))},disableFilter:function(){this.disabled=!0,this.resetFilter()},enableFilter:function(){this.disabled=!1},__filterableElements:function(){return this.elem.find("[data-"+this.options.filterDataAttribute+"]")}},module.define("FilteringContainer",a)}(),function(){"use strict";var a;a=function(a){this.elem=a},a.prototype={selectSegment:function(b){a._selectSegment(this.elem.find(b))}},a._clearSelectedSegments=function(a){a.find("a").removeClass("current")},a._selectSegment=function(b){a._clearSelectedSegments(b.parents(".jsSegmentControl")),b.addClass("current")},$(document).on("click",".jsSegmentControl a",function(b){b.preventDefault(),a._selectSegment($(this))}),module.define("SegmentControl",a)}(),function(){"use strict";var a;a={addSourceFlags:function(b,c){a._addSourceFlagForSelector(".jsBibleLink",b,c),a._addSourceFlagForSelector(".footnoteLink",b,c),a._addSourceFlagForSelector(".endnoteLink",b,c),a._addSourceFlagForSelector(".jsDialogContentLink",b,c),a._addSourceFlagForSelector(".jsVerselessPartialCommentary",b,c),a._addSourceFlagForSelector('a[href^="https://www.jw.org/bible"]',b,c),a._addSourceFlagForSelector(".jsPseudoBibleLink",b,c)},_addSourceFlagForSelector:function(a,b,c){b.find(a).each(function(){$(this).attr("data-dialogsource",c)})}},module.define("DialogUtils",a)}(),function(){"use strict";var a,b=module.require("settings");a={getPrettyFileSizeString:function(a){return Math.ceil(a/1048576).toLocaleString()+"&nbsp;MB"},isArchiveMimetype:function(a){return a===b.getSetting("ARCHIVE_MIMETYPE")}},module.define("FileUtils",a)}(),function(){"use strict";var a,b,c,d=module.require("settings"),e=module.require("browser"),f=module.require("signal"),g=module.require("LanguageUtils"),h=module.require("legalNotices"),i=d.getPageConfig("CONTENT_LANG_DIRECTION"),j=d.getPageConfig("CONTENT_LANG_SCRIPT"),k=d.getPageConfig("CONTENT_LANG"),l=d.getPageConfig("WT_LANG");c=function(){this.index=0,this.groupLabel="",this.value="",this.label="",this.altLabel="",this.altSpellings="",this.language="",this.script="",this.elemOption=null,this.icon=null},b=function(){this.groupLabels=[],this.values=[],this.labels=[],this.altLabels=[],this.altSpellings=[],this.languages=[],this.scripts=[],this.optionElems=[],this.icons=[]},b.prototype={exists:function(a){return void 0!==this.values[a]},get:function(a){if(void 0!==this.values[a]){var b=new c;return b.index=a,b.groupLabel=this.groupLabels[a],b.value=this.values[a],b.label=this.labels[a],b.altLabel=this.altLabels[a],b.altSpellings=this.altSpellings[a],b.language=this.languages[a],b.script=this.scripts[a],b.elemOption=this.optionElems[a],b.icon=this.icons[a],b}},indexOf:function(a){return this.values.indexOf(a)},list:function(a){var b,c,d=[];for(b=0;b<this.values.length;b++)d.push(this.get(b));return void 0===a?d:(c=this.__getSearchIndex(),a=a.toLowerCase(),d=$.grep(d,function(b,d){return-1!==c[d].indexOf(a)}))},loadData:function(a){var b=this;a.children("option").each(function(){var a=$(this);b.__addOption(a)}),a.children("optgroup").each(function(){var a=$(this);b.__addOptionGroup(a)})},__addOptionGroup:function(a){var b=this,c=a.attr("label");a.children("option").each(function(){var a=$(this);b.__addOption(a,c)})},__addOption:function(a,b){var c=a.attr("value"),d=a.text(),e=a.data("alternative-label"),f=a.data("alternative-spellings"),g=a.data("language"),h=a.data("script"),i=a.data("icon");this.values.push(c),this.groupLabels.push(b||""),this.labels.push(d),this.altLabels.push(e),this.altSpellings.push(f),this.languages.push(g),this.scripts.push(h),this.optionElems.push(a),this.icons.push(i)},__getSearchIndex:function(){var a,b;return this.searchIndex?this.searchIndex:(a=_.zip(this.values,this.groupLabels,this.labels,this.altLabels,this.altSpellings),b=/<(?:.|\n)*?>/gm,this.searchIndex=_.map(a,function(a){return _.chain(a).filter(_.identity).map(function(a){return a.toLowerCase().replace(b,"")}).value().join(",")}),this.searchIndex)}},a=function(a,b){var c;this.__hasInitialized=!1,c={activeClass:"active",columnWidth:235,minColumns:1,maxColumns:4,showFeatured:!1,matchInputWidth:!1,minSearchChars:0,maxResults:-1},this.__optionHTMLCache={},this.__optionGroupHTMLCache={},this.elemSelect=a,this.settings=$.extend(c,a.data("autocomplete-settings"),b),this.selector={container:$("body"),elem:null,customStyle:!1,isOpen:!1,isClosable:!0}},a.prototype={init:function(){var a=$("<div></div>");return this.loadOptions().then(function(){this.elemInput=this.__renderTextField(),this.elemSelect.hide(),a.addClass("jsAutoCompleteInputWrapper"),a.addClass("autocomplete-icons"),a.append(this.elemInput),a.insertAfter(this.elemSelect),this.__bindInputEventHandlers(),this.__hasInitialized=!0}.bind(this))},clearOptionCache:function(){this.__optionHTMLCache={},this.__optionGroupHTMLCache={}},close:function(){this.__hasInitialized&&this.__handleBlur(this.selector.elem)},configureSelector:function(a,b,c){this.selector.container=a||$("body"),this.selector.customStyle=!!b,this.selector.isClosable=!!c},loadOptions:function(a){var c,d,e=Promise.resolve();return this.options=new b,this.options.loadData(this.elemSelect),c=_.isUndefined(a)?this.options.indexOf(this.elemSelect.val()):a,c=-1===c?null:c,this.selectedIndex=c,null!==c&&(d=this.options.get(c),e=this.__addFeaturedOption(d.value).then(function(){this.elemInput&&this.elemInput.val(d.label)}.bind(this))),e.finally(function(){this.selector.elem&&this.selector.isOpen&&this.__drawSelector()}.bind(this))},open:function(a){!this.__hasInitialized||this.selector&&this.selector.isOpen||this.elemInput.val().length<this.settings.minSearchChars||(this.selector.isOpen=!0,this.__drawSelector(a))},_getInputWrapper:function(){return this.elemInput.closest(".jsAutoCompleteInputWrapper")},selectOption:function(a){var b,c,d,e,f;if(this.__hasInitialized){if(!this.options.exists(a))return this.elemInput.val(""),void this.__drawSelector();b=this.options.get(a),c=this.elemSelect.val(),d=this._getInputWrapper(),e=this.options.indexOf(c),f=this.options.get(e),f&&f.elemOption&&(this.elemInput.removeClass(f.elemOption.data("input-icon-class")),d.removeClass(f.elemOption.data("input-icon-class"))),this.elemInput.addClass(b.elemOption.data("input-icon-class")),d.addClass(b.elemOption.data("input-icon-class")),this.selectedIndex=a,this.elemInput.val(b.label),this.elemSelect.find("option").prop("selected",!1),this.elemSelect.find('option[value="'+b.value+'"]').prop("selected",!0),this.__addFeaturedOption(b.value).then(function(){c!==b.value&&this.elemSelect.trigger("change"),this.elemSelect.trigger("autocomplete-option-selected")}.bind(this))}},__attachSelector:function(a){var b,c=this;this.selector.customStyle||(b=$(window).scrollTop()),this.selector.container.append(a),this.selector.customStyle||(this.__positionSelector(a),$(window).resize(function(){c.__positionSelector(a)}),$(window).scrollTop(b))},__bindInputEventHandlers:function(){var a,b,c,d,f,g=this;this.elemInput.on("focus",this.__handleFocus.bind(this)),a=function(a){b!==a&&(g.selector.isOpen?g.__drawSelector(a):g.open(a),b=a)},c=e.isIE()?"keydown":"input keydown",d=e.isIE()?"keyup":"input keyup",this.elemInput.on(c,function(a){g.__handleControlKey(g.selector.elem,a.keyCode)&&a.preventDefault()}),this.elemInput.on(d,function(){var b=g.elemInput.val();f&&clearTimeout(f),f=setTimeout(function(){a(b)},0)})},__bindSelectorRemove:function(a){var b,c=this,d=!0,e=!1;b=function(){d||e||c.__handleBlur(a)},a.on("mouseenter",function(){e=!0}),a.on("mouseleave",function(){e=!1,setTimeout(b,200)}),this.elemInput.on("focus",function(){d=!0}),this.elemInput.on("blur",function(){d=!1,setTimeout(b,200)})},__addFeaturedOption:function(a){return this.settings.showFeatured?this.__listFeaturedOptions().then(function(b){var c=b.indexOf(a);return-1!==c&&b.splice(c,1),b.unshift(a),b=b.slice(0,8),h.callIfFunctionalAllowed(function(){$.storedData(this.__getFeaturedKey(),b)}.bind(this))}.bind(this)):Promise.resolve()},__copyAttrs:function(a,b,c){var d,e;for(d=0;d<c.length;d++)e=a.attr(c[d]),b.attr(c[d],e);return b},__drawSelector:function(a){return this.selector.elem&&this.selector.elem.remove(),this.__renderSelector(a).then(function(a){this.selector.elem=a,this.__attachSelector(this.selector.elem),this.__bindSelectorRemove(this.selector.elem)}.bind(this))},__getFeaturedKey:function(){var a=this.elemSelect;return"userPref-autocomplete-"+(a.data("featured-items-name")||a.attr("id")||a.attr("name"))},__getNumColumns:function(){var a=$(window),b=a.width()-this.__getSelectorLeft(),c=Math.floor(b/this.settings.columnWidth);return c=Math.min(this.settings.maxColumns,c),c=Math.max(this.settings.minColumns,c)},__getSelectorLeft:function(a){var b,c,d=$(window),e=this.elemInput.offset(),f=e.left+this.elemInput.outerWidth()/2,g=d.width()/2;return b=a?a.outerWidth():this.settings.maxColumns*this.settings.columnWidth,c=f<g?e.left:e.left+this.elemInput.outerWidth()-b,Math.max(0,c)},__getSelectorTop:function(){var a=this.elemInput.offset(),b=a.top+this.elemInput.outerHeight();return Math.max(0,b)},__handleFocus:function(){var a=this.options.indexOf(this.elemSelect.val()),b=this.options.get(a);this.elemInput.val(""),b&&b.elemOption&&(this.elemInput.removeClass(b.elemOption.data("input-icon-class")),this._getInputWrapper().removeClass(b.elemOption.data("input-icon-class"))),this.open()},__handleBlur:function(a){var b=this.elemInput.val();this.selector.isClosable&&(this.selector.isOpen=!1,this.elemSelect.data("allows-empty-value")||-1!==this.options.indexOf(b)||this.selectOption(this.selectedIndex),a.fadeOut(function(){a.remove()}),this.elemInput.next("input").focus())},__handleControlKey:function(a,b){if(!a)return!1;var c,d,e,f,g,h=a.find("li."+this.settings.activeClass),i=!1;return 27===b?(this.elemInput.blur(),!0):13===b?(e=h.data("index"),this.selectOption(e),this.elemInput.blur(),!0):(38!==b&&40!==b||(d=38===b?"prev":"next",c=h[d](),i=!0),37!==b&&39!==b||(d=37===b?"prev":"next",e=h.parent().children().index(h),c=h.parent().parent()[d]().children().children().filter(":eq("+e+")"),i=!0),c&&c.length>0?(h.removeClass(this.settings.activeClass),c.addClass(this.settings.activeClass),e=c.parent().children().index(c),f=c.parent().height()-a.innerHeight(),g=$.easing.swing(e/c.parent().children().length)*f,a.scrollTop(g),!0):i)},__handleOptionClick:function(a){var b=a.data("value");null!==b&&void 0!==b&&this.selectOption(this.options.indexOf(b.toString()))},__listFeaturedOptions:function(){var a;return this.settings.showFeatured?(a=this.__getFeaturedKey(),h.callIfFunctionalAllowed(function(){return $.storedData(a)||[]},[]).then(function(a){return a.returnValue})):Promise.resolve([])},__positionSelector:function(a){var b=this.__getSelectorTop(),c=this.__getSelectorLeft(a);a.offset({top:b,left:c})},__renderOptionGroupHTML:function(a){var b,c;return void 0!==this.__optionGroupHTMLCache[a]?this.__optionGroupHTMLCache[a]:(b=$("<li>"),b.addClass("optionGroup"),c=$("<div>"),c.addClass("optionLabel"),c.text(a),b.append(c),this.__optionGroupHTMLCache[a]=b,b)},__renderOptionHTML:function(a){var b,c,d;return void 0!==this.__optionHTMLCache[a.value]?(b=this.__optionHTMLCache[a.value],a.index!==this.selectedIndex&&b.removeClass(this.settings.activeClass),b):(b=$("<li>"),b.attr("data-index",a.index),b.attr("data-value",a.value),b.attr("role","link"),b=this.__copyAttrs(a.elemOption,b,["class","lang","xml:lang","dir"]),a.index===this.selectedIndex&&b.addClass(this.settings.activeClass),a.icon&&b.append(a.icon),a.altLabel&&(c=$("<div>"),c.addClass("altLabel"),g.addLanguageAttrs(c,k,"ml-"+l,i,j),c.text(a.altLabel),b.append(c)),d=$("<div>"),d.addClass("optionLabel"),d.addClass(a.language),d.addClass(a.script),d.text(a.label),b.append(d),this.__optionHTMLCache[a.value]=b,b)},__renderOptionsHTML:function(a){var b,c,d,e=[];for(d=0;d<a.length;d++)c=a[d],c.groupLabel&&c.groupLabel!==b&&(e.push(this.__renderOptionGroupHTML(c.groupLabel)),b=c.groupLabel),e.push(this.__renderOptionHTML(c));return _.invoke(e,"clone")},__renderSelector:function(a){var b=this.options.list(a).filter(Boolean),c=this;return this.settings.maxResults>0&&(b=b.slice(0,this.settings.maxResults)),this.__renderSelectorHTML(b).then(function(a){return a.find("li").on("click",function(){c.__handleOptionClick($(this)),c.__handleBlur(a)}),a})},__renderSelectorHTML:function(a){return this.__listFeaturedOptions().then(function(b){var c,d,e,f=$("<div></div>"),g=$("<div><ul></ul></div>"),h=g.clone(),i=Math.min(a.length,this.__getNumColumns());return g.addClass("jsAutoCompleteContainer featuredOptions"),h.addClass("jsAutoCompleteContainer"),d=_.intersection(b,_.pluck(a,"value")),c=4-4%i,d=d.slice(0,c),d=_.filter(a,function(b){return d.length<a.length&&-1!==d.indexOf(b.value)}),d=_.sortBy(d,function(a){return b.indexOf(a.value)}),function(a){var b=$("<div><ul></ul></div>");return b.addClass("jsAutoCompleteContainer"),b.children("ul").append(a),b},g.children("ul").append(this.__renderOptionsHTML(d)),h.children("ul").append(this.__renderOptionsHTML(a)),g.find("li").length&&f.append(g),f.append(h),0===f.find("li."+this.settings.activeClass).length&&f.find("li:first").addClass(this.settings.activeClass),f.addClass("jsAutoCompleteSelector"),f.addClass(this.elemInput.data("autocompleteclass")),this.selector.customStyle||(e=this.settings.matchInputWidth?this.elemInput.outerWidth()-2:i*this.settings.columnWidth+18,f.css("width",e)),f}.bind(this))},__renderTextField:function(){var a=$('<input type="text" />'),b=this.options.get(this.selectedIndex);return this.__copyAttrs(this.elemSelect,a,["id","class","placeholder","data-autocompleteclass"]),a.addClass("jsAutoCompleteInput"),a.addClass(this.elemSelect.data("autocompleteclass")),b?(a.val(b.label),b.elemOption&&a.addClass(b.elemOption.data("input-icon-class"))):a.val(""),a.attr("autocomplete","off"),a}},f.listen("BrowserPageShow",function(){$(".jsAutoCompleteInput").each(function(){var a=$(this),b=a.val();setTimeout(function(){a.val(b)},0)})}),module.define("Autocomplete",a),module.define("autocomplete",{Autocomplete:a,OptionRecord:c,OptionSet:b,init:function(b,c){var d,e=b.children("option").length>0,f=b.children("optgroup").length>0;return b.data("autocomplete")||!e&&!f?Promise.resolve():(d=new a(b,c),b.data("autocomplete",d),d.init().then(function(){b.trigger("autocompleteAdded")}))}})}(),function(){"use strict";var a,b=0;a={open:function(){b++;var a,c,d=$("#jsFullScreenLoadingIndicator"),e=$.Deferred(),f=0;return d.exists()?$.when(!1):(d=$("<div id='jsFullScreenLoadingIndicator'><div class='inner'><div class='loadingIndicator'></div></div></div>"),$("body").append(d),$("#jsFullScreenLoadingIndicator").addClass("show"),a=function(){if(++f>=2)return e.resolve(),cancelAnimationFrame(c);c=requestAnimationFrame(a)},requestAnimationFrame(a),e.promise())},close:function(){if(!(--b>0)){b=0;var a=$("#jsFullScreenLoadingIndicator");return a.animate({opacity:0},400),a.promise().done(function(){$(this).remove()})}}},module.define("loadingIndicator",a)}(),function(){"use strict";var a;a=Class.extend({scrollTo:function(a,b,c,d){var e,f,g,h,i=b instanceof jQuery;i&&!b.length||!a.length||(e=this._getScrollHeight(a,d),f=e-a.height(),c=c||0,b instanceof jQuery?(g=b.offset().top,h=a.offset()?a.offset().top:0,g-=h,$.isWindow(a.get(0))||(g+=a.scrollTop())):g=b||0,a.scrollTop(Math.min(g+c,f)))},_getScrollHeight:function(a,b){return b&&b.get(0)?b.get(0).scrollHeight||b.outerHeight():a.get(0).scrollHeight||0}}),module.define("ScrollHelper",a),module.get("ScrollHelper")}(),function(){"use strict";var a=Class.extend({options:{fadeSpeed:100,handlePadding:10,buttonMargin:5},init:function(a,b,c){this.el=$(a),b&&(this.boundaryEl=$(b)),this.zContainer=c,this.body=this.el.siblings(".dropdownBody"),this.el.on("click",this.open.bind(this))},open:function(a){var b,c,d,e,f,g=this.el,h=this.body,i=this.boundaryEl,j=this.isInRTLContext()?"right":"left",k=this,l=g.outerHeight()+this.options.handlePadding-this.options.buttonMargin;g.hasClass("open")||0===this.body.length||(a.preventDefault(),h.css("visibility","hidden").show(),b=Math.max(h.innerWidth(),g.innerWidth())+1,h.hide().css("visibility",""),c=_.once(function(){h.slideUp(k.options.fadeSpeed,function(){h.add(g).removeClass("open"),h.attr("style","")})}),h.attr("style",""),h.css("padding-top",l),h.innerWidth(b),d={of:g,my:j+" top",at:j+" top",collision:"flip",using:function(a,b){var c=b.element.top+b.element.height/2,d=b.target.top+b.target.height/2,e="padding-top",f=$(this),g=!1;h.css("padding-top",""),c<d&&(e="padding-bottom",a.top-=k.options.buttonMargin),f.parents().each(function(){if(!g){var a,b=$(this),c=b.css("position");a="relative"===c||"absolute"===c||"fixed"===c||"sticky"===c,a&&(g=b)}}),g&&(a.top-=g.offset().top,a.left-=g.offset().left),f.css(a),h.css(e,l)}},i&&(d.within=i),h.position(d),this.zContainer&&(e=this.el.parents(this.zContainer),f=e.siblings(this.zContainer),e.exists()&&f.exists()&&(f.css("z-index",1),e.css("z-index",2))),h.add(g).addClass("open"),h.slideDown(this.options.fadeSpeed,function(){$(document).one("click",c),$(window).one("resize orientationchange",c)}))},isInRTLContext:function(){var a=this.el.closest("dir-ltr"),b=this.el.closest("dir-rtl");return(0!==b.length||0!==a.length)&&(0!==b.length&&(0===a.length||a.has(b).length>0))}});module.define("DropdownMenu",a)}(),function(){"use strict";var a,b,c=module.require("settings");a=function(){this.child=void 0,this.setURL(),this.setTitle(),this.setOptions()},a.prototype={assembleOptionsString:function(){var a,b=this.options,c=[];for(a in b)b.hasOwnProperty(a)&&(!0===b[a]&&(b[a]="yes"),!1===b[a]&&(b[a]="no"),
c.push(a+"="+b[a]));return c.join(",")},close:function(){this.child&&(this.child.close(),this.child=void 0)},open:function(){var a=this.assembleOptionsString();return b&&b.close(),this.child=window.open(this.url,this.title,a),b=this,this.child.document,this.child},setOptions:function(a){var b,d;d={resizable:!0,scrollbars:!1,width:c.getSetting("WINDOW_WIDTH"),height:c.getSetting("WINDOW_HEIGHT"),menubar:!1,toolbar:!1,location:!1},a=a||{};for(b in a)a.hasOwnProperty(b)&&null===a[b]&&delete a[b];this.options=$.extend(!0,d,this.options,a)},setURL:function(a){this.url=a||""},setTitle:function(a){this.title=a||"_blank"}},module.define("ChildWindow",a)}(),function(){"use strict";var a,b,c=module.require("signal");b=function(a){this.html=a,this.settings={},this.updateSettings({closeOnEscapeKey:!0,closeOnOverlayClick:!0,fullscreen:!1,scrollTop:!0})},b.close=function(){a&&a._close()},b.prototype={_close:function(){var b=this.container.add(this.overlay),c=this;a=null,this.settings.beforeClose(),this.container.addClass("js-state-simpleModal--hidden"),this.overlay.addClass("js-state-simpleModal--hidden"),setTimeout(function(){b.remove(),c.settings.afterClose()},200)},_handleEscapeKey:function(){this.settings.closeOnEscapeKey&&this._close()},updateSettings:function(a){var b=a.beforeShow,d=a.afterShow,e=a.beforeClose,f=a.afterClose;a.beforeShow=$.proxy(function(){$("body").css("overflow","hidden"),c.send("simple-modal-before-show"),"function"==typeof b&&b()},this),a.afterShow=$.proxy(function(){var a=this.container.find("h1, h2, h3, h4, h5").filter(":first");this.container.trap(),a.attr("tabIndex",0),a.css("outline","none"),a.focus(),"function"==typeof d&&d()},this),a.beforeClose=$.proxy(function(){this.container.untrap(),$("body").css("overflow","auto"),"function"==typeof e&&e()},this),a.afterClose=$.proxy(function(){"function"==typeof f&&f()},this),this.settings=$.extend(this.settings,a)},open:function(){b.close(),a=this;var d,e=this;this.overlay=$("<div>"),this.overlay.addClass("jsSimpleModalOverlay js-state-simpleModal--hidden"),this.container=$("<div>"),this.container.addClass("jsSimpleModalContainer js-state-simpleModal--hidden"),this.settings.fullscreen&&this.container.addClass("jsFullscreen"),d=$("<div>").addClass("standardModal-flexWrapper"),d.append(this.html),this.container.append(d),$("body").append(this.overlay,this.container),this.settings.closeOnOverlayClick&&(this.overlay.click(this._handleOutsideModalClick),this.container.click(this._handleOutsideModalClick)),this.settings.beforeShow(),setTimeout(function(){e.container.removeClass("js-state-simpleModal--hidden"),e.overlay.removeClass("js-state-simpleModal--hidden"),setTimeout(function(){e.settings.afterShow(),e.settings.scrollTop&&e.scrollToTopOfContentContainer()},200)},1),c.send("modalOrDialogOpened")},scrollToTopOfContentContainer:function(){this.container.find(".standardModal-contentContainer").scrollTop(0)},transitionModalContent:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o=this.container.find(".standardModal"),p=this.container.find(".standardModal-contentContainer"),q=this.container.find(".standardModal-content"),r=90*$(window).height()/100,s=this;if(this.settings.fullscreen)return void a();o.removeClass("transitionsEnabled"),b=o.outerHeight(),c=this._convertHeightToViewportUnits(b),o.css("height",c).css("max-height",c),d=b-p.height(),e=q.outerHeight(),a(),n=this.container.find(".standardModal-content"),f=n.outerHeight(),g=f+d,h=g>b,i=e+d>=r,j=g>=r,k=!i||!j,l=Math.abs(b-g)>=10,m=k&&l,m||(o.css("height",""),o.css("max-height","")),h&&!j&&p.css("overflow-y","hidden"),setTimeout(function(){o.addClass("transitionsEnabled"),m&&(h?(o.css("height",""),o.css("max-height",""),setTimeout(function(){p.css("overflow-y","")},250)):(o.css("height",s._convertHeightToViewportUnits(g)),o.css("max-height",""),setTimeout(function(){o.css("height","")},250)))},1)},_handleOutsideModalClick:function(a){$(a.target).is(".jsSimpleModalContainer, .jsSimpleModalOverlay")&&b.close()},_convertHeightToViewportUnits:function(a){return a/$(window).height()*100+"vh"}},module.define("SimpleModal",b),$(document).on("click",".jsCloseModal",b.close),$(document).on("keydown",null,"esc",function(){a&&a._handleEscapeKey()})}(),function(){"use strict";function a(a){var b,c=a.getImplementation().src();return c?(b=c.split("/"),b[b.length-1]):""}function b(a,b){var c,d=n.getPageConfig("PUBMEDIA_URL"),e=new window.URLSearchParams,f=n.getSetting(b?"VIDEO_FORMATS":"AUDIO_FORMATS");return c={docid:"documentID",pub:"pubSymbol",track:"sequenceNumber",issue:"issueDate",booknum:"bibleBookNumber",langwritten:"languageCode",textCMSLang:"languageCode"},_.each(_.keys(c),function(b){var d=c[b],f=a.filename[d];f&&e.set(b,f)}),e.set("output","json"),e.set("langwritten",e.get("langwritten")||n.getPageConfig("WT_LANG")),e.set("textCMSLang",e.get("textCMSLang")||n.getPageConfig("WT_LANG")),e.set("alllangs","0"),e.set("fileformat",encodeURIComponent(f)),d+"?"+e.toString()}function c(c,d){var e=module.require("VideoModal"),f=module.require("DownloadModal");return c.setDownloadButtonOptions({shouldShowButton:function(b){var c=a(b),e=d.containerEl.parents(".standardModal:not(.jsEmbedded)").length>0;return window.filenameUtils.parse(c).isValid&&!e},onClick:function(c){var g,h,i="video"===d.builderType?e:f,j=a(c),k=window.filenameUtils.parse(j),n=d.containerEl.attr("data-jsonurl");n||(n=b(k,"video"===d.builderType)),g=new l(n),h=new i(g,{}),m(h,d.containerEl),h.open()}})}function d(a,b){function c(){var a=b.containerEl.parents("#article").length>0,c=b.containerEl.is("#videoPlayerInstance")||b.containerEl.is("#audioPlayerInstance");return!(!a&&!c)&&($(d).length>0||$(e).length>0)}var d="#article .jsShare",e="#sidebar .jsShare";return a.setShareButtonOptions({shouldShowButton:c,onClick:function(){var a,b=$(d);1===b.length?b.trigger("click"):b.length>1&&$(".jsMediaVariationSelector").length>0?(a=$(".jsMediaVariationSelector").val(),b.each(function(){var b=$(this);b.siblings(".data").find('.link[data-pub="'+a+'"]').length&&b.click()})):b.length>1?b.first().click():$(e).length>0&&$(e).trigger("click")}})}function e(a,b){return a.setLanguageAttributesMakerFn(function(a){var c,d,e,f;return c=_.find(b.languages,function(b){return a===b.locale}),c||(c={direction:n.getPageConfig("CONTENT_LANG_DIRECTION"),code:n.getPageConfig("WT_LANG"),script:n.getPageConfig("CONTENT_LANG_SCRIPT")}),d="dir-"+c.direction,e="ml-"+c.code,f="ms-"+c.script,{classes:[d,e,f],attributes:{lang:a,"xml:lang":a,dir:c.direction}}})}function f(a,b){return a=c(a,b),a=d(a,b),a=e(a,b),a=a.addBehavior(k),b.canPersistFunctionalCookies?(a=a.addBehavior(j),"video"===b.builderType&&(a=a.addBehavior(h).addBehavior(i).setSubtitlesMode(i.getSubtitlesMode()))):"video"===b.builderType&&(a=a.setSourceSelectionFn(g)),a}var g=module.require("defaultMediaPlayerSourceSelectionFn"),h=module.require("rememberResolutionBehavior"),i=module.require("rememberSubtitlesBehavior"),j=module.require("rememberPlaybackRateBehavior"),k=module.require("timestampPlaybackBehavior"),l=module.require("PubMediaResource"),m=module.require("configureDownloadModal"),n=module.require("settings");module.define("configurePlayerBuilder",f)}(),function(){"use strict";var a,b,c=window.MediaPlayer,d=window.sprintf,e=module.require("PubMediaResource"),f=module.require("signal"),g=module.require("settings"),h=module.require("configurePlayerBuilder"),i=module.require("defaultMediaPlayerSourceSelectionFn"),j=module.require("rememberSubtitlesBehavior"),k=module.require("rememberResolutionBehavior"),l=module.require("rememberPlaybackRateBehavior"),m=module.require("legalNotices"),n={};a=Class.extend({init:function(a,b,c){var d,e,f,g,h=0;if(!a.exists())throw new Error("Element does not exist");g=a.hasClass("autoplay"),a.is("div")||(e=$("<div>"),e.data(a.data()),e.attr("id",a.attr("id")),a.replaceWith(e),a=e),d=a.parent(".jsVideoPlayer, .jsAudioPlayer"),d.addClass("jsPlayerLoading"),c=_.defaults(c||{},{fileType:a.data("filetype"),preferredLanguage:a.data("lang"),playOne:!1,playShuffled:!1,trackIdentifierField:!1,autoPlay:g}),f=c.poster||b.posterImage,f||(f=a.closest(".jsEmbeddedContentPosterSearchBoundary").find(".jsVideoPoster").data("src")),f||(f=b.pageID?$(".jsVideoPoster").filter("."+b.pageID).data("src"):null),this.setPosterURL(f),this.elem=a,this.parent=d,this.mediaList=b,this.autoPlay=c.autoPlay,this.isVideo=d.hasClass("jsVideoPlayer"),this.trackIdentifierField=c.trackIdentifierField,this.alwaysIgnoreMarkers=c.ignoreMarkers,this.languages=[],this.isVideo||(this.elem.addClass("jsPinListener"),this.elem.on("pinned",this._onPin.bind(this)),this.elem.on("unpinned",this._onUnpin.bind(this))),this._generatePlayerID(),this.elem.attr("data-jsonurl",b.sourceURL),this.loadFiles=b.listLanguages().then(function(a){return this.languages=a,h=c.preferredLanguage||_.first(a).code,b.dataset.languages[h]&&(this.locale=b.dataset.languages[h].locale),_.isArray(c.fileType)?b.listAllFiles(h).then(function(a){return _.filter(a,function(a){return _.contains(c.fileType,a.fileType)})}):b.listFiles(h,c.fileType)}.bind(this)),this.loadPending=this.loadFiles.then(function(a){return this._createPlayer(a,c).then(function(a){if(_.isFunction(c.onPlayerCreated))return c.onPlayerCreated(a)})}.bind(this)),this.loadPending.done(function(){var a;a=function(){this.parent.trigger("StreamingController:on:ready"),this.parent.removeClass("jsPlayerLoading"),this.parent.addClass("jsPlayerLoaded"),this.elem.show(),this.player.recalculateSizeClass()}.bind(this),this.player.isReady()?a():this.player.once("ready",a)}.bind(this))},_createPlayer:function(a,b){var d,e,i,j,k=this.isVideo?"video":"audio";return d=["itemPlaying","playbackPaused","itemEnded","playlistEnded","playlistItemOrderChanged","playerStateChanged"],e=c.builderFor(k),i=this._createMediaPlayerPlaylist(a),j=$.Deferred(),m.canPersistFunctional().then(function(a){var l={builderType:k,canPersistFunctionalCookies:a,containerEl:this.elem,languages:this.languages};e=h(e,l),this.isVideo&&e.setCrossOriginMode(c.CROSS_ORIGIN_MODES.ANONYMOUS),this._listenForCookieDataChange(),this.player=e.setAutoAdvanceEnabled(!b.playOne).setAutoPlayEnabled(b.autoPlay).setDefaultLocale(g.getPageConfig("CONTENT_LANG")||"en").setTranslationStringsProvider(new c.translationStringsProviders.Remote).setPlaylist(i).build(this.elem[0]),this.player.once("playlistReady",function(){b.ignoreMarkers||this._attachMarkers(i)},this),b.playShuffled&&this.player.shuffle(),this.player.on(d.join(" "),this._updatePlayerUI.bind(this)),this.player.on("playbackPaused",function(){f.send("MediaPlayerPaused",{player:this.player})},this),this.player.on("itemEnded",function(a){f.send("MediaPlayerItemEnded",{item:a,player:this.player})},this),this._attachEventHandlers(),f.send("StreamingControllerInitialized",this),n[this.getPlayerID()]=this,j.resolve(this.player)}.bind(this)),j},_createMediaPlayerPlaylist:function(a){var c;return c=_.filter(a,function(a){return"application/zip"!==a.mimetype}),new b(c,this.posterURL,!this.isVideo,this.locale)},_listenForCookieDataChange:function(){this._cookieSettingsChangeListener=function(a){this.player&&(a[m.lib.CookieDataTypes.FUNCTIONAL]?(this.player.addBehavior(l),this.isVideo&&this.player.addBehavior(k).addBehavior(j)):(this.player.removeBehavior(l),this.isVideo&&(this.player.removeBehavior(k).removeBehavior(j),this.player.setSourceSelectionFn(i))))}.bind(this),m.client.on(m.lib.ClientEvents.SETTINGS_CHANGED,this._cookieSettingsChangeListener)},_onPin:function(){this.isVideo||this.player._hideCurrentMenu()},_onUnpin:function(){this.isVideo||(this.player._hideCurrentMenu(),this._unfocusVolumeControl())},_unfocusVolumeControl:function(){var a;this.isVideo||this.elem.find(".probably-keyboard-focused").length||(a=$(document.activeElement),a.hasClass("vjs-mute-control")&&a.blur())},getPlayer:function(){return this.player},getWrapperElem:function(){return this.parent},loading:function(){return this.loadPending},remove:function(){},loadPlaylist:function(a,b,c){c=c||{};var d,e=this.getPlayer(),f=!this.alwaysIgnoreMarkers&&!c.ignoreMarkers;c.language&&(this.locale=_.chain(this.languages).find({code:c.language}).pick("locale").values().first().value()),this.elem.attr("data-jsonurl",b),f&&this._removeAllMarkers(),e&&(d=this._createMediaPlayerPlaylist(a),e.once("playlistReady",function(){c.shouldShuffle&&e.shuffle(),f&&this._attachMarkers(d)},this),e.isReady()&&e.isPaused()?e.changePlaylistSynchronously(d).queueItem(0):e.prepareToChangePlaylist(d).then(function(a){a.queueItem(0)}).catch(function(a){throw a}))},_attachEventHandlers:function(){var a,b,c,d,e,g=this.getPlayerID(),h=this.getPlayer(),i=this;d=function(a){a.preventDefault();var b=i.getCurrentTrackID(),c=$(this).data("trackid"),d=i.getPlaylistIndexUsingTrackID(c);$(this).hasClass("disabled")||_.isUndefined(b)||!h.isReady()||_.isUndefined(c)||(c!==b?h.playItemAt(d):h.isPaused()?h.play():h.pause())},a=['a.jsTrackPlay[data-mediaplayer="%s"]','button.jsTrackPlay[data-mediaplayer="%s"]','a.jsTrackPause[data-mediaplayer="%s"]','button.jsTrackPause[data-mediaplayer="%s"]','a.jsTrackPlayLink[data-mediaplayer="%s"]'],b=_.map(a,function(a){return a.format(g)}).join(","),c=$(b),c.hide(),h.isReady()?c.show():h.once("ready",function(){c.show()}),$(document).on("click",b,d),e=function(){h.isReady()&&!h.isPaused()&&h.pause()},f.listen("mediaPause",e),this.remove=function(){$(document).off("click",b),this._cookieSettingsChangeListener&&m.client.off(m.lib.ClientEvents.SETTINGS_CHANGED,this._cookieSettingsChangeListener),h.destroy(),f.send("StreamingControllerDestroyed",i),delete n[g],f.stopListening("mediaPause",e)},this.parent.on("remove",this.remove.bind(this)),h.on("itemPlaying",function(a){f.send("MediaPlayerPlaying",{item:a,player:h}),f.send("requestSilence",i.getPlayerID())})},getCurrentTrackID:function(){if(this.player&&this.player.getCurrentItem())return this.trackIdentifierField?this.player.getCurrentItem()[this.trackIdentifierField]:this.player.getCurrentItemIndex()},getPlaylistIndexUsingTrackID:function(a){var b,c;if(!this.player)return-1;if(!(b=this.player.getPlaylist())||!b.isLoaded())return-1;if(!this.trackIdentifierField)return a;for(c=0;c<b.getNumberOfItems();c++)if(b.getItemAt(c)[this.trackIdentifierField]===a)return c;return-1},_attachMarker:function(a,b){var c,e,f=this._parseMarkerTime(b.startTime);if(b.mepsParagraphId)c='[data-pid="'+b.mepsParagraphId+'"]';else{if(!b.verseNumber)return;c='[id^="v"][id$="'+d("%03d",b.verseNumber)+'"].verse'}e=$(c),e.hasClass("jsHasMediaMarker")&&e.data("start")<f||(e.data("trackid",a),e.data("start",f),e.data("player",this.player),e.data("streaming-controller",this),e.addClass("jsHasMediaMarker"))},_parseMarkerTime:function(a){if(!a)return-1;var b=a.split(":"),c=parseFloat(b.pop(),10),d=parseInt(b.pop(),10);return 60*parseInt(b.pop(),10)*60+60*d+c},_removeAllMarkers:function(){$(".jsHasMediaMarker").removeData(["trackid","start","player","streaming-controller"]).removeClass("jsHasMediaMarker")},_attachMarkers:function(a){_.times(a.getNumberOfItems(),function(b){var c,d=a.getItemAt(b);c=this.trackIdentifierField?d[this.trackIdentifierField]:_.pluck(a.getItems(),"track").indexOf(d.track),_.each(d.getMarkers(),this._attachMarker.bind(this,c))},this)},_generatePlayerID:function(){this.elem.attr("id")||this.elem.attr("id",_.uniqueId("mediaPlayer"))},getPlayerID:function(){return this.elem.attr("id")},_updatePlayerUI:function(){var a,b,c,d,e,f=this.getPlayerID(),g=$("*[data-mediaplayer="+f+"]"),h=this.getCurrentTrackID();a=g.filter(".jsTrackPlay, .jsTrackPause"),b=g.filter(".jsTrackPlay[data-trackid="+h+"],.jsTrackPause[data-trackid="+h+"]"),c=g.filter(".jsTrackPlay[data-trackid!="+h+"],.jsTrackPause[data-trackid!="+h+"]"),d=g.filter(".jsTrackState[data-trackid="+h+"]"),e=g.filter(".jsTrackState").not(d),this.player.isPlaying()?(b.removeClass("jsTrackPlay").addClass("jsTrackPause"),b.find(".buttonIcon").removeClass("play").addClass("pause"),b.find(".srText").html(_t("CMSPUBS.LnkTtlAttPause")),b.find(".buttonText").html(_t("CMSPUBS.LblPause")),c.removeClass("jsTrackPause").addClass("jsTrackPlay"),c.find(".buttonIcon").removeClass("pause").addClass("play"),c.find(".srText").html(_t("CMSPUBS.LnkTtlAttPlay")),c.find(".buttonText").html(_t("CMSPUBS.LblPlay")),this.parent.removeClass("excludePin")):(a.removeClass("jsTrackPause").addClass("jsTrackPlay"),a.find(".buttonIcon").removeClass("pause").addClass("play"),a.find(".srText").html(_t("CMSPUBS.LnkTtlAttPlay")),a.find(".buttonText").html(_t("CMSPUBS.LblPlay"))),c.removeClass("jsTrackActive"),e.removeClass("jsTrackActive"),this.player.isReady()&&this.player.getCurrentItem()&&this.player.hasCurrentItemPlayed()&&(d.addClass("jsTrackActive"),b.addClass("jsTrackActive"))},setPosterURL:function(a){this.posterURL=a},pause:function(){var a=this.getPlayer();a&&a.isReady()&&a.isPlaying()&&a.pause()}}),f.listen("requestSilence",function(a){_.each(n,function(b){b.getPlayerID()!==a&&b.pause()})}),f.listen("docSubImageChange",function(){_.each(n,function(a){a.getPlayer().isReady()&&a.getPlayer().recalculateSizeClass()})}),a.from_url=function(b,c){var d;return function(b){return new a(c,b)},d=new e(b),new a(c,d)},b=c.playlists.PubMedia.extend({init:function(a,b,c,d){this._setItems(_.chain(a).sortBy("track").groupBy("track").map(function(a,e){var f=this._mapItem(null,a);return f.track=parseInt(e,10),f.setLocale(d),c?f.setPosterURL(""):b&&f.setPosterURL(b),f}.bind(this)).value())},getItems:function(){return this._items}}),module.define("StreamingController",a)}(),function(){"use strict";var a,b=module.require("StreamingController");a=b.extend({init:function(a,b,c){this._super(a,b,c),c=c||{},this.shouldStopOnMarker=!0,this._playerReadyHandler=c.playerReadyHandler},_seekToStartMarker:function(){var a=this.mediaList.startMarker;a&&this.getPlayer().seek(this._parseMarkerTime(a.startTime))},_attachEventHandlers:function(){var a=this,b=this.getPlayer();a._super(),b.once("ready",function(){_.isFunction(a._playerReadyHandler)&&a._playerReadyHandler()}),b.once("itemPlaying",function(){a._seekToStartMarker()}),b.once("seekEnded",function(){b.once("seekEnded",function(){a.shouldStopOnMarker=!1})}),b.on("markerEnded",function(c){var d=a.mediaList.endMarker;a.shouldStopOnMarker&&d&&c.bibleBookNumber>=d.bibleBookNumber&&c.bibleBookChapter>=d.bibleBookChapter&&c.startTime===d.startTime&&(b.pause(),a.shouldStopOnMarker=!1)})}}),module.define("RangeStreamingController",a)}(),function(){"use strict";var a,b=module.require("UIController"),c=module.require("SimpleModal"),d=module.require("StreamingController"),e=module.require("settings");a=b.extend({ERROR_TEMPLATE:"MediaModalError",init:function(a){this._super(),this.options=_.extend({extraClasses:""},a||{}),_.isArray(this.options.extraClasses)&&(this.options.extraClasses=_.filter(this.options.extraClasses,_.identity).join(" "))},open:function(a){var b=this;this.injectCallback=a,this._draw().fail(function(){return b._displayErrorMessage(d.GENERIC_ERROR)})},_displayErrorMessage:function(a){var b=this;return this._fetchTemplate(this.ERROR_TEMPLATE).then(function(c){c=$(c),rivets.bind(c,{content:a,controller:b,literals:_t.literals}),b._injectHTML(c)})},_beforeClose:function(){this.streaming&&this.streaming.remove()},_initStreaming:function(a,b){var c=this.html.find(".jsMediaPlayer");b=b||{},b.onPlayerCreated=this.onPlayerCreated.bind(this),b.ignoreMarkers=this.options.ignoreMarkers,b.poster=this.options.poster,!this.streaming&&c.exists()&&(this.streaming=new d(c,a,b))},onPlayerCreated:function(){},_injectHTML:function(a){this._super(a),this.streaming&&(this.streaming.remove(),delete this.streaming),this._hasInjected||(this.injectCallback?this.injectCallback(a):this._openModal(a)),this._hasInjected=!0},_openModal:function(a){this.modal=new c(a),this.modal.updateSettings({beforeClose:this._beforeClose.bind(this)}),this.modal.open()},_pausePlayer:function(){this.streaming&&this.streaming.getPlayer()&&this.streaming.getPlayer().pause()},_updateStreamingPlaylist:function(a,b,c){var d;this.streaming?this.streaming.getPlayer()&&(d=_.isArray(b)?c.listAllFiles(a).then(function(a){return _.filter(a,function(a){return _.contains(b,a.fileType)})}):c.listFiles(a,b),d.then(function(b){c.posterImage&&this.streaming.setPosterURL(c.posterImage),this.streaming.loadPlaylist(b,c.sourceURL,{language:a})}.bind(this))):this._initStreaming(c,{fileType:b,preferredLanguage:a,ignoreMarkers:this.options.ignoreMarkers})},_findArchives:function(a){var b=this;return _.filter(a,function(a){return b._isArchiveMimetype(a.mimetype)})},_isArchiveMimetype:function(a){return a===e.getSetting("ARCHIVE_MIMETYPE")},_sortByFileLabel:function(a){return _.sortBy(a,function(a){return parseInt(a.label,10)})},_parseFileBundles:function(a,b){var c,d=this._findArchives(b);a.state.bundled=this._sortByFileLabel(d),a.state.hasBundles=function(){return a.state.bundled.length>0},c=_.first(a.state.bundled),a.state.bundleLabel=c?c.title:""},_toggleTimedTextCaptions:function(a){this.streaming.getPlayer().setSubtitlesMode(a?"SUBTITLES_ANY":"SUBTITLES_OFF")},setCoverImage:function(a){this.coverImage=a||e.getSetting("COVER_IMAGE")},setDefaultPubName:function(a){this.defaultPubName=a},_reorderArchivesFirst:function(a){var b=this._findArchives(a),c=_.difference(a,b);return b.concat(c)},_getTitleForArchive:function(a){return!a.fileType||"DAISY"!==a.fileType&&"ZIP"!==a.fileType?_.reduce(["specialty","format","edition"],function(b,c){return b||_.isEmpty(a[c])?b:a[c+"Descr"]},!1)||_t("CMSPUBS.LblDownloadAllFiles"):a.title}}),module.define("MediaModal",a)}(),function(){"use strict";var a,b=module.require("settings"),c=module.require("MediaModal"),d=module.require("FileUtils"),e=module.require("FilteringContainer"),f=module.require("SegmentControl"),g=module.require("PubMediaResource"),h=window.sprintf;a=c.extend({TEMPLATE_NAME:"DownloadModal",init:function(a,b){var c=this;this._super(b),this.resource=a,this.on("UIController:injectedHTML",function(a,b){b.state.activeFileType&&b.state.activeLanguage&&c._initStreaming(c.resource,{fileType:b.state.activeFileType,preferredLanguage:b.state.activeLanguage.code})})},onLanguageChange:function(a,b){var c=b.controller,d=$(this).val();c._getTrackList(d).then(function(a){var e;e=function(){var e=!1;b.state.files=a,b.state.fileTypes=c._getAvailableFormats(a),b.state.activeLanguage=_.extend({},_.findWhere(b.state.languages,{code:d})),e=_.chain(b.state.fileTypes).pluck("name").contains(b.state.activeFileType).value(),e||(b.state.activeFileType=c._choosePreferredFileType(b.state.fileTypes,c.options.preselect)),c._selectFileType(b.state.activeFileType),c._onStateChange(b)},c.modal?c.modal.transitionModalContent(e):e()})},onFileTypeChange:function(a,b){function c(){d.filteringContainer.filterResults(e),b.state.activeFileType=e,d._onStateChange(b)}var d=b.controller,e=$(this).data("type");d.modal?d.modal.transitionModalContent(c):c()},_onStateChange:function(a){a.state.hasStreamableContentVisible=_.reduce(a.state.files,function(b,c){return b||c.streamable&&c.fileType===a.state.activeFileType},!1),a.state.lastModifiedLabel=this._getModifiedLabelString(a.state.files,a.state.activeFileType),this._updateStreamingPlaylist(a.state.activeLanguage.code,a.state.activeFileType)},_buildStateContext:function(){var a,c,d,e,f,g,h,i,j,k,l,m=this;return a=this.resource.listLanguages().then(function(a){return _.each(a,function(b,c){a[c].isActive=!1}),a}),c=a.then(function(a){return _.filter(a,function(a){return a.isPrimary})}).then(function(a){return _.extend({},_.first(a))}),f=this.resource.getPubName().then(function(a){return a||m.defaultPubName}),g=this.resource.getFormattedDate(),h=c.then(function(a){return m._getTrackList(a.code)}),d=h.then(m._getAvailableFormats),e=d.then(function(a){return m._choosePreferredFileType(a,m.options.preselect)}),l=h.then(function(a){return e.then(function(b){return m._getModifiedLabelString(a,b)})}),j=d.then(function(a){return _.reduce(a,function(a,c){return a||b.getSetting("AUDIO_FORMATS").indexOf(c.name.toUpperCase())>=0},!1)}),i=h.then(function(a){return _.reduce(a,function(a,b){return a||b.streamable},!1)}),k=c.then(function(a){return"dir-"+a.direction}),{activeFileType:e,activeLanguage:c,coverImage:this.coverImage,fileTypes:d,files:h,lastModifiedLabel:l,languages:a,multiLanguageDisplay:a.then(function(a){return a.length>1}),hasMultipleFileTypes:d.then(function(a){return a.length>1}),pubName:f,pubDate:g,hasStreamableContentVisible:i,hasAudioFormat:j,activeLanguageDirection:k}},_getAvailableFormats:function(a){var b=_.chain(a).pluck("fileType").uniq().value();return g.sortFileFormats(b)},_getTrackList:function(a){return this.resource.listAllFiles(a).then(function(a){return this._processFileList(a,!0)}.bind(this))},_processFileList:function(a,b){var c=this;return _.chain(a).map(function(a){return _.extend({originalTitle:a.title},a)}).groupBy(function(a){return a.specialty||a.format||a.edition}).map(function(a){var d=c._findArchives(a),e=_.difference(a,d);return d=_.map(d,function(a){return a.title=c._getTitleForArchive(a),a}),b?d.concat(e):a}).values().flatten(!0).map(c._extendFileInformation.bind(c)).map(function(){var a=0;return function(b){return b.streamable&&(b.playlistIndex=a,a++),b}}()).value()},_calculateModifiedDate:function(a,b){return _.chain(a).filter(function(a){return!b||a.fileType===b}).map(function(a){return a.file.modifiedDatetime.split(" ")[0]}).sort().last().value()},_getModifiedLabelString:function(a,b){var c=this._calculateModifiedDate(a,b);return c?h(_t("CMSPUBS.LblLastUpdated"),c):""},_extendFileInformation:function(a){return a.prettyFileSize=d.getPrettyFileSizeString(a.filesize),a.streamable=a.mimetype===b.getSetting("AUDIO_STREAM_MIMETYPE"),a.isArchive=d.isArchiveMimetype(a.mimetype),!a.isArchive&&this._shouldShowVariationDescr([a.specialty,a.format,a.edition])&&(a.title=a.title+" - "+(a.specialtyDescr||a.formatDescr||a.editionDescr)),a.fileExtension=a.isArchive?"ZIP":a.fileType,a},_shouldShowVariationDescr:function(a){var b=["BR1","BR2","BR1ftn","BR2ftn","ftn"];return!_.isEmpty(_.intersection(b,a))},_onFirstRender:function(a){var b=this.html.find(".jsFileTypes"),c=this.html.find(".downloadFiles");this.fileTypeControl=new f(b),this.filteringContainer=new e(c,{filterDataAttribute:"fileformat"}),this._selectFileType(a.state.activeFileType)},_selectFileType:function(a){this.fileTypeControl.selectSegment('[data-type="'+a+'"]'),this.filteringContainer.filterResults(a)},_choosePreferredFileType:function(a,b){var c=_.first(a);return b&&(c=_.findWhere(a,{name:b.toUpperCase()})||c),c.name},_updateStreamingPlaylist:function(a,b,c){return c=c||this.resource,this._super(a,b,c)}}),module.define("DownloadModal",a)}(),function(){"use strict";var a,b=module.require("DownloadModal"),c=module.require("PubMediaResource");a=b.extend({TEMPLATE_NAME:"BibleModal",onBookSelect:function(a,b){var c=$(this).parent().data("booknum");a.preventDefault(),b.controller.selectBook(b,c)},selectBook:function(a,b){b=parseInt(b,10);var c,d=this,e=this._getBookResource(b),f=this.html.find(".book"),g=f.filter('[data-booknum="'+b+'"]'),h=g.find("h2"),i=g.next(".book"),j=a.state.activeLanguage.code,k=a.state.activeFileType.name;return this._resetExpandCollapseState(),a.state.activeBookNum===b?(a.state.hasStreamableContentVisible=!1,a.state.activeBookNum=null):(a.state.hasStreamableContentVisible=!0,a.state.activeBookNum=b,h.removeClass("viewHdgCollapse").addClass("viewHdgExpand"),c=function(){if(i.exists()){var b=i.data("booknum");d.selectBook(a,b).then(function(){d.streaming.autoPlay()})}},d._updateStreamingPlaylist(j,k,e),d.streaming.loading().then(function(){var a=d.streaming.getPlayer();a&&a.on("playlistEnded",c)})),e.listAllFiles(j).then(function(b){d._updateChapters(a,b)})},_resetExpandCollapseState:function(){this.html.find(".book").find("h2").removeClass("viewHdgExpand").addClass("viewHdgCollapse")},onFileTypeChange:function(a,b){var c=b.controller;this._super(a,b),b.state.activeBookNum=null,c._resetExpandCollapseState(),c._updateChapters(b,[])},_onStateChange:function(a){this._super(a),a.state.files=this._appendHasChapterToFiles(a.state.files)},_buildStateContext:function(){var a=this._super();return a.activeBookNum=null,a.files=a.files.then(this._appendHasChapterToFiles),a},_appendHasChapterToFiles:function(a){return _.map(a,function(a){return a.hasChapters="MP3"===a.fileType,a})},_getBookResource:function(a){var b=this.resource.sourceURL,d="booknum="+parseInt(a,10);return b.indexOf("booknum")?b=b.replace(/booknum=[\d]+/,d):b+="&"+d,new c(b)},_updateChapters:function(a,b){b=this._processFileList(b),_.each(a.state.files,function(c){c.booknum===a.state.activeBookNum?(c.chapters=b,c.active=!0):(c.chapters=[],c.active=!1)}),this.filteringContainer.filterResults(a.state.activeFileType)},_getTrackList:function(a){return this.resource.listAllFiles(a).then(function(a){return this._processFileList(a,!1)}.bind(this))}}),module.define("BibleModal",a)}(),function(){"use strict";var a,b=module.require("DownloadModal");a=b.extend({TEMPLATE_NAME:"TourBrochureModal",MODAL_CONFIG:{},_buildStateContext:function(){return{pubName:this.title||this.resource.getPubName(),files:this.__listFiles()}},__listFiles:function(){var a=this,b=this.resource.listLanguages();return b=b.then(function(b){return _.map(b,function(b){return a.resource.listFileTypes(b.index).then(function(c){return _.map(c,function(c){return a.resource.listFiles(b.index,c.name)})})})}),a._resolveDeferrends(b).then(function(a){return _.flatten(a)})}}),module.define("TourBrochureModal",a)}(),function(){"use strict";var a,b=module.require("settings"),c=module.require("signal"),d=module.require("DownloadModal"),e=module.require("DropdownMenu"),f=module.require("Autocomplete"),g=module.require("PubMediaResource"),h=["MP4","M4V"];a=d.extend({TEMPLATE_NAME:"VideoModal",init:function(a,b){this._super(a,b),this.autoPlay=!1,this.title=void 0,this.highlighterTarget=b.highlighterTarget},onLanguageChange:function(a,b){var d,e=$(this).val();d={currentLang:e,previousLang:b.state.activeLanguage,isModalEmbedded:b.controller.isEmbedded()},c.send("VideoModal:languageChanged",d),this._super(a,b)},setAutoPlay:function(a){this.autoPlay=!0===a},setTitle:function(a){return this.title=a,this.title},_buildStateContext:function(){var a=this._super();return a=_.extend(a,{autoPlay:this.autoPlay,jsonURL:this.resource.sourceURL}),this.isEmbedded()||(a.multiLanguageDisplay=!1),this.highlighterTarget&&(a.videoPlayerClasses="jsMarkersEnabled",a.highlighterTarget=this.highlighterTarget),a.tracksForDownload=a.files.then(function(a){return this._getTracksForDownloadList(a||[])}.bind(this)),a},_onStateChange:function(a){this._super(a),a.state.tracksForDownload=this._getTracksForDownloadList(a.state.files)},_getTracksForDownloadList:function(a){function b(a){return _.chain(a).groupBy("label").values().map(function(a){var b=_.where(a,{subtitled:!0});return b.length===a.length?a:_.without(a,b)}).flatten(!0).value()}return _.map(a||[],function(a){return _.extend({},a,{files:b(a.files),videoFiles:b(a.videoFiles)})})},_getAvailableFormats:function(a){var b;return b=_.chain(a).map(function(a){return _.pluck(a.files,"fileType")}).flatten().uniq().value(),g.sortFileFormats(b)},_getTrackList:function(a){return this._super(a).then(this._groupFilesByTrack.bind(this)).then(this._reorderArchivesFirst.bind(this))},_groupFilesByTrack:function(a){var c,d=0,e=this;return _.chain(a).map(function(a){return a.isArchive&&(a.track=-1),a}).groupBy("track").values().each(function(a){_.each(a,function(a){a.fileTypeAndSize="%s %s".format(a.fileType,a.prettyFileSize),a.isVideo=!1,_.contains(b.getSetting("VIDEO_FORMATS").split(","),a.fileType)&&(a.isVideo=!0)})}).filter(function(a){return _.some(a,function(a){return!0===a.isVideo})}).tap(function(a){c=a.length}).map(function(a){var f,g,h,i,j,k;return k=e._filterAndSortVideoFiles(a),j=_.pluck(k,"fileType"),i=_.first(e._sortFileTypes(j)),f=_.find(k,function(a){return a.fileType===i.name}),
h=c>1?f.trackImage.url||b.getSetting("VIDEO_THUMBNAIL"):null,g=_.pick(f,"title","isArchive","fileType","fileExtension","mimetype","subtitled"),_.extend(g,{thumbnail:h,files:a,videoFiles:k,audioFiles:_.where(a,{isVideo:!1}),playlistIndex:d++})}).value()},_filterAndSortVideoFiles:function(a){return _.chain(a).where({isVideo:!0}).map(function(a){return a.hasTTS=_.isObject(a.subtitles),a}).groupBy("label").values().map(function(a){var b,c;return b=_.filter(a,function(a){return!a.subtitled&&!a.hasTTS}),c=_.filter(a,function(a){return a.hasTTS}),0===c.length&&(c=_.filter(a,function(a){return a.subtitled})),_.union(b,c)}).flatten(!0).value().sort(function(a,b){return b.label.localeCompare(a.label,void 0,{numeric:!0})})},_calculateModifiedDate:function(a){var b=_.chain(a).pluck("files").flatten().value();return this._super(b)},_onFirstRender:function(){this._super.apply(this,arguments);var a=this,b=this.html.hasClass("jsEmbedded")?null:this.html;!b&&$(this.html).parents(".standardModal").length&&(b=$(this.html).closest(".standardModal")),this._dropdowns=[],this.html.find(".jsDropdownMenu").each(function(){a._dropdowns.push(new e($(this),b,".fileContainer"))}),this.html.find(".selectSpokenLanguage select").change(),this.autocomplete=new f(this.html.find(".modalLangPicker:visible select"),{maxColumns:1,showFeatured:!0}),this.autocomplete.init(),this.filteringContainer.disableFilter()},_sortFileTypes:function(a){var c,d=["3GP"];return d=d.concat(b.getSetting("AUDIO_FORMATS").split(",")),c=g.sortFileFormats(a),c=_.sortBy(c,function(a,b){var c=-1!==d.indexOf(a.name),e=-1!==d.indexOf(b.name);return c&&!e?1:!c&&e?-1:0})},_choosePreferredFileType:function(a,b){var c=_.first(this._sortFileTypes(_.pluck(a,"name")));return b&&(c=_.findWhere(a,{name:b.toUpperCase()})||c),c.name},isEmbedded:function(){return this.options.isEmbedded||$(this.html).hasClass("jsEmbedded")},_updateStreamingPlaylist:function(a,b,c){return this._super(a,h,c)},_initStreaming:function(a,b){return b.fileType=h,this._super(a,b)}}),module.define("VideoModal",a)}(),function(){"use strict";var a,b=module.require("MediaModal"),c=module.require("PubMediaResource"),d=module.require("DropdownMenu"),e=module.require("FileUtils");a=b.extend({TEMPLATE_NAME:"VideoBibleModal",init:function(a,b){this._super(),this.baseURL=b,this.books=_.map(a,function(a,b){return{active:!1,booknum:parseInt(b,10),title:a,chapters:[]}})},onAccordionSelect:function(a,b){var c,d=$(this),e=d,f=d.closest(".book").data("booknum");if(e.hasClass("viewHdgExpand"))return b.controller._closeAllBooks(b);c=b.controller._loadBook(b,f),c.then(function(){return e.removeClass("viewHdgCollapse").addClass("viewHdgExpand"),b.controller._redraw()}).then(function(){b.controller._onDraw()})},onBookSelect:function(a,b){var c=$(this),d=c.val();b.controller.html.find(".book[data-booknum="+d+"] h2").click()},onChapterJump:function(a,b){if(b.controller.streaming||b.controller.streaming.getPlayer()){b.controller.streaming.getPlayer().playItemAt(parseInt(b.state.activeTrack,10))}},_buildStateContext:function(){return{activeLanguage:{},activeFileType:{},activeBook:{},activeTrack:0,pubName:"",parentPubName:"",books:this.books}},_closeAllBooks:function(a){_.each(a.state.books,function(a){a.active=!1}),a.controller.html.find(".book h2").removeClass("viewHdgExpand").addClass("viewHdgCollapse")},_fillChapterList:function(a,b,c){var d;b=parseInt(b,10),this._closeAllBooks(a),d=_.find(a.state.books,function(a){return a.booknum===b}),_.each(c,function(b){b.fileExtension=b.fileExtension||a.state.activeFileType,_.each(b.resolutions,function(a){a.prettyFileSize=e.getPrettyFileSizeString(a.filesize),a.fileTypeAndSize="%s %s".format(a.fileType,a.prettyFileSize)})}),d.chapters=c,d.active=!0,a.state.activeBook=$.extend({},d),a.state.activeTrack=0},_groupFiles:function(a){var b=0;return a=_.groupBy(a,"track"),_.map(a,function(a){var c=_.first(a);return{playlistIndex:c.isArchive?-1:b++,track:c.track,name:c.title,resolutions:_.sortBy(a,_.property("label")),title:c.title,mimetype:c.mimetype,isArchive:c.isArchive,fileExtension:c.fileExtension}})},_loadBook:function(a,b){var c,d,e,f,g,h=this;return c=this._loadBookResource(b),c.getPubName().then(function(b){a.state.pubName=b}),c.getParentPubName().then(function(b){a.state.parentPubName=b}),d=c.listLanguages(),d=d.then(function(b){return e=_.first(b),a.state.activeLanguage=e,c.listFileTypes(e.code)}),d=d.then(function(b){return g=_.pluck(b,"name"),f=_.first(b),a.state.activeFileType=f,c.listAllFiles(e.code)}),d=d.then(function(a){return h._parseArchives(a),a}),d=d.then(this._groupFiles),d=d.then(this._reorderArchivesFirst.bind(this)),d=d.then(function(c){h._fillChapterList(a,b,c)}),d=d.then(function(){h._updateStreamingPlaylist(e.code,g,c),h.streaming.loading().then(function(){var b=h.streaming.getPlayer();b&&b.on("playlistEnded",function(){return h._nextBook(a)})})})},_loadBookResource:function(a){var b=this.baseURL,d="booknum="+parseInt(a,10);return-1!==b.indexOf("booknum")?b=b.replace(/booknum=[\d]+/,d):b+="&"+d,new c(b)},_nextBook:function(a){var b,c;b=_.find(a.state.books,function(a){return a.active}),c=a.state.books.indexOf(b)+1,a.state.books[c]&&this._loadBook(a,a.state.books[c].booknum)},_draw:function(){var a=this;return this._super().done(function(){a.html.find(".book:first h2").click(),a._onDraw()})},_onDraw:function(){var a=this;this._dropdowns=[],this.html.find(".jsDropdownMenu").each(function(){a._dropdowns.push(new d($(this),a.html,".fileContainer"))})},_parseArchives:function(a){var b=this._findArchives(a);return _.map(b,this._addArchiveFields.bind(this))},_addArchiveFields:function(a){return a.title=this._getTitleForArchive(a),a.isArchive=!0,a.fileExtension={name:"ZIP"},a}}),module.define("VideoBibleModal",a)}(),function(){"use strict";var a,b=module.require("signal"),c=module.require("loadingIndicator"),d=module.require("insight"),e=module.require("url");a=Class.extend({swapContent:function(a,e,f,g){var h,i=$(e.join(", ")),j=this;return c.open(),h=$.get(a),g||i.fadeOut(),h.fail(function(){window.location.href=a}),h.done(function(a){var h,i,k,l,m,n,o,p=$(a);for(l=p.filter("#pageConfig").data("page_id"),c.close(),f&&(j.updatePageID(l),d.updateContextID(j.getInsightContextIDFromHTML(a)),m=p.filter("title"),j.updatePageTitle(m.text()),n=p.filter(".jsVideoPoster"),j.updateVideoPoster(n)),o=0;o<e.length;o++)h=e[o],i=$(h),k=p.filter(h),k=k.length>0?k:$(h,p),g||k.hide(),i.replaceWith(k),g||$(h).fadeIn();j.updateAnchorLinks(),b.send("DOMReady")}),h},getInsightContextIDFromHTML:function(a){var b=document.createElement("html");return b.innerHTML=a,b.getElementsByTagName("body")[0].getAttribute("data-insight-context-id")},getHTML:function(a,b){return a?$.getCached(a).then(function(a){return b?$(a).find(b):$(a)}):$.when(null)},navigateToURL:function(a){window.location.href=a},updateURL:function(a){if(a&&a.urlString){var b;if(a.hash?(b=e.parse(a.urlString),b.hash.path=a.hash,a.urlString=e.build(b)):a.preserveHash&&(b=e.parse(a.urlString),b.hash.path=this.getCurrentHashValue(),a.urlString=e.build(b)),a.urlString!==this.getURL()){if(!(a.overwriteHistory?this._hasReplaceState():this._hasPushState()))return void this.updateAnchorLinks();this._pushOrReplace(a.urlString,a.state,a.overwriteHistory),this.updateAnchorLinks()}}},updateHash:function(a,b,c){if(!this._hasPushState()||b&&!this._hasReplaceState())return void(window.location.hash=a);var d=e.parse(window.location.href);d.hash.path=a,this._pushOrReplace(e.build(d),c,b)},getHashFromURL:function(a){return a?e.parse(a).hash.path:null},_pushOrReplace:function(a,b,c){(c?window.history.replaceState:window.history.pushState).call(window.history,_.extend({insightEventReferrer:this.getURL()},b),null,a)},updateState:function(a){this._hasReplaceState()&&window.history.replaceState(a,null,window.location.href)},getCurrentHashValue:function(){var a=e.parse(window.location.href);return a.hash&&a.hash.path?a.hash.path:""},removeHash:function(a){if(a){var b=e.parse(a);return b.hash.path="",e.build(b)}},_hasPushState:function(){return window.history&&"pushState"in window.history},_hasReplaceState:function(){return window.history&&"replaceState"in window.history},updateAnchorLinks:function(){$('a[data-anchor^="#"]').each(function(){var a=$(this),b=window.location.pathname+a.data("anchor");a.attr("href",b)})},updatePageID:function(a){$("body").attr("id",a),$("#pageConfig").data("page_id",a)},updatePageTitle:function(a){a&&(a=$("<span></span>").html(a).text(),$("title").text(a))},updateVideoPoster:function(a){var b=$(".jsVideoPoster");if(!a.exists())return void b.remove();b.exists()?b.after(a).remove():$("body").append(a)},getURL:function(){return window.location.href},getState:function(){return this._hasPushState()?window.history.state:{}}}),module.define("Navigation",a),module.get("Navigation")}(),function(){"use strict";var a,b,c=module.require("UIController"),d=module.require("SimpleModal"),e=module.require("DialogUtils"),f=module.get("Navigation"),g=module.require("LanguageUtils"),h=module.require("signal"),i=module.get("ScrollHelper"),j=module.require("ArticleContentUtils"),k=module.require("url");b={CONTENT_CONTAINER:".standardModal-contentContainer"},a=c.extend({TEMPLATE_NAME:"SupplementalInfoModal",init:function(a){this._super(),this.options=a||{}},open:function(a){var b=this.filterHTML(a);return this._draw().then(_.bind(this.showContent,this,b))},openWithURL:function(a,b){var c,d=this,e=k.parse(a);return c=e&&e.hash?e.hash:null,this._draw().then(function(){return f.getHTML(a)}).then(function(a){var e,f;(!b||b.length<=0)&&(b=["#content","#article"]),d._setClassesFromBody(a),e=_.reduce(b,function(b,c){return b&&b.length?b:a.find(c)},!1),f=d.filterHTML(e),d.showContent(f),h.send("DOMReady"),c?this._scrollToSelector("#"+c.path):this.modal.scrollToTopOfContentContainer()}.bind(this))},_setClassesFromBody:function(a){var b;this.html&&(b=a.find("#pageConfig").addBack("#pageConfig"),this.html.addClass(b.data("body_classes")))},showContent:function(a){var b=this;this.html&&this.modal.transitionModalContent(function(){if(b.html.find(".standardModal-content").html(a),b.options.setArticleContentClasses){var c=b._getContentContainer().find("#article"),d=c.length>0?c:b._getContentContainer();g.transferLanguageAttrs($("#content #article"),d),j.transferArticleClasses(d)}})},filterHTML:function(a){var b;return b=["#sidebar",".articleFooterLinks",".youMayAlsoLike","#otherLangRibbon","#otherAvailLangs",".pubTitleBar"],a.find(b.join(",")).remove(),a.find(".jsRespImg").removeAttr("data-zoom"),a.find("#content").addBack("#content").removeAttr("id"),a.removeClass("topWhiteSpace"),a.find("a").each(function(a,b){var c=$(b);this._getAnchorAttr(c)&&c.on("click",this._onAnchorLinkClick.bind(this))}.bind(this)),_.isFunction(this.options.additionalContentFilterFn)&&(a=this.options.additionalContentFilterFn(a)),e.addSourceFlags(a,"supplementalDialog"),a},_getAnchorAttr:function(a){return $(a).attr("data-anchor")},_getContentContainer:function(){return this.html.find(b.CONTENT_CONTAINER)},_onAnchorLinkClick:function(a){var b=$(a.target.parentElement);this._scrollToSelector(this._getAnchorAttr(b))&&a.preventDefault()},_scrollToSelector:function(a){var b=this._getContentContainer(),c=b.find(a);return!!c.length&&(i.scrollTo(b,c),!0)},_injectHTML:function(a){this.modal=new d(a),this.modal.updateSettings({scrollTop:!1}),this._super(a),this.modal.open()}}),module.define("SupplementalInfoModal",a)}(),function(){"use strict";var a,b=module.require("url"),c=module.get("Navigation"),d=module.get("ScrollHelper"),e=module.require("signal");a=Class.extend({isDisabled:!1,init:function(){var a;this.isDisabled=$(".jsDisableAnchorLinkController").length>0,this.isDisabled||(a=this.onAnchorClick.bind(this),$(document).on("click","a:not(.jsNoScroll)[href*=#]",a),this.targetResolvers=[],this.addTargetResolver(function(a){return $("#"+a)}))},addTargetResolver:function(a){if(!this.isDisabled){var b=this;this.targetResolvers.unshift(a),$(document).ready(function(a){b.__scrollTimer&&clearTimeout(b.__scrollTimer),b.__scrollTimer=setTimeout(function(){b.onAnchorClick(a)},1e3)}),e.listen("PageLoaded",function(a){b.onAnchorClick({target:document},a)})}},getHash:function(a){return a=a||window.location.href,a=b.parse(a),window.location.pathname!==a.path&&a.path?void 0:a.hash.path},onAnchorClick:function(a,b){if(!this.isDisabled){var d,e,f,g,h,i=$(a.target);if(i=i.is("a")?i:i.closest("a"),d=i.exists()?i.attr("href"):void 0,(e=this.getHash(d))&&!(e.indexOf("/")>-1)){for(a.preventDefault&&a.preventDefault(),f=0;f<this.targetResolvers.length&&(h=this.targetResolvers[f],!(g=h(e)));f++);g&&g.exists()&&(b||(b=g.closest(".jsLockedContainer"),b=b.exists()?b:g.closest(".jsScrollContainer"),b=b.exists()?b:$(window)),i.hasClass("jsHighlightOnly")?c.updateHash(e):(window.location.hash=e,this.scrollTo(g,b)))}}},scrollTo:function(a,b){b=$(b);var c,e,f=$.isWindow(b.get(0))?$(document):b;c=b.height(),e=b.hasClass("jsNoScrollOffset")?0:.3789*c,d.scrollTo(b,a,-e,f)}}),module.define("AnchorLinkController",a),module.get("AnchorLinkController")}(),function(){"use strict";var a,b=module.require("settings"),c=module.require("UIController"),d=module.require("SimpleModal"),e=module.require("autocomplete"),f=b.getPageConfig("CONTENT_LANG"),g=b.getPageConfig("LANGUAGE_API");a=c.extend({TEMPLATE_NAME:"LanguagePicker",forceOnlySL:!1,noBranding:!1,open:function(a){var b=this;return this.injector=a,this._draw().then(this._updateDisplayedLanguages.bind(this)).then(function(){b.content.closest(".loading").removeClass("loading"),$(".jsLanguageCount").closest(".loading").removeClass("loading"),b._setupAutocomplete()})},onLanguageFilterClick:function(a,b){b.controller._updateDisplayedLanguages(null)},_updateDisplayedLanguages:function(a){var b=this,c=$.Deferred();return this.__updating?(c.resolve(),c):(this.__updating=!0,setTimeout(function(){b.__listLanguages().then(function(d){var e,f,g=d.languages;b.context.numLanguages=d.localizedCount,b.context.localeToLangCode=_.reduce(g,function(a,b){return a[b.symbol]=b.langcode,a},{}),e=b._findSignLanguages(g),b.context.hasSL=e.length>0,f=b.context.onlySL?e:g,b.context.optionHTML=b.__renderOptionHTML(f),b.autocomplete&&b.autocomplete.loadOptions(a),b.__updating=!1,c.resolve()})},0),c)},_buildStateContext:function(){return this.context={onlySL:this.forceOnlySL,noBranding:this.noBranding,localeToLangCode:{}},this.context},_injectHTML:function(a){var b;if(this._super(a),this.container=a,this.content=a.find(".standardModal-content"),this.injector)return this.injector(a);b=new d(a),b.updateSettings({fullscreen:!0,afterShow:function(){a.closest(".jsAutoFocusAutoComplete").find("input.jsAutoCompleteInput").focus()}}),b.open()},_setupAutocomplete:function(){var a=this,b=this.content.find("select:first");e.init(b,{showFeatured:!0}).finally(function(){this.autocomplete=b.data("autocomplete"),this.autocomplete.configureSelector(this.content,!0,!1),this.autocomplete.open(),this.container.closest(".jsAutoFocusAutoComplete").find("input.jsAutoCompleteInput").focus()}.bind(this)),b.on("autocomplete-option-selected",function(){var b,c=$(this).closest("form"),d=a.context.localeToLangCode[$(this).val()];if(d&&(b=window.ClientComponents.insight.makeEvent("languageChange").addParams({to:d}).sendAsBeacon()))return void b.then(function(){c.submit()});c.submit()})},_renderTemplate:function(a){var b=$("#templates .template.languagePicker").children().clone();return rivets.bind(b,a),this.__formalityPromise(b)},__buildLanguageContext:function(a){return a.name=a.name||"",a.vernacularName=a.vernacularName||"",a.altLabel=a.name,a.isSignLanguage?a.className="signLanguage":a.hasWebContent?a.className="hasWebContent":a.className="downloadOnly",a},__listLanguages:function(){var a=this;return $.getJSONCached(g).then(function(b){return{languages:_.map(b.languages,a.__buildLanguageContext),localizedCount:b.localizedCount}})},_findSignLanguages:function(a){return _.filter(a,_.property("isSignLanguage"))},__renderOptionHTML:function(a){return this.context.noBranding?_.reduce(a,function(a,b){var c="<option ";return b.isSignLanguage&&(c+="data-icon=\"<div class='icon'></div>\" "),c+='data-alternative-spellings="'+b.altSpellings+'" ',c+='data-language="ml-'+b.langcode+'" ',c+='data-script="ms-'+b.script+'" ',c+='class="'+b.className+'" ',c+='value="'+b.symbol+'" ',c+='lang="'+b.symbol+'" ',c+='dir="'+b.direction+'" ',c+='xml:lang="'+b.symbol+'" ',b.symbol===f&&(c+='selected="selected" '),c+='data-alternative-label="'+b.altLabel+'">',c+=b.vernacularName,c+="</option>",a+=c},""):_.reduce(a,function(a,b){var c="<option ";return c+="data-icon=\"<div class='icon'></div>\" ",c+='data-alternative-spellings="'+b.altSpellings+'" ',c+='data-language="ml-'+b.langcode+'" ',c+='data-script="ms-'+b.script+'" ',c+='class="'+b.className+'" ',c+='value="'+b.symbol+'" ',c+='lang="'+b.symbol+'" ',c+='dir="'+b.direction+'" ',c+='xml:lang="'+b.symbol+'" ',b.symbol===f&&(c+='selected="selected" '),c+='data-alternative-label="'+b.altLabel+'">',c+=b.vernacularName,c+="</option>",a+=c},"")}}),module.define("LanguagePicker",a)}(),function(){"use strict";var a,b=[];a=Class.extend({init:function(a,b){this.owner=a,this.container=b,this.elems=[],this.plugins={}},close:function(){_.each(this.elems,function(a){a.fadeOut(function(){a.remove()})})},open:function(){var a,b,c,d=this.__buildMenu(),e=this.owner,f=e.outerWidth()||_.max(e.children().map(function(){return $(this).outerWidth()})),g=e.offset();return!!d&&(e.parent().append(d),a=g.left+f/2,b=g.top,c={top:b-d.outerHeight(),left:a-d.outerWidth()/2},d.offset(c),this.elems.push(d),!0)},__buildMenu:function(){var a=$("<div></div>"),b=this.__buildElem();if(b)return a.addClass("contextMenuContainer"),a.append(b),a.append(this.__buildArrow()),a},__buildArrow:function(){var a=$("<div></div>");return a.addClass("contextMenuArrow"),a.addClass("bottom"),a},__buildElem:function(){var a,c=this,d=$("<div></div>");return d.addClass("contextMenu"),a=_.reduce(b,function(a,b){var e,f=b(c.owner);return f?(e=f.render(),e.click(function(){f.handleClick(),c.close()}),d.append(e),a+1):a},0),a?d:void 0},__buildRelativePosition:function(a,b,c){return c&&(a=this.__invertPosition(a),b=this.__invertPosition(b)),a+" "+b},__invertPosition:function(a){return{top:"bottom",bottom:"top",center:"center",left:"right",right:"left"}[a]}}),a.registerPlugin=function(a){b.push(a)},module.define("ContextMenu",a)}(),function(){"use strict";var a,b=module.require("ContextMenu");a=Class.extend({init:function(a,b,c){this.streamingController=a,this.trackID=b,this.start=c},_parseMarkerTime:function(a){if(!a)return-1;var b=a.split(":"),c=parseFloat(b.pop(),10),d=parseInt(b.pop(),10);return 60*parseInt(b.pop(),10)*60+60*d+c},handleClick:function(){var a=this.streamingController.getPlayer(),b=this.streamingController.getPlaylistIndexUsingTrackID(this.trackID);this.streamingController.getCurrentTrackID()!==this.trackID?a.playItemAt(b,this.start):a.isPlaying()?a.seek(this.start):a.play(this.start)},render:function(){var a=$("<div></div>"),b=$("<i></i>");return a.addClass("contextMenuButton"),b.addClass("jwf-jw-icons-external jwi-play"),a.append(b),a}}),b.registerPlugin(function(b){var c=b.data("streaming-controller"),d=b.data("trackid"),e=b.data("start");if(c)return new a(c,d,e)})}(),function(){"use strict";var a={aspectRatio:1.3,defaultColorScheme:"jw",colorSchemes:{kr:["#511a49","#855f80","#ad94aa"],jw:["#2d446b","#4a6da7","#829ecb"]}};module.define("Chart.Settings",a)}(),function(a){"use strict";var b,c=module.require("Chart.Settings");b=Class.extend({DEFAULT_OPTIONS:{animation:!1,responsive:!0,showTooltips:!0,legend:!0,legendBorders:!1,legendSpaceBeforeText:20,legendSpaceBetweenTextHorizontal:20,barValueSpacing:1,barDatasetSpacing:1,graphTitleFontFamily:"'Helvetica Light', Helvetica, 'Droid Sans', Arial, Arial Unicode MS, sans-serif",graphTitleFontSize:17,graphTitleFontColor:"#65605e",graphTitleFontStyle:"200",graphTitleTextAlign:"left",graphTitleSpaceBefore:10,graphTitleSpaceAfter:5,graphSpaceAfter:0,legendBordersSpaceAfter:0,xAxisLabelSpaceAfter:0,footNoteSpaceAfter:0,spaceBottom:0,scaleFontColor:"#8C8C8C",scaleFontSize:13,scaleGridLineColor:"#ECECEA",scaleLineColor:"#ECECEA",scaleFontFamily:"'Helvetica Light', Helvetica, 'Droid Sans', Arial, Arial Unicode MS, sans-serif",xAxisFontColor:"#65605e",xAxisFontSize:14,xAxisFontFamily:"'Helvetica Light', Helvetica, 'Droid Sans', Arial, Arial Unicode MS, sans-serif",yAxisFontColor:"#65605e",yAxisFontSize:14,yAxisFontFamily:"'Helvetica Light', Helvetica, 'Droid Sans', Arial, Arial Unicode MS, sans-serif",legendFontColor:"#65605e",legendFontFamily:"'Helvetica Light', Helvetica, 'Droid Sans', Arial, Arial Unicode MS, sans-serif",maxLabelWidth:125},COLOR_SCHEMES:c.colorSchemes,DEFAULT_COLOR_SCHEME:c.defaultColorScheme,init:function(a,b){this.elem=a,this.options=b},destroy:function(){this.elem.empty()},_createCanvas:function(){return $("<canvas/>")},create:function(){var b;this.$canvas=this._createCanvas(),this.elem.append(this.$canvas),b=this.$canvas.get(0),b.height=b.width/this.getAspectRatio(),this.ctx=b.getContext("2d"),this.chart=new a(this.ctx)[this.chartType](this.getData(),this.buildOptions())},getAspectRatio:function(){return c.aspectRatio?c.aspectRatio:2},getColor:function(a){var b=this.options.data.length,c=this.getColorScheme().slice(0,b);return c[a%c.length]},getColorScheme:function(){var a=this.DEFAULT_COLOR_SCHEME,b=this.options.style;return b&&b.colorScheme&&this.COLOR_SCHEMES[b.colorScheme]&&(a=b.colorScheme),this.COLOR_SCHEMES[a]},getDomainLabels:function(){var a,b,c,d,e,f,g,h;if(this.labels)return this.labels;if(a=this.options.domain||{},b=this.options.data[0].values.length,c=$.extend(!0,{},this.options,this.DEFAULT_OPTIONS),a.labels)return this.labels=this.isHorizontal()?a.labels.map(this._getWrapLabelFunction(c),this):a.labels,this.isRTL()&&this.labels.reverse(),this.labels;if(!_.has(a,"min")||!_.has(a,"max"))return[];if(!a.visibleTicks&&_.has(a,"ticks")&&(a.visibleTicks=a.ticks),e=a.ticks||b,d=Math.floor((a.max-a.min)/(e-1)),this.labels=_.range(a.min,a.max+1,d),a.visibleTicks){for(f=Math.ceil(e/a.visibleTicks),g=[],h=0;h<e;h++)g[h]=h%f==0?this.labels[h]:"";this.labels=g}return this.isRTL()&&this.labels.reverse(),this.labels},buildOptions:function(a){var b,c,d;return b=$.extend(!0,{},this.DEFAULT_OPTIONS,a),this.buildScale(b),d=this.options.style||{},c=d.layout||"vertical",d.thousandSeparator&&(b.thousandSeparator=d.thousandSeparator),this.options.chartTitle&&(b.graphTitle=this.wrap(this.options.chartTitle,this._getTitleFont(b))),_.has(this.options,"domain")&&_.has(this.options.domain,"title")&&("vertical"===c?b.xAxisLabel=this.options.domain.title:b.yAxisLabel=this.options.domain.title),_.has(this.options,"range")&&(this.options.range.hide&&(b.scaleShowLabels=!1),_.has(this.options.range,"title")&&("vertical"===c?b.yAxisLabel=this.options.range.title:b.xAxisLabel=this.options.range.title)),b.yAxisRight=this.isRTL(),b.yAxisLeft=!this.isRTL(),_.has(this.options,"valueLabels")&&this.options.valueLabels.length&&(b.valueLabels=this.options.valueLabels.map(this._getWrapLabelFunction(b),this),this.isHorizontal()&&b.valueLabels.reverse(),b.inGraphDataTmpl="<%= config.valueLabels[v12] %>",b.inGraphDataShow=!0),b},buildScale:function(a){var b,c=this.options.range;c&&_.isNumber(c.max)&&(a.scaleOverride=!0,_.isNumber(c.ticks)||(c.ticks=this.options.data[0].values.length),_.isNumber(c.min)||(c.min=0),this.isRTL()&&this.isHorizontal()&&(b=c.min,c.min=c.max,c.max=b),a.scaleStartValue=c.min,a.scaleStepWidth=Math.round((c.max-c.min)/(c.ticks-1)),a.scaleSteps=c.ticks-1)},isHorizontal:function(){return!1},isRTL:function(){return!!this.options&&this.options.RTL},wrap:function(a,b,c){var d,e,f,g,h,i,j,k=(a||"").split(""),l="";if(c=c||this.$canvas.width(),this._getTextWidth(a,b)>c)for(d=0,e=0,f=this._getWhitespaceCharactersRegex(),i=0,j=k.length;i<j;i++)g=i+1===j,(f.test(k[i])||g)&&(h=k.slice(d,g?i+1:i).join(""),this._getTextWidth(h,b)>c&&(e>d?(l+=k.slice(d,e+1).join("")+"\n",d=e+1):(l+=h+(g?"":"\n"),d=i+1)),g&&d!==j&&(l+=k.slice(d).join("")),e=i);return l.length?l:a},_getTextWidth:function(a,b){var c,d=this.ctx.font;return this.ctx.font=b,c=this.ctx.measureText(a).width,this.ctx.font=d,c},_getTitleFont:function(a){return a.graphTitleFontSize?(a.graphTitleFontStyle?a.graphTitleFontStyle+" ":"200 ")+(a.graphTitleFontSize?"12px ":a.graphTitleFontSize+" px ")+(a.graphTitleFontFamily?a.graphTitleFontFamily:"Arial"):this.ctx.font},_getLabelFont:function(a){return a.xAxisFontSize?(a.xAxisFontStyle?a.xAxisFontStyle+" ":"200 ")+(a.xAxisFontSize?"12px ":a.xAxisFontSize+" px ")+(a.xAxisFontFamily?a.xAxisFontFamily:"Arial"):this.ctx.font},_getWhitespaceCharactersRegex:function(){return/[\u0009\u0020\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2008\u2009\u200A\u3000\u180E\u200B\u200C\u200D]/},_getWrapLabelFunction:function(a){var b=this;return function(c){return c?b.wrap(c,b._getLabelFont(a),a.maxLabelWidth):c}}}),module.define("ChartBase",b)}(window.Chart),function(a){"use strict";var b,c=module.require("ChartBase");b=c.extend({create:function(){var b,c;c={graphSubTitleSpaceAfter:5,graphTitleSpaceAfter:5},this.$canvas=this._createCanvas(),this.elem.append(this.$canvas),b=this.$canvas.get(0),b.height=b.width/this.getAspectRatio(),this.ctx=b.getContext("2d"),this.options.data.length>1?this.isHorizontal()?this.chart=new a(this.ctx).HorizontalStackedBar(this.getData(),this.buildOptions()):this.chart=new a(this.ctx).StackedBar(this.getData(),this.buildOptions(c)):this.isHorizontal()?this.chart=new a(this.ctx).HorizontalBar(this.getData(),this.buildOptions()):this.chart=new a(this.ctx).Bar(this.getData(),this.buildOptions(c))},getData:function(){if(this.data)return this.data;var a=this;return this.data={},this.options.domain=this.options.domain||{},this.options.domain.ticks=this.options.data[0].values.length,this.data.labels=this.getDomainLabels(),!a.isRTL()&&this.isHorizontal()&&this.data.labels.reverse(),this.data.datasets=this.options.data.map(function(b,c){var d,e,f=_.clone(b.values);for(d=c-1;d>=0;d--)for(e=0;e<f.length;e++)f[e]=f[e]-a.options.data[d].values[e],a.options.data[d+1].values[e]=f[e];return(a.isRTL()||a.isHorizontal())&&f.reverse(),{title:b.label,fillColor:a.getColor(c),data:f}}),this.data},isHorizontal:function(){return this.options&&this.options.style&&"horizontal"===this.options.style.layout}}),module.define("Chart.Bar",b)}(window.Chart),function(){"use strict";var a,b,c=module.require("ChartBase");b={bezierCurve:!1,datasetFill:!1},a=c.extend({init:function(a,b){this._super(a,b),this.chartType="Line"},buildOptions:function(){return this._super(b)},getData:function(){var a,b,c,d,e,f,g;if(this.data)return this.data;if(a=this,this.data={},this.data.labels=this.getDomainLabels(),_.has(this.options,"domain"))_.has(this.options.domain,"min")&&(this.data.xBegin=this.options.domain.min),_.has(this.options.domain,"max")&&(this.data.xEnd=this.options.domain.max);else{if(b=Number.MAX_VALUE,c=Number.MIN_VALUE,d=this.options.data,_.isNaN(parseFloat(this.data.labels[0])))for(e=0;e<d.length;e++)for(f=0;f<d[e].values.length;f++)g=d[e].values[f][0],b=g<b?g:b,c=g>c?g:c;else b=_.min(this.data.labels,parseInt),c=_.max(this.data.labels,parseInt);this.data.xBegin=b,this.data.xEnd=c}return this.data.datasets=this.options.data.map(function(b,c){var d=_.clone(b.values),e=_.pluck(d,0);return a.isRTL()&&(e=_.map(e,function(b){return a.data.xBegin+(a.data.xEnd-b)})),{title:b.label,strokeColor:a.getColor(c),pointColor:a.getColor(c),data:_.pluck(d,1),xPos:e}}),this.data}}),module.define("Chart.Line",a)}(),function(){"use strict";var a,b,c=module.require("ChartBase");b={inGraphDataShow:!0,inGraphDataAnglePosition:2,inGraphDataRadiusPosition:2,inGraphDataAlign:"center",inGraphDataVAlign:"middle",inGraphDataFontColor:"white",inGraphDataTmpl:"<%=v6 + '%'%>"},a=c.extend({init:function(a,b){this._super(a,b),this.chartType="Pie"},buildOptions:function(){return this._super(b)},getData:function(){if(this.data)return this.data;var a=this;return this.options.data=this.options.data||[],this.data=this.options.data.map(function(b,c){return{title:b.label,color:a.getColor(c),value:b.values[0]}}),this.data}}),module.define("Chart.Pie",a)}(),function(){"use strict";var a,b=module.require("Chart.Pie");a=b.extend({init:function(a,b){this._super(a,b),this.chartType="Doughnut"},getData:function(){if(this.data)return this.data;var a=this;return this.options.data=this.options.data||[],this.data=this.options.data.map(function(b,c){return{title:b.label,color:a.getColor(c),value:b.values[0]}}),this.data}}),module.define("Chart.Doughnut",a)}(),function(){"use strict";var a,b,c=module.require("Chart.Line"),d=module.require("Chart.Bar"),e=module.require("Chart.Pie"),f=module.require("Chart.Doughnut");b={series:{default:c,line:c},bar:{default:d,stacked:d},proportional:{default:e,doughnut:f,pie:e}},a=Class.extend({init:function(a,c,d){var e,f;if(_.has(b,a)){if(e=$.extend(!0,{style:{subType:"default"}},d),f=b[a][e.style.subType],_.isUndefined(f))throw new Error("Chart subType ("+e.style.subType+") does not exist");this.chart=new f($("#"+c),e)}},create:function(){this.chart&&this.chart.create&&this.chart.create()}}),module.define("Chart",a)}(),function(){"use strict";var a,b=module.require("legalNotices");a=Class.extend({init:function(a,b){this.gridViewButton=a,this.listViewButton=b,this.view=$(a.data("target"))},start:function(){this.bindEventHandlers(),this.enableDefaultMode()},getViewSettingLocation:function(){return this.gridViewButton.data("setting")||"userPref-viewMode-library"},setViewSetting:function(a){b.callIfFunctionalAllowed(function(){$.storedData(this.getViewSettingLocation(),a)}.bind(this))},getViewSetting:function(){function a(){return $.storedData(d)||c}var c=this.gridViewButton.data("default-view"),d=this.getViewSettingLocation();return b.callIfFunctionalAllowed(a,c).then(function(a){return a.returnValue})},bindEventHandlers:function(){var a=_.bind(this.selectListView,this);this.gridViewButton.on("click",_.bind(this.selectGridView,this)),this.listViewButton.on("click",a)},enableDefaultMode:function(){this.getViewSetting().then(function(a){"listView"===a?this.selectListView():this.selectGridView()}.bind(this))},selectListView:function(){this.setViewSetting("listView"),this.view.removeClass("gridView").addClass("listView"),this.gridViewButton.removeClass("current").attr("aria-pressed","false"),this.listViewButton.addClass("current").attr("aria-pressed","true")},selectGridView:function(){this.setViewSetting("gridView"),this.view.removeClass("listView").addClass("gridView"),this.listViewButton.removeClass("current").attr("aria-pressed","false"),this.gridViewButton.addClass("current").attr("aria-pressed","true")}}),module.define("ListViewSwitcher",a)}(),function(){"use strict";var a;a=function(a){a=_.defaults(a||{},{index:0,url:"",thumburl:"",title:"",caption:"",zoomSrc:""}),_.extend(this,a)},a.prototype={styleFlag:""},a.canParseFrom=function(a){return a.find(".jsSlideImage").length},a.fromElement=function(b,c){var d=new a,e=c.find(".jsSlideImage");return d.index=b,d.url=e.attr("src"),d.thumburl=c.data("thumbnail"),d.title=c.find(".jsSlideTitle").html(),d.caption=c.find(".jsSlideCaption").html(),d.zoomSrc=e.data("zoom")||d.url,d},module.define("GalleryImage",a)}(),function(){"use strict";var a;a=function(){this.index=0,this.jsonurl="",this.thumburl="",this.title="",this.caption="",this.posterImage=""},a.prototype={styleFlag:"hasVideo"},a.canParseFrom=function(){return!1},a.fromElement=function(){return new a},module.define("GalleryVideo",a)}(),function(){"use strict";var a,b=module.require("GalleryImage"),c=module.require("GalleryVideo"),d=module.require("settings"),e=[c,b];a=function(a){var b,c=this;this.currentIndex=0,this.currentPage=0,this.previousIndex=-1,this.isGrouped=!1,this.slides=a,b=function(){return this.index===c.currentIndex},_.each(this.slides,function(a){a.isSelected=b,a.selectedUpdateFlag=!1}),$(document).keydown(function(a){
var b={};d.getSetting("IS_RTL")?(b[$.ui.keyCode.RIGHT]=c.prevSlide,b[$.ui.keyCode.LEFT]=c.nextSlide):(b[$.ui.keyCode.LEFT]=c.prevSlide,b[$.ui.keyCode.RIGHT]=c.nextSlide),b[a.which]&&(b[a.which].apply(c),a.preventDefault())})},a.prototype={slideCount:function(){return this.slides.length},setCurrentIndex:function(a){var b;a=Math.max(a,0),a=Math.min(a,this.slides.length-1),this.currentIndex!==a&&(b=this.currentIndex,this.currentIndex=a,this.setPreviousIndex(b),_.each(this.slides,function(a){a.selectedUpdateFlag=!a.selectedUpdateFlag}),this._trigger("currentIndex:update"))},setPreviousIndex:function(a){a=Math.max(a,-1),a=Math.min(a,this.slides.length-1),this.currentIndex===a&&(a=-1),this.previousIndex=a},setCurrentSlide:function(a){var b=_.findWhere(this.slides,a);b&&this.setCurrentIndex(b.index)},nextSlide:function(){this.setCurrentIndex(this.currentIndex+1)},prevSlide:function(){this.setCurrentIndex(this.currentIndex-1)},lastVisitedSlide:function(){this.previousIndex>=0&&(this.setCurrentIndex(this.previousIndex),this.setPreviousIndex(-1))},on:function(a,b){$(this).on(a,b)},_trigger:function(a){$(this).trigger(a)},off:function(a,b){$(this).off(a,b)},getSlideGroups:function(){return this.isGrouped?_.chain(this.slides).groupBy(function(a){return a.groupName}).map(function(a,b){return{groupName:b,slides:a}}).value():[{groupName:null,slides:this.slides}]}},a.parseSlideData=function(a){var b,c=$(a).find(".jsSlide");return b=function(a){return _.find(e,function(b){return b.canParseFrom(a)})},_.chain(c).map(function(a,c){var d=$(a),e=b(d);return e?e.fromElement(c,d):null}).filter(_.identity).value()},a.fromElement=function(b){return new a(a.parseSlideData(b))},module.define("GalleryCollection",a)}(),function(){"use strict";var a,b=module.require("UIController");a=b.extend({TEMPLATE_NAME:null,interactionEnabled:!1,model:null,render:function(){this._draw()},willBeDestroyed:function(){},_injectHTML:function(a){this._super(a),this.trigger("lifecycle:injectHTML")}}),module.define("MediaGallerySlide",a)}(),function(){"use strict";var a,b,c=module.require("MediaGallerySlide");b=c.extend({TEMPLATE_NAME:"gallery/MediaGalleryImageSlide",preferredImageField:"url",container:null,image:null,wrap:null,imageOrigin:null,lastDragX:null,lastDragY:null,pinchStartingDistance:null,pinchStartingScale:null,disableDrag:!1,disableZoom:!1,scale:1,minScale:1,originX:0,originY:0,getPreferredImage:function(){return this.model[this.preferredImageField]},_injectHTML:function(a){var b=this,c=function(a){return b.html.find(a).addBack(a)};this.html=a,this.container=c(".jsSlideView"),this.wrap=c(".jsImageWrap"),this.image=c(".jsImageWrap img"),this.image.error(function(){b.trigger("load:error")}),this.image.load(function(){b.trigger("load:success")}),this.interactionEnabled&&(this.image.load(function(){b.imageOrigin={top:0,left:b.image.offset().left},b.__centerImage()}),this.__attachEventHandlers()),this._super(a)},__applyTransform:function(a,b,c){var d="scale(%s) translate(%spx, %spx)";b=Math.round(b),c=Math.round(c),d=d.format(a,b,c),this.wrap.css({"-webkit-transform":d,"-moz-transform":d,transform:d})},__applyTransformOrigin:function(a,b){var c="%spx %spx";a=Math.round(a),b=Math.round(b),c=c.format(a,b),this.wrap.css({"-webkit-transform-origin":c,"-moz-transform-origin":c,"transform-origin":c})},__attachEventHandlers:function(){function b(){d.off("release",b),a=null}var c=this,d=this.container.hammer(),e=this.__handleDrag.bind(this),f=this.__handleDragStart.bind(this),g=this.__handlePinch.bind(this),h=this.__handleTouchStart.bind(this),i=this.zoomIn.bind(this);d.on("touchstart",h),d.on("dragstart",f),d.on("drag",e),d.on("doubletap",i),d.on("pinch",g),d.on("pinch",function(){d.on("release",b)}),$(window).resize(function(){c.__centerImage()})},__centerImage:function(){var a,b,c=this.image.height(),d=this.container.height(),e=this.container.width()/this.image.width(),f=d/c,g=e;c*e>d&&(g=f),g>1?(a=(this.container.width()-this.wrap.width()*g)/2,b=(this.container.height()-this.wrap.height()*g)/2,this.__setImageLayout(g,a,b)):this.__setImageLayout(1,0,0)},__getNominalSize:function(){return(this.image.width()+this.image.height())/2},__handleDrag:function(b){if(b.preventDefault(),b.gesture&&!this.disableDrag&&(!a||"drag"===a)){var c=b.gesture.deltaX-this.lastDragX,d=b.gesture.deltaY-this.lastDragY;this.lastDragX=b.gesture.deltaX,this.lastDragY=b.gesture.deltaY,this.__pan(c,d),a="drag",setTimeout(function(){a=null},200)}},__handleDragStart:function(){this.lastDragX=0,this.lastDragY=0},__handlePinch:function(b){if(b.preventDefault(),!this.disableZoom){var c,d,e,f,g,h=b.gesture.touches,i=b.gesture.center.pageX-this.imageOrigin.left,j=b.gesture.center.pageY-this.imageOrigin.top,k=this.__getNominalSize();if(2===h.length&&(!a||"pinch"===a)){if(c=Math.abs(h[0].pageX-h[1].pageX)*this.scale,d=Math.abs(h[0].pageY-h[1].pageY)*this.scale,c=Math.pow(c,2),d=Math.pow(d,2),e=Math.sqrt(c+d),void 0===this.pinchStartingDistance)return void(this.pinchStartingDistance=e);f=e-this.pinchStartingDistance,g=(k+f)/k,g+=this.pinchStartingScale-1,this.__zoom(g,i,j),a="pinch"}}},__handleTouchStart:function(a){a.preventDefault(),this.pinchStartingDistance=void 0,this.pinchStartingScale=this.scale},zoomIn:function(a){if(a.preventDefault(),!this.disableZoom){var b,c,d=this.scale+.5*this.scale;a.gesture?(b=a.gesture.center.pageX-this.imageOrigin.left,c=a.gesture.center.pageY-this.imageOrigin.top):(b=this.wrap.width()/2,c=this.wrap.height()/2),this.__zoomTo(d,b,c)}},zoomOut:function(a){if(a.preventDefault(),!this.disableZoom){var b=this.scale-.5*this.scale,c=this.wrap.width()/2,d=this.wrap.height()/2;this.__zoomTo(b,c,d)}},__pan:function(a,b){var c=this.originX,d=this.originY;c+=a,d+=b,this.__setImageLayout(this.scale,c,d)},__zoom:function(a,b,c){var d,e,f,g,h,i,j,k;a=Math.max(this.minScale,a),d=b-this.originX,e=c-this.originY,f=d/this.scale,g=e/this.scale,h=f*a,i=g*a,j=b-h,k=c-i,this.__setImageLayout(a,j,k)},__setImageLayout:function(a,b,c){a=Math.max(this.minScale,a),this.scale=a,this.originX=b,this.originY=c,this.__updateImageTransforms()},__updateImageTransforms:function(){this.__applyTransform(this.scale,this.originX,this.originY),this.__applyTransformOrigin(this.originX,this.originY)},__zoomTo:function(a,b,c){var d,e=this.scale,f=a-e,g=0,h=this;(d=function(){g++;var a=f*$.easing.swing(.1*g);h.__zoom(a+e,b,c),g<10&&setTimeout(d,10)})()}}),module.define("MediaGalleryImageSlide",b)}(),function(){"use strict";var a,b=module.require("settings"),c=module.require("MediaGallerySlide"),d=module.require("PubMediaResource"),e=module.require("VideoModal");a=c.extend({TEMPLATE_NAME:"gallery/MediaGalleryVideoSlide",__throttledVideoConstrainer:null,model:null,willBeDestroyed:function(){this._super(),$(window).off("resize",this.__throttledVideoConstrainer)},_injectHTML:function(a){this._super(a);var c,f=this.html.find(".jsVideoContainer").addBack(".jsVideoContainer"),g=new d(this.model.jsonurl),h=this;g.setPosterImage(this.model.posterImage||b.getSetting("VIDEO_BLANK_POSTER")),c=new e(g,{extraClasses:["embeddedVideo","videoContainer"]}),c.open(function(a){a=$(a),f.replaceWith(a),h.__throttledVideoConstrainer=_.throttle(h._constrainVideo,100),$(window).on("resize",h.__throttledVideoConstrainer),h._constrainVideo()})},_constrainVideo:function(){var a=$(".jsSlideContainer");a.width()/a.height()>1.6?$(".galleryVideoWrapper").addClass("jsShortVideo"):$(".galleryVideoWrapper").removeClass("jsShortVideo")}}),module.define("MediaGalleryVideoSlide",a)}(),function(){"use strict";var a,b=module.require("UIController"),c=module.require("settings"),d=window.sprintf,e=module.require("LocalizedNumber"),f=new e($("#galleryNumberRange")),g=module.require("MediaGalleryImageSlide"),h=module.require("MediaGalleryVideoSlide"),i=module.require("GalleryVideo");a=b.extend({TEMPLATE_NAME:"gallery/MediaGallery",dataSource:null,preferredImageField:"url",currentSlide:null,carouselTransitionSpeed:500,containerElement:null,lookupScope:null,windowResizedFlag:-1,_onSelectedIndexUpdate:function(){},_onWindowResize:function(){},init:function(a,b){this.containerElement=a,this.lookupScope=a,this.dataSource=b,this.pages=[{offset:0,slides:[]}]},render:function(){this._draw()},bindEvents:function(){var a=this;this._onSelectedIndexUpdate=function(){a.scrollCarouselToCurrent(!0),a.lookupScope.find(".jsCaptionScrollContainer").each(function(a,b){var c=function(){$(b).scrollTop(0),$(b).off("didShow",c)};c(),$(b).on("didShow",c)}),a.updateSlide()},this._onWindowResize=function(){a.windowResizedFlag=1===a.windowResizedFlag?2:1,a._setupSlidePages()},this.dataSource.on("currentIndex:update",this._onSelectedIndexUpdate),$(window).on("resize",this._onWindowResize)},unbindEvents:function(){this.dataSource.off("currentIndex:update",this._onSelectedIndexUpdate),$(window).off("resize",this._onWindowResize),this.currentSlide&&this.currentSlide.willBeDestroyed()},_injectHTML:function(a){this._super(a),this.containerElement&&this.containerElement.append(a),this.bindEvents()},_onFirstRender:function(){this.trigger("firstRender:post"),this.prepareForDisplay()},prepareForDisplay:function(){this._setupSlidePages(),this.scrollCarouselToCurrent(!1),this.windowResizedFlag=0,this.updateSlide()},updateSlide:function(){var a=this,b=this.createSlide(this._currentSlideData()),c=this.lookupScope.find(".jsSlideContainer").first();this.currentSlide&&this.currentSlide.willBeDestroyed(),this.currentSlide=null,b.preferredImageField=this.preferredImageField,b.on("lifecycle:injectHTML",function(){c.append(b.html),a.currentSlide=b,a.slideWasUpdated(),a.trigger("slide:rendered")}),b.on("load:success",function(){a.trigger("contentLoad:success")}),c.empty(),b.render()},createSlide:function(a){var b;return b=a instanceof i?new h:new g,b.model=a,b},slideWasUpdated:function(){},currentCaption:function(){return this._currentSlideData().caption},currentTitle:function(){return this._currentSlideData().title},currentGroupName:function(){return this._currentSlideData().groupName},previousTitle:function(){return this._previousSlideData()?this._previousSlideData().title:null},currentIndexLabel:function(){var a=this._currentSlideData().index+1,b=this.dataSource.slides.length;return d(_t("CMSPUBS.LblImageOf"),f.get(a),f.get(b))},_currentSlideData:function(){return this.dataSource.slides[this.dataSource.currentIndex]},_previousSlideData:function(){return this.dataSource.previousIndex>=0?this.dataSource.slides[this.dataSource.previousIndex]:null},goToFirstSlide:function(){this.dataSource.setCurrentIndex(0),this._scrollToPage(0,0)},nextSlide:function(a,b){b.controller.dataSource.nextSlide(),a.preventDefault()},prevSlide:function(a,b){b.controller.dataSource.prevSlide(),a.preventDefault()},nextPage:function(a,b){var c=b.controller;c._scrollToPage(c.dataSource.currentPage+1)},prevPage:function(a,b){var c=b.controller;c._scrollToPage(c.dataSource.currentPage-1)},scrollCarouselToCurrent:function(a){var b=0;!0!==a&&void 0!==a||(b=this.carouselTransitionSpeed),this._scrollToPage(this._carouselPageForItem(this.dataSource.currentIndex),b)},_setupSlidePages:function(){var a,b=this,c=0,d=0;this.lookupScope&&(a=this.lookupScope.find(".jsGalleryCarouselContainer").innerWidth(),this.pages=[{offset:0,slides:[]}],this.lookupScope.find(".galleryItem").each(function(){var e=$(this),f=parseInt(e.data("index")),g=e.outerWidth(!0),h=b.pages[c].offset;d>=a+h-g&&(c+=1,b.pages.push({offset:d,slides:[]})),b.pages[c].slides.push(f),d+=g}))},_scrollToPage:function(a,b){if(a=Math.max(a,0),a=Math.min(a,Math.max(this._carouselPageCount()-1,0)),a=isNaN(a)?0:a,isFinite(a)){this.dataSource.currentPage=a;var c=this.pages[a].offset;c=-c,this._moveCarouselToOffset(c,b)}},_moveCarouselToOffset:function(a,b){var d,e,f;this.lookupScope&&(d="left",e={},e.left=a,c.getSetting("IS_RTL")&&(d="right",e.right=a),f=this.lookupScope.find(".jsGalleryCarouselContent"),a!==parseInt(f.css(d))&&(void 0===b&&(b=this.carouselTransitionSpeed),f.stop(!0,!0),f.animate(e,b)))},_carouselPageForItem:function(a){var b=_.find(this.pages,function(b){return _.contains(b.slides,a)});return this.pages.indexOf(b)},_carouselPageCount:function(){return this.pages.length},isPrevNavDisabled:function(){return 0===this.dataSource.currentIndex},isNextNavDisabled:function(){return this.dataSource.currentIndex===this.dataSource.slides.length-1},isPrevCarouselDisabled:function(){return this.dataSource.currentPage<=0},isNextCarouselDisabled:function(){return this.dataSource.currentPage>=this._carouselPageCount()-1},isZoomDisabled:function(){return!!$(this.containerElement).parents(".standardModal").length}}),module.define("MediaGallery",a)}(),function(){"use strict";var a,b=module.require("SimpleModal"),c=module.require("DialogUtils"),d=module.require("LanguageUtils"),e=module.require("ArticleContentUtils"),f=module.require("MediaGallery"),g=module.require("HeadlessAudioPlayer");a=f.extend({TEMPLATE_NAME:"gallery/MediaGalleryModal",preferredImageField:"zoomSrc",modal:null,zoomInAction:function(){},zoomOutAction:function(){},showBackButton:!1,showAudioButton:!1,playingAudio:!1,init:function(a){var b=$(document),c=this;this.dataSource=a,this.pages=[{offset:0,slides:[]}],b.on("keypress",null,"+",function(a){c.zoomInAction(a)}),b.on("keypress",null,"-",function(a){c.zoomOutAction(a)})},open:function(){this.lookupScope=null,this.trigger("open:pre"),this._draw()},_injectHTML:function(a){var c,f=this;this._super(a),this.lookupScope=a,this.zoomInButton=a.find(".jsZoomIn"),this.zoomOutButton=a.find(".jsZoomOut"),c=a.find(".standardModal-contentContainer"),d.transferLanguageAttrs($("#article"),c),e.transferArticleClasses(c),this.modal=new b(a),this.modal.updateSettings({fullscreen:!0,beforeClose:function(){f.trigger("close:pre"),f.unbindEvents(),f.__removePlayer()}}),this.modal.open(),this.__attachEventHandlers()},lastVisitedSlide:function(a,b){b.controller.dataSource.lastVisitedSlide(),a.preventDefault()},createSlide:function(a){var b=this._super(a);return b.interactionEnabled=!0,b},slideWasUpdated:function(){var a,b,c=this;this.__slideAllowsZoom()&&(a=this.currentSlide.zoomIn.bind(this.currentSlide),b=this.currentSlide.zoomOut.bind(this.currentSlide),this.zoomInButton.off(),this.zoomOutButton.off(),this.zoomInButton.click(a),this.zoomOutButton.click(b),this.zoomInAction=a,this.zoomOutAction=b),this.__removePlayer(),this._currentSlideData().hasCaptionAudio?this._currentSlideData().hasCaptionAudio().then(function(a){c.showAudioButton=a}):this.showAudioButton=!1,this.__updateInteractionState(),this._closeCaptionOverlay()},playAudio:function(a,b){var c=b.controller;c.player||c.__buildPlayer(c._currentSlideData()),c.player&&c.player.play()},pauseAudio:function(a,b){var c=b.controller;c.player&&c.player.pause()},__buildPlayer:function(a){var b=this;a.buildCaptionAudioPlaylist&&a.buildCaptionAudioPlaylist().then(function(a){b.player=new g(a),b.player.bind("play playing",function(){b.playingAudio=!0}),b.player.bind("ended pause remove",function(){b.playingAudio=!1})})},__removePlayer:function(){this.player&&this.player.remove(),this.player=null,this.playingAudio=!1},currentCaption:function(){var a=this._super(),b=$("<div />");return b.html(a),c.addSourceFlags(b,"galleryDialog"),b.html()},shouldHideCarousel:function(){return this.onlyContainsOneSlide()},shouldHideCaption:function(){return this.onlyContainsOneSlide()||!this._currentSlideData().caption},shouldHideNav:function(){return this.onlyContainsOneSlide()},onlyContainsOneSlide:function(){return this.dataSource.slideCount()<=1},__attachEventHandlers:function(){var a=this;this.lookupScope.on("click",".jsGalleryCaptionBtn, .galleryCaptionMobile .titleContainer",function(b){a.toggleCaptionOverlay(),b.preventDefault(),b.stopPropagation()}),$(window).resize(function(){a.__updateInteractionState()})},toggleCaptionOverlay:function(){this.lookupScope.find(".galleryCaptionMobile").hasClass("showCaption")?this._closeCaptionOverlay():this._openCaptionOverlay()},_closeCaptionOverlay:function(){var a=this.lookupScope.find(".galleryCaptionMobile"),b=a.find(".jsGalleryCaptionBtn"),c=a.data("original-height")||60;a.hasClass("showCaption")&&(b.removeClass("captionOpen").addClass("captionClosed"),b.attr("aria-expanded","false"),a.animate({height:c},"fast",function(){a.removeClass("showCaption")}),this.__updateInteractionState())},_openCaptionOverlay:function(){var a,b,c=this.lookupScope.find(".galleryCaptionMobile"),d=c.find(".jsGalleryCaptionBtn");c.hasClass("showCaption")||(a=c.height(),c.data("original-height",a),c.addClass("showCaption"),d.removeClass("captionClosed").addClass("captionOpen"),d.attr("aria-expanded","true"),b=c.height("auto").height(),c.height(a),c.animate({height:b},"fast",function(){c.addBack().find(".jsCaptionScrollContainer").trigger("didShow")}),this.__updateInteractionState())},__updateInteractionState:function(){this.lookupScope.find(".jsGalleryCaptionOverlay").hasClass("showCaption")&&this.__mobileStatusBarIsShowing()?this.disableDrag=!0:this.disableDrag=!1,this.disableZoom=!this.__slideAllowsZoom()},__slideAllowsZoom:function(){return this.currentSlide.zoomIn&&this.currentSlide.zoomOut},__mobileStatusBarIsShowing:function(){return"block"===this.lookupScope.find(".jsGalleryCaptionOverlay").css("display")},shouldShowMobileGroupName:function(){return!!this.currentGroupName&&!this.showBackButton}}),module.define("MediaGalleryModal",a)}(),function(){"use strict";var a,b=module.require("UIController"),c=module.require("Bible");a=b.extend({init:function(a){this.updateContainer(a),this.state={}},updateContainer:function(a){this.container=a},_buildStateContext:function(){return this.state},_injectHTML:function(a){this.html=a,this._showInContainer()},_showInContainer:function(){this.container.empty().append(this.html)},updatePrevNextLinks:function(a){a&&this.container&&(this.state.hasPrevious=a.hasPrevious,this.state.hasNext=a.hasNext,a.hasPrevious&&this.updateLink(this.container.find(".navLinkPrev:visible .primaryButton"),a.previous),a.hasNext&&this.updateLink(this.container.find(".navLinkNext:visible .primaryButton"),a.next))},updateLink:function(a,b){var d;a.is("a")||(d=a,a=$("<a />"),a.html(d.html()),d.replaceWith(a)),b.isBibleBook?a.attr("class","jsBibleBook").data("book",b.id).data("chapter",null):b.isBibleChapter?a.data("book",b.bookID).data("chapter",b.id).attr("class","jsBibleChapter").addClass(b.pageCSSClassNames):a.data("page-id",b.id).attr("class","jsBibleNavigation").addClass(b.pageCSSClassNames).addClass("pub-%s".format(c.PUB_SYMBOLS.NWTSTY)),a.addClass("primaryButton articleNavButton"),a.attr("title",this._decodeHTMLEntities(b.title)),a.attr("href",b.url||"")},setBible:function(a){this.state.bible=_.extend(this.state.bible||{},a||{})},_decodeHTMLEntities:function(a){return $("<p></p>").html(a).text()}}),module.define("Page",a)}(),$(function(){"use strict";function a(){return e.getSetting("IS_SMALL_LAYOUT")}function b(a){if(!a||!a.length)return 0;var b=0;return $(a).each(function(){b+=$(this).outerHeight(!0)}),b}function c(){var c,d,e=$(window).height(),f=0,g=a();$(".jsLockedChrome").filter(":visible").each(function(){f+=$(this).outerHeight(!0)}),c=e-f,$(".jsLockedContainer").each(function(){var a=c;d=$(this),a+=b(d.data("add-height")),a-=b(d.data("sub-height")),g&&(a+=b(d.data("mobile-add-height")),a-=b(d.data("mobile-sub-height"))),d.css("height",a)})}var d=module.require("signal"),e=module.require("settings");$(".jsLockedContainer").length&&($("html").addClass("jsLockedHeight"),$("#mobileNavTopBar").addClass("jsLockedChrome"),c(),d.listen("DOMReady",c),$(window).resize(_.throttle(c,100)),$("#regionMain").on("scroll",function(){$(this).scrollTop(0)}))}),function(){"use strict";var a,b=module.require("signal"),c=module.require("FinderLink"),d=["docid","prefer","pub","issue"];a=function(){var a,b,e=$(this);b=_.reduce(d,function(a,b){return e.data(b)&&(a[b]=e.data(b)),a},{}),a=c.create(b),e.attr("href",a)},b.listen("DOMReady",function(){$(".jsFinderLink").each(a)})}(),function(){"use strict";var a,b=module.require("Page"),c=module.require("signal"),d=module.require("LanguageUtils");a=b.extend({TEMPLATE_NAME:"MediaPage",init:function(a,b){this._super(a),this.setBible(b)},draw:function(a){var b=this.drawn?this._redraw():this._draw(),e=this;return this.drawn&&(b=b.then(_.bind(this._showInContainer,this))),this.drawn=!0,b.then(function(){e.updatePrevNextLinks(a),c.send("DOMReady"),d.transferLanguageAttrs($("body"),$("#article"))})}}),a.HASH_URL="media",a.PAGE_ID="MediaPage",a.PAGE_TITLE=_t("CMSPUBS.HdgMediaGallery"),a.createMediaItemHash=function(b,c,d){return a.HASH_URL+"/"+b+"/"+c+"/"+d},module.define("MediaPage",a)}(),function(){"use strict";var a,b=module.require("MediaPage"),c=module.require("BibleMultimedia");a=b.extend({TEMPLATE_NAME:"BookMediaPage",init:function(a,b){this._super(a,b)},draw:function(a,b){var d=this;return d.state.multimedia=[],d.state.chapters=[],this._super(a).then(function(){return d.state.title=a.title,d.state.book=_.findWhere(d.state.bible.books,{id:parseInt(b)}),c.fetchMultimedia(d.state.bible.pubSymbol,b).then(function(a){d.state.multimedia=a,d.state.chapters=_.chain(d.state.book.chapters).map(function(b){return b.multimedia=c.multimediaForChapter(b,a),b.title=d.state.book.standardName+" "+b.id,b}).filter(function(a){return a.multimedia.length>0}).value()})})}}),a.HASH_URL_FORMAT="media/%s",a.PAGE_ID_FORMAT="MediaPage-%s",module.define("BookMediaPage",a)}(),function(){"use strict";var a,b=module.require("Page");a=b.extend({onPageLoad:function(a){this.updatePrevNextLinks(a)}}),module.define("AdditionalPage",a)}(),function(){"use strict";var a,b,c=module.require("UIController"),d=module.require("settings"),e=module.require("signal");b=c.extend({TEMPLATE_NAME:"BibleJumper",init:function(a,b){this.state=a,this.state.selectedBook=a.selectedBook||this.getUnselectedBook(),this.state.selectedChapter=a.selectedChapter||this.getUnselectedChapter(),this.bookIndex=a.bookIndex,this.container=b},draw:function(){var a=this;return this._draw().then(function(){a.selectPageLocation(),e.send("DOMReady")})},open:function(){var a,b=this.container.find(".sbJumperPanel");d.getSetting("IS_MOBILE_LAYOUT")?(a={left:"0px"},b.css({opacity:1})):(a={opacity:1},b.css({left:"0px"})),b.removeClass("closed").addClass("open").animate(a,250,"swing"),this.previousBook=this.getSelectedBook(),this.previousChapter=this.getSelectedChapter(),this._listenForResize(),this.setHeight(),this._openModalOverlay()},_listenForResize:function(){this._onResize=_.throttle(_.bind(this.setHeight,this),200),$(window).on("resize",this._onResize)},setHeight:function(){var a=$(document).height(),b=this.container.find(".sbJumperPanel");b.css({height:a-b.offset().top})},close:function(a,b){var c,e=this.container.find(".sbJumperPanel"),f=-e.width()-80;c=d.getSetting("IS_MOBILE_LAYOUT")?{left:f+"px"}:{opacity:0},e.animate(c,250,"swing",function(){$(this).removeClass("open").addClass("closed").css({left:f+"px",opacity:0}),b&&_.isFunction(b)&&b()}),this._closeModalOverlay(),this._unbindEvents(),a&&(this.setSelectedBook(this.previousBook),this.setSelectedChapter(this.previousChapter))},_createModalOverlay:function(){a||(a=$("<div/>").addClass("jsSimpleModalOverlay").on("click",_.bind(this.close,this,!0)).appendTo("body"))},_openModalOverlay:function(){a||this._createModalOverlay(),a.animate({opacity:.5},250)},_closeModalOverlay:function(){a&&a.animate({opacity:0},250,function(){$(this).remove(),a=null})},getPageBookNum:function(){var a=$("article").data("booknum");return a?parseInt(a,10):null},getPageChapter:function(){var a=$("article").data("chapter");return a?""+a:null},getPageID:function(){return $("body").attr("id")},getUnselectedBook:function(){return{hasChapters:!1,hasAudio:!1,isPlaceholder:!0}},getUnselectedChapter:function(){return{id:null,title:null,isPlaceholder:!0}},selectBook:function(a,b,c){(this.getSelectedBookID()!==a||b)&&(this.setSelectedBookID(a),b?this.selectChapter(null):this.setSelectedChapter(null),(this.getSelectedBook()!==this.getUnselectedBook()||b)&&(!this.isBibleBookSelected()&&!this.selectedBookHasChapters()||b)&&e.send("StudyBible:changePage",{page:this.getSelectedBook(),hashLocation:c}))},getSelectedBookID:function(){return this.state.selectedBook?this.state.selectedBook.id:null},setSelectedBookID:function(a){this.setSelectedBook(this.findBook(a)||this.getUnselectedBook())},setSelectedBook:function(a){this.state.selectedBook=a||this.getUnselectedBook(),e.send("StudyBible:changeBook",{book:this.state.selectedBook})},getSelectedBook:function(){return this.state.selectedBook},isSelectedBookID:function(a){var b=this.getSelectedBookID();return a=a?a.toString():a,b=b?b.toString():b,a===b},selectedBookHasChapters:function(){return this.getSelectedBook()&&this.getSelectedBook().hasChapters},selectChapter:function(a,b,c,d){(_.isNumber(a)||_.isString(a))&&(a=this.findChapter(a)),a&&this.getPageID()===a.id||(this.setSelectedChapter(a),d||(a?a.isBibleChapter?e.send("StudyBible:changeChapter",{book:this.getSelectedBook(),chapter:a.id,verseRange:b}):e.send("StudyBible:changePage",{page:a,hashLocation:c}):e.send("StudyBible:changeChapter",{book:this.getSelectedBook(),chapter:null,verseRange:b})))},findChapter:function(a,b){var c,d=b||this.getSelectedBook();return d&&(d.chapters||d.additionalPages)?(a=_.isNumber(a)?a.toString():a,c=(d.chapters||[]).concat(d.additionalPages),_.find(c,function(b){return b.id===a||_.any(b.children,function(b){return b.id===a})})):null},findSubpage:function(a,b){var c=b||this.getSelectedChapter();return c&&c.children?(a=_.isNumber(a)?a.toString():a,_.find(c.children,function(b){return b.id===a})):null},setSelectedChapter:function(a){this.state.selectedChapter=a||this.getUnselectedChapter()},getSelectedChapter:function(){return this.state.selectedChapter},getSelectedChapterID:function(){return this.state.selectedChapter?this.state.selectedChapter.id:null},isSelectedChapterID:function(a){var b=this.getSelectedChapterID();return a=a?a.toString():a,b=b?b.toString():b,a===b},isBibleBookSelected:function(){return this.state.selectedBook&&this.state.selectedBook.isBibleBook},findBook:function(a){return this.bookIndex?this.bookIndex[a]:null},openBookSelector:function(){this.chapterView.hide(),this.booksView.show(),this.pointer.css({left:this.selectedBookButton.position().left+20}),this.container.find(".sbJumperViews").scrollTop(0)},openChapterSelector:function(){this.booksView.hide(),this.chapterView.show(),this.pointer.css({left:this.selectedChapterButton.position().left+this.selectedChapterButton.width()/2}),this.container.find(".sbJumperViews").scrollTop(0)},_buildStateContext:function(){return this.state},_injectHTML:function(a){this.selectedBookButton=a.find(".sbJumperBook"),this.selectedChapterButton=a.find(".sbJumperChapter"),this.booksView=a.find("#sbJumperBooks"),this.chapterView=a.find("#sbJumperChapters"),this.pointer=a.find(".triangle"),this._bindEvents(),this.container.empty().append(a)},_bindEvents:function(){var a="%s .bibleBook".format(".sbJumperPanel"),b="%s .chapter, %s .bookAdditionalPage".format(".sbJumperPanel",".sbJumperPanel"),c="%s .bibleAdditionalPage".format(".sbJumperPanel"),d="%s .subAdditionalPage".format(".sbJumperPanel");$(document).on("click",a,_.bind(this.onSelectBook,this)).on("click",b,_.bind(this.onSelectChapter,this)).on("click",c,_.bind(this.onSelectPage,this)).on("click",d,_.bind(this.onSelectSubPage,this)).on("click","#jumperShelf .jsClose",_.bind(this.close,this,!0))},_unbindEvents:function(){$(window).off("resize",this._onResize)},onOpenSelectBook:function(a,b){var c=b.controller;a.preventDefault(),c.open(),c.openBookSelector()},onOpenSelectChapter:function(a,b){var c=b.controller;a.preventDefault(),$(a.currentTarget).hasClass("inactive")||(c.open(),c.openChapterSelector())},onSelectBook:function(a){var b=$(a.currentTarget).attr("data-book-id");a.preventDefault(),this.selectBook(b),this.isBibleBookSelected()||this.selectedBookHasChapters()?this.openChapterSelector():this.close()},onSelectPage:function(a){var b=$(a.currentTarget).attr("data-book-id");a.preventDefault(),this.selectBook(b,!0),this.close()},onSelectSubPage:function(a){var b=this,c=$(a.currentTarget).attr("data-page-id");a.preventDefault(),this.close(!1,function(){b.navigateToPage(c)})},onSelectChapter:function(a){var b=$(a.currentTarget).attr("data-chapter-id");a.preventDefault(),this.close(),this.selectChapter(b)},onBack:function(a,b){a.preventDefault(),b.controller.openBookSelector()},hasSelectedBook:function(){return!!this.getSelectedBook()&&this.getSelectedBook().title},isChapterPickerInactive:function(){var a=this.getSelectedBook();return!(a.hasChapters&&a.isBibleBook)},selectPageLocation:function(){var a,b,c=this.getPageBookNum();c?(this.setSelectedBookID(c),b=this.findChapter(this.getPageChapter()),this.setSelectedChapter(b)):(a=this.getBookAndChapter(this.getPageID()),this.setSelectedBook(a.book),this.setSelectedChapter(a.chapter))},navigateToPage:function(a,b,c){var d,f=this.getBookAndChapter(a),g=f.book,h=f.chapter,i=f.page;return!(!g&&!h)&&(d=i?this.isSelected(g,i):this.isSelected(g,h),d||(this.selectBook(g?g.id:null,!h&&b,c),this.selectChapter(h,null,c,!!i),i&&e.send("StudyBible:changePage",{page:i,hashLocation:c})),!0)},isSelected:function(a,b){var c=a?a.id:null,d=b?b.id:null;return c===this.getSelectedBookID()&&d===this.getPageID()},getBookAndChapter:function(a){var b,c,d=_.keys(this.bookIndex);for(c=0;c<d.length;c++)if(b=this._findBookAndChapter(this.bookIndex[d[c]],a),b.book||b.chapter)return b;return{}},_findBookAndChapter:function(a,b){var c,d;return a.id===b?{book:a}:(c=this.findChapter(b,a),c?(d=this.findSubpage(b,c),{book:a,chapter:c,page:d}):{})},findPage:function(a){var b=this.getBookAndChapter(a),c=b.book,d=b.chapter,e=b.page;return e||(d||c)},getState:function(){return{book:this.getSelectedBookID(),chapter:this.getSelectedChapterID()}},restoreState:function(a){if(a){var b=a.book===this.getSelectedBookID(),c=a.chapter===this.getSelectedChapterID(),d=!!a.book&&!a.chapter,f=b&&c;f&&e.send("StudyBible:noChange"),this.selectBook(a.book,d&&!f),this.selectChapter(a.chapter)}},getSelectedPage:function(){var a=this.getSelectedChapter();return a.id!==this.getPageID()&&(a=_.find(a.children,function(a){return a.id===this.getPageID()},this)),a&&!a.isPlaceholder?a:this.getSelectedBook()}}),module.define("BibleJumper",b)}(),function(){"use strict";var a,b=module.require("UIController"),c=module.require("BibleVerseRangeCollection"),d=module.require("BibleVerseRangeRenderer"),e=module.get("ScrollHelper"),f=module.get("Navigation"),g=module.require("settings"),h=module.require("signal");a=b.extend({TEMPLATE_NAME:"DefaultView",init:function(a,b){this.container=a,this.bible=b||{},this.bookIndex=b.bookIndex||{},this.state={selectedRanges:[],url:!1,chapterPageCSSClassNames:b.pageCSSClassNames,chapterArticleCSSClassNames:b.articleCSSClassNames}},_buildStateContext:function(){return this.state},_injectHTML:function(a){return this.html=a,this.container.empty().append(a),this.html},selectVerseRange:function(a){var b=new c(a,g.getPageConfig("PREFERRED_BIBLE")),e=new d(b);return this.clearContent(),this.lastPageID=null,e.render(!0).then(_.values).then(_.bind(this._selectRanges,this))},_selectRanges:function(a){var b=this.state.selectedRanges,c=this;b.length=0,b.push.apply(b,_.map(a,function(a){return a.hasBook=!!c.bookIndex[a.startBook],a}))},draw:function(a){return this.container=a||this.container,this._draw().then(_.bind(this.clearContent,this))},clearContent:function(){this.html.find(".jsContentContainer").empty(),this.state.selectedRanges=[],this.state.url=!1,this.lastPageID=null},showContent:function(a,b,c){if(a){if(a.id===this.lastPageID)return void this._scrollToHash(c||"");var d,e=this,g="%s article".format(".readingPane");return d=".jsViewportPinWrapper, .articleFooterLinks, #copyright, .bibleNav",this.clearContent(),this.state.url=a.url,this.state.title=a.title,this.state.pageID=a.id,this.state.pageLinkClasses=b,this.state.articleCSSClassNames=a.articleCSSClassNames,
f.getHTML(a.url,g).then(function(b){b.find(d).remove(),e.showHTMLContent(b.children()),e.lastPageID=a.id,e._scrollToHash(c||""),h.send("DOMReady")})}},selectPubLink:function(a,b,c){var d=a.attr("href");b!==this.lastPageID||a.is(".jsBibleNavigation")?c&&c():this._scrollToHash(d)},_scrollToHash:function(a){var b,c=this.html.is(".jsLockedContainer")?this.html:this.html.find(".jsLockedContainer"),d=a.replace(/[^#]+#?/,"");d.length&&(b=this.html.find("#%s".format(d)),e.scrollTo(c,b))},showHTMLContent:function(a){this.html.find(".jsContentContainer").html(a)}}),module.define("DefaultView",a)}(),function(){"use strict";var a,b=module.get("Navigation"),c=module.require("DialogUtils"),d=module.require("signal");a=Class.extend({draw:function(a,e,f){if(!e||!f)return $.when(!1);var g,h=this.findOverview(e,f),i="%s article".format(".readingPane"),j=this;return h?(g=".jsViewportPinWrapper, .articleFooterLinks, #copyright, .bibleNav",b.getHTML(h.url,i).then(function(b){var e=j._getTemplate(b.children());e.find(g).remove(),e.addClass(h.articleCSSClassNames),a.empty().append(e),c.addSourceFlags(a,"panelDialog"),d.send("DOMReady")})):$.when(!1)},_getTemplate:function(a){var b=$('<div class="jsLockedContainer" style="height:1px"></div>'),c=$('<div class="studyContainer"></div>');return b.data("mobile-add-height",".sbNavBar.jsLockedChrome"),c.html(a),b.html(c)},findOverview:function(a,b){var c=a.bookIndex[b];return c?_.find(c.additionalPages,function(a){return"114"===a.docClass||"115"===a.docClass}):null}}),module.define("OverviewView",a)}(),function(){"use strict";var a,b=module.require("Page"),c=module.require("settings"),d=module.require("FinderLink"),e=module.require("signal"),f=module.require("Bible"),g=module.require("url"),h=module.require("BibleVerse");a=b.extend({TEMPLATE_NAME:"ChapterPage",init:function(a,b){this.state={chapter:{},book:{}},this.updateContainer(a),b&&this.setChapter(b)},setChapter:function(a){this.html&&this.html.remove(),this.state.chapter=a,this.state.mailToLink=this.buildMailToLink(a),this.state.finderLink=this.buildFinderLink(a)},buildFinderLink:function(a){return d.create({pub:this.state.pubSymbol,bible:h.createVerseId(a.bookID,a.id,0),wtlocale:c.getPageConfig("WT_LANG"),srcid:"share"})},buildMailToLink:function(a){if(a){var b,c="mailto:?body=%s%0a%0a%s%26&subject=%s",d=encodeURIComponent(this._decodeHTMLEntities(a.citation));return b=this.buildFinderLink(a),c.format(d,encodeURIComponent(b),d)}},show:function(a,b,d,f){return this.state.pubSymbol=f,this.setChapter(a),this.state.bookName=d,this.state.bookID=b,this.state.chapter.audioURL=this.getAudioURL(),this.state.book=_.extend(this.state.book,this._findBook(b)),this.state.chapter.readableTitle=this.state.bookName+" "+this.state.chapter.title,this.state.imageURL=this._getImageURL(this.state.bible,b),this.state.language=c.getPageConfig("VERNACULAR_LANGUAGE"),this.state.copyrightPageURL=this.getCopyrightPageURL(),this.state.chapterPageCSSClassNames=this.state.bible.pageCSSClassNames,this.state.chapterArticleCSSClassNames=this.state.bible.articleCSSClassNames,this.draw().then(function(){e.send("DOMReady")})},_findBook:function(a){return _.findWhere(this.state.bible.books||[],{id:a})},draw:function(){var a=this;return this._draw().then(function(){a.replaceXrefCharacters(a.state.chapter.crossReferences),a._overrideDefaultPageBehaviors(),a.updatePrevNextLinks(a.state.chapter)})},_overrideDefaultPageBehaviors:function(){this.container.find(".verseNum a, .chapterNum a").addClass("jsHighlightOnly"),this.container.find(".footnoteLink").addClass("jsNoDialog"),this.state.bookID&&this.container.find(".jsMediaPlayer").data("jsonurl",this.getAudioURL())},replaceXrefCharacters:function(a){var b,c,d;a&&a.length&&(b=_.indexBy(a,"id"),this.container.find(".xrefLink").each(function(){c=$(this),d=c.attr("id").replace(/[a-zA-Z]/g,""),b[d]&&c.html(b[d].referenceCharacter)}))},_getImageURL:function(a,b){var c,d=this.state.bible.books;return c=_.find(d,function(a){return a.id===b}),c?c.image.src:""},getAudioURL:function(){var a,b=c.getPageConfig("BIBLE_AUDIO_DATA_API");return b?(a=g.parse(b),a.query=_.extend(a.query||{},{pub:f.PUB_SYMBOLS.NWT,booknum:this.state.bookID,track:this.state.chapter.id}),g.build(a)):null},getCopyrightPageURL:function(){var a=this.state.bible.copyrightPage;return a?a.url:null}}),module.define("ChapterPage",a)}(),function(){"use strict";var a,b=module.require("BibleVerseRangeCollection"),c=module.require("BibleVerseRangeRenderer"),d=module.require("BibleVerseRange"),e=module.require("settings");a=Class.extend({fetched:!1,init:function(a){this.id=a.id,this.sourceVsID=a.sourceVsID,this.sourceCitation=a.sourceCitation,this.referenceCharacter=a.referenceCharacter,this.verses=_.map(a.targets,_.clone),this.targetVerses=b.toVerseRangeString(_.pluck(this.verses,"vs")),this.abbreviatedCitations=d.createCitation(this.verses,!0),this.pubSymbol=e.getPageConfig("PREFERRED_BIBLE"),this.rangeCollection=new b(this.targetVerses,this.pubSymbol)},fetch:function(){return this.fetched?$.when(!1):(this.fetched=!0,new c(this.rangeCollection).render(!0).then(_.bind(this._parseVerses,this)).then(function(){return!0}))},_parseVerses:function(a){_.each(a,_.bind(this._updateVerse,this))},_updateVerse:function(a,b){var c=_.find(this.verses,function(a){return a.vs===b});c&&(c.content=a.content)}}),module.define("MarginalReference",a)}(),function(){"use strict";var a,b=module.require("UIController"),c=module.require("settings"),d=module.require("DialogUtils"),e=module.get("ScrollHelper"),f=c.getSetting("DEPRECATED_HIGHLIGHT_CLASS");a=b.extend({selected:!1,scrollPosition:0,init:function(a){this.state={chapter:this.getDefaultChapter(),chapterPageCSSClassNames:"",chapterArticleCSSClassNames:"",basePageCSSClassNames:""},a&&this.updateChapter(a)},setContainer:function(a){this.container=a,this.onSetContainer(a)},onSetContainer:function(){},setSelected:function(a){this.selected=a,this[a?"onSelected":"onDeselected"]()},onSelected:function(){this.scrollToLastPosition()},onDeselected:function(){},_buildStateContext:function(){return this.state},_injectHTML:function(a){return d.addSourceFlags(a,"panelDialog"),this.html=a,this.container.append(a),this.html.on("tab:selected",_.bind(this.setSelected,this,!0)),this.html.on("tab:deselected",_.bind(this.setSelected,this,!1)),this.html},show:function(){this.html&&(this.html.trigger("tab:select"),this.html.addClass("current"),this.setSelected(!0))},draw:function(){return this._draw()},updateChapter:function(a){this.html&&this.html.remove(),this.state=_.extend({},{chapter:this.toChapterFormat(a)},_.omit(this.state,"chapter"))},toChapterFormat:function(){return{}},getDefaultChapter:function(){return{verses:[]}},getCurrentChapter:function(){return this.state.chapter||this.getDefaultChapter()},selectVerse:function(){},selectFootnote:function(){},selectPubLink:function(){},selectBibleData:function(a,b,c){var d=a.format(b),e=this.html.find(d);return this.clearHighlights(),this.highlight(e),this.isSelected()&&e.is(":visible")&&!c&&this.scrollTo(e),e},selectCrossReference:function(a){var b=".xRef%s".format(a),c=this.html.find(b),d=c.find(".jsExpandCollapse"),e=d.data("collapseaction");this.isSelected()&&(d.each(function(){var a=$(this);a.hasClass(e)||a.click()}),this.scrollTo(c))},clearHighlights:function(){this.html.find("."+f).removeClass(f)},scrollTo:function(a){var b=this.container.closest(".jsLockedContainer");e.scrollTo(b,a),this.setLastScrollPosition(a)},onFetchReference:function(a,b){a.preventDefault(),b.reference&&b.reference.fetch()},isSelected:function(){return this.selected},setLastScrollPosition:function(a){this.scrollPosition=a},clearLastScrollPosition:function(){this.scrollPosition=0},scrollToLastPosition:function(){this.scrollTo(this.scrollPosition)},highlight:function(a){a.addClass(f)},clearHighlight:function(a){a.removeClass(f)},isHighlighted:function(a){return a.hasClass(f)},setBible:function(a){this.bible=a,a&&(this.state.baseArticleCSSClassNames=a.baseArticleCSSClassNames,this.state.chapterPageCSSClassNames=a.pageCSSClassNames,this.state.chapterArticleCSSClassNames=a.articleCSSClassNames)}}),module.define("Tab",a)}(),function(){"use strict";var a,b=module.require("settings"),c=b.getSetting("DEPRECATED_HIGHLIGHT_CLASS"),d=b.getSetting("DEPRECATED_HIGHLIGHT_ADD_CLASS"),e=b.getSetting("TEXT_HIGHLIGHT_CLASS"),f=module.get("ScrollHelper");a=Class.extend({clearHighlights:function(a){var b=this.container.find(".%s, .%s, .%s".format(c,e,d));a&&(b=b.not(_.isArray(a)?a.join(","):a)),b.removeClass(c).removeClass(e).removeClass(d)},hideContents:function(){this.container.children().hide()},showContents:function(){this.container.children().show()},scrollTo:function(a){this.container&&f.scrollTo(this.container,a,-this.container.height()/3)},restoreScrollStateAfterImagesLoad:function(){var a=this,b=this.container.find("img");b.off("load.scrollAfter"),b.on("load.scrollAfter",function(){a.scrollToSelection()})}}),module.define("Pane",a)}(),function(){"use strict";var a,b=module.require("Tab"),c=module.require("Bible"),d=module.require("BibleVerseRange"),e=module.require("BibleVerseRangeCollection"),f=module.require("SupplementalInfoModal"),g=module.require("MarginalReference"),h=module.get("Navigation");a=b.extend({TEMPLATE_NAME:"DiscoveryTab",toChapterFormat:function(a){var b,c,d,e,f,g,h;return f=this.getDefaultChapter(),f.validRange=a.validRange,f.bookID=""+a.bookID,f.book=a.book,f.chapterID=""+a.id,b=_.groupBy(a.crossReferences,"source"),c=_.groupBy(a.commentaries,"source"),d=_.groupBy(a.footnotes,"source"),e=this._groupMediaByVerse(f.validRange,a.multimedia,a.verses),f.titleNote=_.find(a.commentaries,function(a){return!!a.label}),f.hasTitleNote=!!f.titleNote,f.titleNote=f.titleNote||{},g=_.first(a.chapterOutlines),f.chapterOutline={content:g?g.content:null,title:g?g.title:null},f.verses=_.map(a.verses,_.bind(this._mapVerse,this,b,c,d,e)),h=_.find(a.superscriptions,function(a){return/.*000$/.test(a.source)}),h&&(h.vsID=h.source,h=this._mapVerse(b,c,d,e,h),f.verses.unshift(h)),f},_mapVerse:function(a,b,c,d,e){var f=_.map(a[e.vsID],this._createCrossReference),g=b[e.vsID]||[],h=c[e.vsID]||[],i=d[e.vsID]||[],j=!!f.length,k=!!g.length,l=!!h.length,m=!!i.length;return{vsID:e.vsID,standardCitation:e.standardCitation||"",abbreviatedCitation:e.abbreviatedCitation||"",crossReferences:f,hasCrossReferences:j,studyNotes:g,hasStudyNotes:k,footnotes:h,hasFootnotes:l,media:_.map(i,function(a){return a.styleFlag="video"===a.type?"hasVideo":"",a}),hasMedia:m,hasContent:j||k||l||m}},_groupMediaByVerse:function(a,b,c){var f={},g=new d(a),h=this;return _.each(c,function(a){f[a.vsID]=[]}),_.each(b,function(a){var b=e.splitRanges(a.source);b=h._findRangesInCurrentRange(b,g),_.each(b,function(b){var c,e,g=_.clone(a);c=b&&-1!==b.indexOf(d.VERSE_SEPARATOR),c&&(g.sourceStandardCitation=_.find(g.sourceStandardCitations,function(a){return a.vs===b}).standardCitation),e=new d(b).startRange,f[e].push(g)})}),f},_findRangesInCurrentRange:function(a,b){return _.filter(a,function(a){return b.isVerseRangeInRange(a)})},_createCrossReference:function(a){return new g(_.extend(a,{targets:a.targets}))},selectFootnote:function(a){var b=this.selectBibleData(".fn%s",a,!0);this.scrollTo(b.parents(".footnotes"))},selectVerse:function(a,b){var c=this.selectBibleData(".vs%s",a,!b);this.setLastScrollPosition(c)},selectCrossReference:function(a){var b=".xRef%s".format(a),c=this.html.find(b);this.clearHighlights(),this.highlight(c),this._super.apply(this,arguments)},selectPubLink:function(a){var b,d,e=a.attr("href");b=function(a){return a.find(".pub-%s".format(c.PUB_SYMBOLS.NWTSTY)).addClass("jsBibleNavigation"),a.find(".zoom").removeClass("zoom"),a},d=new f({additionalContentFilterFn:b}),d.openWithURL(e)},onClickExpander:function(a,b){var c=$(a.currentTarget),d=c.hasClass(c.data("collapseaction")),e=c.closest(".xRef");b.controller.onFetchReference(a,b),d?b.controller.clearHighlight(e):(b.controller.clearHighlights(),b.controller.highlight(e))},scrollToSelectedVerse:function(){var a,b,c,e,f,g=h.getCurrentHashValue(),i=this.getCurrentChapter().validRange;if(!g||0===g.length||!i)return void this.scrollToLastPosition();a=d.isRange(g),b=new d(i),a&&b.isVerseRangeInRange(g)?(c=new d(g),e=c.startRange.replace(/[^0-9]/g,""),f=this.html.find(".vs%s".format(e)),this.scrollTo(f)):this.scrollToLastPosition()},onSetContainer:function(a){a.off("click.modalAnchor").on("click.modalAnchor",".jsDialogContentLink, .jsBibleLink",_.bind(this._onClickModalAnchor,this)),$(document).off("click.modalNavigation").on("click.modalNavigation",".jsScriptureDialog .jsBibleChapter, .jsExcerptDialog a",_.bind(this._onClickModalNavigation,this)),$(document).off("click.jsBibleNavigation").on("click.jsBibleNavigation",".jsBibleNavigation",_.bind(this._onClickBibleNavigation,this))},_onClickModalAnchor:function(a){var b=$(a.target);this._setLastVerseIDInteraction(b)},_onClickBibleNavigation:function(a){var b=$(a.target);this._setLastVerseIDInteraction(b),this._updateSelectedVerseHash(this._getLastVerseIDInteraction())},_onClickModalNavigation:function(a){var b=this.getCurrentChapter(),c=$(a.target),d=""+c.data("chapter");""+c.data("book")===b.bookID&&d===b.chapterID||this._updateSelectedVerseHash(this._getLastVerseIDInteraction())},_getLastVerseIDInteraction:function(){return this.lastVerseIDInteraction},_setLastVerseIDInteraction:function(a){this.lastVerseIDInteraction=a.parents(".studyVerse").data("verse-id")},_updateSelectedVerseHash:function(a){a&&h.updateHash("v"+a,!0,h.getState())}}),module.define("DiscoveryTab",a)}(),function(){"use strict";var a,b=module.require("Tab"),c=module.require("settings"),d=c.getSetting("DEPRECATED_HIGHLIGHT_CLASS"),e=c.getSetting("TEXT_HIGHLIGHT_CLASS"),f=module.require("MarginalReference");a=b.extend({TEMPLATE_NAME:"MarginalReferenceTab",getDefaultChapter:function(){return{crossReferenceCategories:[]}},toChapterFormat:function(a){var b=this.getDefaultChapter();return b.crossReferenceCategories=this._buildCrossReferenceCategories(a.verses,a.crossReferences,a.superscriptions),b},_buildCrossReferenceCategories:function(a,b,c){var d,e={},f=_.indexBy(a,"vsID"),g=this;return _.each(b,function(a){var b=a.source;_.each(a.targets,function(c){var d=c.category.id,f=e[d]||{crossReferences:{}},g=b+a.referenceCharacter,h=f.crossReferences[g]||{targets:[]};h.referenceCharacter=a.referenceCharacter,h.source=b,h.targets.push(c),h.id=a.id,f.crossReferences[g]=h,f.label=f.label||c.category.label,f.id=d,e[d]=f})}),d=_.map(e,function(a){var b;return b=_.map(a.crossReferences,function(a){return g._createCrossReferenceGroup(f,a,c)}),{label:a.label,id:a.id,crossReferences:b}}),this._sortReferenceGroups(d)},_createCrossReferenceGroup:function(a,b,c){var d=a[b.source],e=_.findWhere(c,{source:b.source}),g=b.targets,h="",i=b.source;return d?(h=d.abbreviatedCitation,i=d.vsID):e&&(h=e.abbreviatedCitation),new f({id:b.id,sourceVsID:i,sourceCitation:h,referenceCharacter:b.referenceCharacter,targets:g})},_sortReferenceGroups:function(a){var b=[_t("CMSPUBS.HdgMargClsParallelEvent"),_t("CMSPUBS.HdgMargClsQuotation")].reverse();return _.sortBy(a,function(a){return-1*_.indexOf(b,a.label)})},onHighlightAll:function(a,b){var c,d=$(a.currentTarget),e=b.controller,f=e.html.find(".jsHighlightAll");c=e._getAllReferenceIDs(d.parents(".xRefCategory").find(".xRef")),d.is(":checked")?(f.filter(":checked").not(d).click(),e.highlightAll(c),e.collapseAllExpanders(f.not(d).parents(".xRefCategory").find(".jsExpandCollapse"))):e.clearHighlights(c)},_getAllReferenceIDs:function(a){return _.map(a,function(a){return $(a).data("id")})},highlightAll:function(a){var b=this;_.each(a,function(a){b._findXRef(a).addClass(d)})},clearHighlights:function(a){var b=this;_.each(a,function(a){b._findXRef(a).removeClass(d)})},collapseAllExpanders:function(a){if(a.length){var b=a.data("collapseaction");a.filter(".%s".format(b)).click()}},selectVerse:function(a){var b='.xRef[data-vs-id="%s"]'.format(a),c=this.html.find(b),e=c.find(".jsExpandCollapse"),f=e.data("expandaction");this.isSelected()&&e.length&&(e.filter(".%s".format(f)).click(),c.addClass(d),this.scrollTo(c.eq(0)))},onDeselected:function(){if(this.html){var a=this.html.find(".jsExpandCollapse").data("collapseaction");this.html.find(".jsHighlightAll:checked").click(),this.html.find(".jsExpandCollapse.%s".format(a)).click()}},onExpandCollapseReference:function(a,b){var c,d,f=$(a.currentTarget),g=f.data("expandaction"),h=b.controller,i=f.parents(".xRef"),j=i.data("id"),k=h.html.find(".xRef%s".format(j)).not(i).find(".jsExpandCollapse");h.onFetchReference(a,b),f.hasClass(g)?(c=f.parents(".xRefCategory").find(".jsHighlightAll"),h.highlight(i),d=h.html.find(".jsHighlightAll:checked").not(c),d.length&&(d.click(),d=d.parents(".xRefCategory").find(".jsExpandCollapse").not(k).filter(function(a,b){return $(b).closest(".verse").find(".verseNum a.%s".format(e)).exists()}),h.collapseAllExpanders(d))):h.clearHighlight(i)},_findXRef:function(a){return $("#xreflink%s".format(a))}}),module.define("MarginalReferenceTab",a)}(),function(){"use strict";var a,b=module.require("Tab"),c=module.require("BibleVerseRange"),d=module.require("BibleTranslations");a=b.extend({TEMPLATE_NAME:"VerseComparisonTab",init:function(a){this._super(a),this.state.baseArticleCSSClassNames=""},getDefaultChapter:function(){return{hasTranslations:!1,translations:[]}},toChapterFormat:function(a){var b,c=this;return a&&a.translations?a:(b=_.map(a,function(a,b){var d=_.first(a.verses)||{};return{vernacularFullName:a.editionData.vernacularFullName,content:c._filterVerseNum(d.content),standardCitation:a.citation,pubSymbol:b,pubClass:"pub-"+b}}),{hasTranslations:!!b.length,translations:b})},_filterVerseNum:function(a){var b,c=$("<div></div>").html(a);for(c.find(".verseNum,.chapterNum").remove(),b=c.html();0===b.indexOf("&nbsp;");)b=b.substring("&nbsp;".length);return b},selectVerse:function(a){var b=new c(a);return d.getParallelTranslations(b).then(_.bind(this.updateChapter,this))},updateChapter:function(a){this.state.chapter=_.extend(this.state.chapter,this.toChapterFormat(a))},deselectVerse:function(){this.updateChapter(this.getDefaultChapter())},selectCrossReference:function(){}}),module.define("VerseComparisonTab",a)}(),function(){"use strict";var a,b=module.require("Pane"),c=module.require("Bible"),d=module.get("Navigation"),e=module.require("settings"),f=module.require("MediaPage"),g=module.require("BookMediaPage"),h=module.require("ChapterPage"),i=module.require("AdditionalPage"),j=e.getSetting("DEPRECATED_HIGHLIGHT_ADD_CLASS"),k=e.getSetting("DEPRECATED_HIGHLIGHT_CLASS");a=b.extend({keepHighlights:!0,init:function(a){this.container=a,this.chapterPage=new h(a),this.mediaPage=new f(a),this.bookMediaPage=new g(a),this.additionalPage=new i(a)},setBible:function(a){var b=this._formatForDisplay(a);this.mediaPage.setBible(b),this.bookMediaPage.setBible(b),this.chapterPage.setBible(b)},updateContainer:function(a){this.container=a,this.chapterPage.updateContainer(a),this.mediaPage.updateContainer(a),this.bookMediaPage.updateContainer(a),this.additionalPage.updateContainer(a)},showChapter:function(a,b,c){return this.scrollTo(0),b.image&&this.updateContainerShareImage(b.image.src),this.chapterPage.show(a,b.id,b.standardName,c)},selectCrossReference:function(a){var b=this._findXRef(a);this.keepHighlights||this.clearHighlights(),b.addClass(j)},deselectCrossReference:function(a){this._findXRef(a).removeClass(j)},_findXRef:function(a){return this.container.find("#xreflink%s".format(a))},setKeepHighlights:function(a){this.keepHighlights=a},selectVerse:function(a){this.keepHighlights?this.clearHighlights(".xrefLink"):this.clearHighlights(),this.highlightVerse(a)},selectFootnote:function(){this.keepHighlights?this.clearHighlights(".xrefLink"):this.clearHighlights()},showMediaPage:function(a){return this.scrollTo(0),this.mediaPage.draw(a)},showMediaPageForBook:function(a,b){return this.scrollTo(0),this.bookMediaPage.draw(a,b)},_overrideDefaultPageBehaviors:function(){this.container.find(".jsBibleLink, .footnoteLink").addClass("jsNoDialog")},onPageLoad:function(a){this._overrideDefaultPageBehaviors(),this.container.find("a.pub-%s".format(c.PUB_SYMBOLS.NWTSTY)).addClass("jsNoScroll"),this.additionalPage.onPageLoad(a),a.image&&this.updateContainerShareImage(a.image.src)},updateContainerShareImage:function(a){var b=this.container.find(".jsShare + .data .image");b&&b.html(a)},selectPubLink:function(a,b,c,f){if(e.getSetting("PAGE_ID")===b){var g=a.attr("href"),h=g?g.replace(/[^#]+#?/,""):"";h.length&&($(window).scrollTop(0),this.scrollTo(this.container.find("#%s".format(h))),d.updateHash(h,!1,f))}else c&&c()},_formatForDisplay:function(a){if(!a)return null;var b=function(a){var b=_.findWhere(a.images,{type:"sqr"});b&&b.sizes?(b.src=_.chain(b.sizes).values().first().value(),a.image=b):a.image=!1,_.each(a.additionalPages,function(b){b.image=a.image})};return _.each(a.greek,b),_.each(a.hebrew,b),a},highlightVerse:function(a){var b="#v%s .verseNum a, #v%s .chapterNum a".format(a,a);this.container.find(b).addClass(k)},scrollToSelection:function(){var a=d.getCurrentHashValue();a&&this.scrollTo(this.container.find("#"+a))}}),module.define("ReadingPane",a)}(),function(){"use strict";var a,b=module.require("UIController"),c=module.require("DiscoveryTab"),d=module.require("MarginalReferenceTab"),e=module.require("VerseComparisonTab");a=b.extend({TEMPLATE_NAME:"StudyTabs",init:function(a){this.container=a,this.discoveryTab=new c,this.marginalReferenceTab=new d,this.verseComparisonTab=new e,this.tabs=[this.discoveryTab,this.verseComparisonTab,this.marginalReferenceTab]},_injectHTML:function(a){return this.html=a,this.container.empty().append(a),this.html},setContainer:function(a){this.container=a},triggerTabEvent:function(a){$(this).find(".tabContent").trigger(a)},draw:function(){var a=this;return this._draw().then(function(){_.invoke(a.tabs,"setContainer",a.html.find(".tabContent")),_.invoke(a.tabs,"clearLastScrollPosition"),a._listenForScroll()}).then(function(){return $.when.apply($,_.invoke(a.tabs,"draw"))}).then(function(){a.discoveryTab.show()})},setChapter:function(a){this.discoveryTab.updateChapter(a),this.marginalReferenceTab.updateChapter(a),this.verseComparisonTab.deselectVerse()},show:function(){this.container.show()},hide:function(){this.container.hide()},selectVerse:function(a,b){a&&a.length&&(_.isUndefined(b)&&(b=!0),_.invoke(this.tabs,"selectVerse",a,b))},selectFootnote:function(a){a&&a.length&&(this.discoveryTab.show(),_.invoke(this.tabs,"selectFootnote",a))},selectCrossReference:function(a){a&&a.length&&(this.marginalReferenceTab.isSelected()||this.discoveryTab.isSelected()||this.discoveryTab.show(),_.invoke(this.tabs,"selectCrossReference",a))},selectPubLink:function(a){_.invoke(this.tabs,"selectPubLink",a)},scrollToSelectedVerse:function(){this.discoveryTab.isSelected()?this.discoveryTab.scrollToSelectedVerse():_.each(this.tabs,function(a){a.isSelected()&&a.scrollToLastPosition()})},_listenForScroll:function(){var a=this;(this.container.is(".jsLockedContainer")?this.container:this.container.find(".jsLockedContainer")).off("scroll").on("scroll",_.throttle(function(){a.updateSelectedTabScrollPosition($(this).scrollTop())},200))},updateSelectedTabScrollPosition:function(a){_.each(this.tabs,function(b){b.isSelected()&&b.setLastScrollPosition(a)})},setBible:function(a){this.bible=a,_.invoke(this.tabs,"setBible",a)}}),module.define("StudyTabs",a)}(),function(){"use strict";var a,b=module.require("Pane"),c=module.require("StudyTabs"),d=module.require("DefaultView"),e=module.require("OverviewView"),f=module.require("Bible"),g=module.require("signal");a=b.extend({views:{tabs:"showStudyTabs",overview:"showOverview",default:"showDefaultView",hidden:"showHiddenView"},init:function(a){this.container=a,this.studyTabs=new c(a)},setContainer:function(a){this.container=a,this.studyTabs.setContainer(a)},setBible:function(a){this.bible=a,this.studyTabs&&this.studyTabs.setBible(a)},setBookID:function(a){this.bookID=a},open:function(){this.container.trigger("panel:open")},close:function(){this.container.trigger("panel:close")},show:function(){this.container.show()},hide:function(){this.container.hide()},showHiddenView:function(){return this.hide(),$.when(!0)},setChapter:function(a){this.chapter=a,this.studyTabs.setChapter(a)},showStudyTabs:function(){return this.studyTabs.draw()},showOverview:function(){return this.bible?(this.overviewView||(this.overviewView=new e),this.overviewView.draw(this.container,this.bible,this.bookID)):$.when(!1)},showDefaultView:function(){return this.bible?(this.defaultView||(this.defaultView=new d(this.container,this.bible)),this.defaultView.draw(this.container)):$.when(!1)},showView:function(a){a=a||"default",this.view===a&&this.resetView(a);var b=this.views[a]||this.views.default,c=this[b];return this.show(),this.view=a,c.call(this).then(_.bind(this._augmentLinks,this)).then(_.bind(g.send,g,"DOMReady",this.container)).then(_.bind(this.scrollToSelection,this))},_augmentLinks:function(){this._addNavigationLinks(),this._addStudyNoteDataToLinks()},_addNavigationLinks:function(){this.container.find(".pub-%s".format(f.PUB_SYMBOLS.NWTSTY)).addClass("jsBibleNavigation")},_addStudyNoteDataToLinks:function(){var a=this.chapter,b=_t("CMSPUBS.HdgStudyNote");a&&this.container.find("a[data-additionalcontent]").each(function(){var c,d,e=$(this),f=e.data("additionalcontent");f&&(d=(""+f).split(","),c=_.map(d,function(b){var c=a.getCommentary(b);return c?c.content:null}),c=_.filter(c,_.identity),e.data("add-content",c),e.data("add-content-header",b))})},resetView:function(a){"default"===a&&this.defaultView.clearContent()},selectBibleLink:function(a){"default"===this.view&&(this.defaultView.selectVerseRange(a),this.open())},selectPubLink:function(a,b,c){"default"===this.view?(this.defaultView.selectPubLink(a,b,c),this.open()):"tabs"===this.view&&this.studyTabs.selectPubLink(a)},showPubLinkContent:function(a,b){"default"===this.view&&(this.defaultView.showContent(b,a.attr("class"),a.attr("href")),this.open())},selectVerse:function(a,b){_.isUndefined(b)&&(b=!0),this.studyTabs.selectVerse(a,b)},selectFootnote:function(a,b){this.open(),"default"===this.view&&b?(b=$(b),b.find('a[href*="footnotesource"]').remove(),this.defaultView.clearContent(),this.defaultView.showHTMLContent(b)):this.studyTabs.selectFootnote(a)},selectCrossReference:function(a){this.open(),this.studyTabs.selectCrossReference(a)},scrollToSelection:function(){this.studyTabs.scrollToSelectedVerse()}}),module.define("StudyPane",a)}(),function(){"use strict";var a,b=module.require("Bible");a=Class.extend({init:function(a){this.range=a},parse:function(a){var b=a.ranges[this.range];return b?(b=this.filterChapterContent(b),b=this.addHelperFunctions(b)):null},filterChapterContent:function(a){var b,c=_.indexBy(a.crossReferences,"id"),d=this,e=0;return b=function(){return e++},a.html=this._filterChapterHTML(a.html,c,b),a.verses=_.map(a.verses,function(a){return a.content=d.removeHrefAttrs(a.content),a.content=d.replaceXRefTags(a.content,c),a.content=d.replaceFootnoteTags(a.content),a}),a},_filterChapterHTML:function(a,b,c){var d=$("<div></div>").html(this.removeHrefAttrs(a)),e=this;return d.find(".xrefLink").removeClass("jsBibleLink").addClass("jsNoScroll").attr("href","#xref").each(function(){var a=$(this),d=a.attr("id").replace("xreflink",""),f=b[d],g=e.getCrossReferenceCharacter(_.isFunction(c)?c():c++);f&&(f.referenceCharacter=g),a.html(g),a.attr("data-target",d)}),d.find(".footnoteLink").attr("href","#footnote"),d.html()},addHelperFunctions:function(a){return a.getCommentary=function(b){return _.isUndefined(b)||!a.commentaries?null:(_.isString(b)&&(b=parseInt(b,10)),_.findWhere(a.commentaries,{id:b}))},a},replaceXRefTags:function(a,b){var c,d='<a class="xrefLink jsNoScroll" id="xreflink%s" href="#xref" data-target="%s">%s</a>';return a.replace(/<xref id="([0-9]+)">.*?<\/xref>/gi,function(a,e){return c=b[e],d.format(e,e,c.referenceCharacter)})},replaceFootnoteTags:function(a){return a.replace(/<fn id="([0-9]+)"><\/fn>/gi,function(a,b){return'<a class="footnoteLink" id="footnotesource%s" data-anchor="#fn%s" href="#footnote">*</a>'.format(b,b)})},getCrossReferenceCharacter:function(a){var b=this.getCrossReferenceCharacters();return b[a%b.length]},getCrossReferenceCharacters:function(){return this.xrefCharacters||(this.xrefCharacters=b.crossReferenceCharacters()),this.xrefCharacters},removeHrefAttrs:function(a){var b=$("<div></div>").html(a);return b.find(".verseNum a,.chapterNum a").removeAttr("href"),b.html()}}),module.define("ChapterResponseParser",a)}(),function(){"use strict";var a,b,c=module.require("MediaPage"),d=window.sprintf;a=Class.extend({init:function(){this.bookIndex={},this.state={hebrew:[],greek:[]}},parse:function(a,b){return this.state=_.extend(b.editionData,this.state),this.state.books=_.map(_.keys(b.editionData.books),_.bind(this.createBook,this,b.editionData.books)),this.state.books=_.reject(this.state.books,_.isNull),this.state.additionalPages=_.map(b.additionalPages,_.bind(this.pageToBook,this)),this.state.hasHebrewBooks=!!this.state.hebrew.length,this.state.hasMediaForHebrewScriptures=_.any(this.state.hebrew,function(a){return a.showInGallery}),this.state.hasGreekBooks=!!this.state.greek.length,this.state.hasMediaForGreekScriptures=_.any(this.state.greek,function(a){return a.showInGallery}),this.state.bookIndex=this.bookIndex,this.state.pubSymbol=a,this.state.baseArticleCSSClassNames=this.state.articleCSSClassNames.replace(/docClass-[0-9]+ ?/,"").replace(/docId-[0-9]+ ?/,"").replace(/pub-[0-9\-a-z]+ ?/,""),this.state.copyrightPage=b.copyrightPage,this._addSyntheticPages(this.state),this.state},createBook:function(a,b){var c=a[b],d=parseInt(c.chapterCount,10),e=this;return 0===d?null:(b=parseInt(b,10),c=_.extend(c,{id:b,title:c.standardName,abbr:c.officialAbbreviation,longAbbr:c.standardAbbreviation,chapterDisplayTitle:c.chapterDisplayTitle,displayTitle:c.bookDisplayTitle,type:b>=40?"greek":"hebrew",groupStyle:this.getBookGroupStyle(b),isBibleBook:!0,hasChapters:!0,showInGallery:c.hasMultimedia&&c.hasStudyNotes}),this.setPreviousAndNext(c),c.additionalPages=_.map(c.additionalPages,function(a){return e.pageToChapter(a)}),c.hasAdditionalPages=!!c.additionalPages.length,c.chapters=this.createChapters(b,d),this.setBookIndex(c.id,c),this.state[c.type].push(c),c)},createChapters:function(a,b){var c,d,e=_.range(1,b+1),f=this;return _.map(e,function(b){return d=""+b,c={id:d,title:d,abbr:d,url:null,bookID:a,isBibleChapter:!0},f.setPreviousAndNext(c),c})},setBookIndex:function(a,b){this.bookIndex[a]=b},pageToBook:function(a){var b={url:a.url,title:a.title,mepsTitle:a.mepsTitle,abbr:a.title,id:a.pageID,isBibleBook:!1,additionalPages:[],pageID:a.pageID,hasAudio:!1,images:[],docClass:a.docClass,pageCSSClassNames:a.pageCSSClassNames,articleCSSClassNames:a.articleCSSClassNames,hasAdditionalPages:!1,openLinksInReadingPane:a.openLinksInReadingPane};return this.setPreviousAndNext(b),b.chapters=_.map(a.children,_.bind(this.pageToChapter,this)),b.hasChapters=!!b.chapters.length,this.setBookIndex(b.pageID,b),b},pageToChapter:function(a){var b={id:a.pageID,title:a.title,mepsTitle:a.mepsTitle,abbr:a.abbreviatedTitle,url:a.url,isBibleChapter:!1,pageCSSClassNames:a.pageCSSClassNames,articleCSSClassNames:a.articleCSSClassNames,docClass:a.docClass};return this.setPreviousAndNext(b),b.children=_.map(a.children,_.bind(this.pageToChapter,this)),b},setPreviousAndNext:function(a){var b=["id","bookID","isBibleBook","isBibleChapter","url","title","pageCSSClassNames"];a.hasPrevious=!!this.previous,a.hasNext=!1,this.previous&&(a.previous=_.pick(this.previous,b),delete a.previous.previous,delete a.previous.next,this.previous.next=_.pick(a,b),delete this.previous.next.previous,delete this.previous.next.next,this.previous.hasNext=!0),this.previous=a},getBookGroupStyle:function(a){var c=_.find(b,function(b){return a>=b.min&&a<=b.max});return c?c.className:"normal"},_addSyntheticPages:function(a){var b,e=this
;b={hash:"#%s".format(c.HASH_URL),url:"%s#%s".format(a.url,c.HASH_URL),title:_t("CMSPUBS.HdgMediaGallery"),abbr:_t("CMSPUBS.HdgMediaGallery"),id:c.PAGE_ID,chapters:[],isBibleBook:!1,additionalPages:[],hasChapters:!1,pageID:c.PAGE_ID,pageCSSClassNames:a.pageCSSClassNames,articleCSSClassNames:a.articleCSSClassNames,hasAudio:!1,isMediaPage:!0},this.setPreviousAndNext(b),b.chapters=_.chain(a.books).filter(function(a){return a.hasMultimedia}).reduce(function(b,f){var g;return g={hash:"#%s/%s".format(c.HASH_URL,f.id),url:"%s#%s/%s".format(a.url,c.HASH_URL,f.id),title:d(_t("CMSPUBS.HdgMediaGalleryBook"),f.standardName),abbr:d(_t("CMSPUBS.HdgMediaGalleryBook"),f.standardName),id:c.PAGE_ID+"-"+f.id,bibleBookID:f.id,pageID:c.PAGE_ID+"-"+f.id,pageCSSClassNames:a.pageCSSClassNames,articleCSSClassNames:a.articleCSSClassNames,isBibleChapter:!1},f.hasStudyNotes&&e.setPreviousAndNext(g),b.push(g),b},[]).value(),b.hasChapters=!!b.chapters.length,a.bookIndex[c.PAGE_ID]=b,a.additionalPages.push(b)}}),b=[{min:1,max:5,className:"colorThree"},{min:6,max:17,className:"colorOne"},{min:23,max:43,className:"colorThree"},{min:44,max:44,className:"colorOne"},{min:66,max:66,className:"colorThree"}],module.define("StudyBibleResponseParser",a)}(),function(){"use strict";var a,b=module.require("Bible"),c=module.require("Route"),d=module.require("BibleJumper"),e=module.require("ReadingPane"),f=module.require("StudyPane"),g=module.require("BibleVerseRange"),h=module.require("BibleMultimedia"),i=module.require("StudyBibleResponseParser"),j=module.require("ChapterResponseParser"),k=module.require("MediaPage"),l=module.require("settings"),m=module.require("insight"),n=module.require("signal"),o=module.get("Navigation"),p=module.require("SimpleModal"),q=l.getSetting("DEPRECATED_HIGHLIGHT_CLASS"),r=$("#mobileStudyPaneHandle");a=Class.extend({loading:null,init:function(a,c,d,g){this.pubSymbol=a,this.bookName=c,this.bookID=d,this.chapterID=g,this.bible=new b(a),this.readingPane=new e($(".readingPane")),this.studyPane=new f($(this.getStudyPaneSelector())),this.moveStudyPane(),this.setPreserveHighlights(!0)},open:function(){var a=this.isBiblePage()&&this.chapterID,b=this;return this.fetchBible().then(function(c){var d,e;return b.bibleData=c,b.readingPane.setBible(c),b.studyPane.setBible(c),b.bindEventListeners(),a?(e={id:b.bookID,standardName:b.bookName},d=b.openChapter(e,b.chapterID,null,!0).then(_.bind(b.setPreserveHighlights,b,!1)),$.when(b._createBibleJumper(c),d)):b._createBibleJumper(c).then(_.bind(b._routeUsingHash,b))}).then(function(){a||(b.readingPane.onPageLoad(b.bibleJumper.getSelectedPage()),b.setPreserveHighlights(!1),b.updateStudyPaneView(),o.updateState(b.bibleJumper.getState()))})},_routeUsingHash:function(){var a,b=o.getCurrentHashValue(),d=[];return d.push(new c(k.HASH_URL+"/:bookID/:chapterID/:docID",this._navigateToMediaPage.bind(this))),d.push(new c(k.HASH_URL+"/:bookID",this._navigateToMediaPage.bind(this))),d.push(new c(k.HASH_URL,this._navigateToMediaPage.bind(this))),a=_.find(d,function(a){return a.match(b)}),a?a.navigate(b):$.when(!1)},_navigateToMediaPage:function(a){var b,c=!1;if(this.bibleJumper.setSelectedBookID(k.PAGE_ID),a&&a.bookID){if(b=this.bibleJumper.findChapter(k.PAGE_ID+"-"+a.bookID))return this.bibleJumper.setSelectedChapter(b),this.showMediaPage(this.bibleJumper.getSelectedChapter(),a);a.bookID=null,c=!0}return this.showMediaPage(this.bibleJumper.getSelectedBook(),a,c)},_createBibleJumper:function(a){return this.bibleJumper=new d(a,$(".jsBibleJumper")),this.bibleJumper.draw().then(_.bind(this.bibleJumper.selectPageLocation,this.bibleJumper))},fetchBible:function(){var a,b=this;return this.loading||(a=new i,this.loading=$.getJSONCached(this.bible.getDataAPIURL()).then(_.bind(a.parse,a,this.getPubSymbol())).then(function(a){return b.state=a,a})),this.loading},fetchChapter:function(a){var b=this,c=new j(a.getID());return $.getJSONCached(a.getDataAPIURL()).then(_.bind(c.parse,c)).then(function(c){return c.id=a.start.chapter,c.book=b.state.bookIndex[a.start.book],_.extend(c,b.getChapter(a.start.book,c.id)||{})})},fetchMultimedia:function(a){return h.fetchMultimedia(this.bible.pubSymbol,a||this.bookID)},getPubSymbol:function(){return this.pubSymbol},isBiblePage:function(){return!!$("#bibleText").length&&!!$("article").data("chapter")},getStudyPaneView:function(){return $("article").data("study-view")||"default"},updateStudyPaneView:function(){var a=this.getStudyPaneView();return"hidden"===a?($(".readingPane").addClass("fullPane"),r.hide()):($(".readingPane").removeClass("fullPane"),this.isMobile()&&r.show()),this.studyPane.showView(a)},loadPage:function(a,b){var c=this;return this.studyPane.hide(),this.readingPane.hideContents(),this.readingPane.scrollTo(0),o.swapContent(a,[".readingPane"],!0,!0).done(function(){c.studyPane.show(),c.readingPane.updateContainer($(".readingPane")),c.readingPane.onPageLoad(c.bibleJumper.getSelectedPage()),c.updateStudyPaneView(),c.updateURL({urlString:a,hash:b,preserveHash:!1,state:c.bibleJumper.getState()}),n.send("PageLoaded"),m.onPageLoad(),b&&(c.readingPane.scrollTo($(b)),c.readingPane.restoreScrollStateAfterImagesLoad())})},updateURL:function(a){if(this.historyNavigationInProgress)return void this.notifyHistoryNavigationStopped();o.updateURL(a)},getChapter:function(a,b){if(!this.state||!this.state.bookIndex)return null;var c=this.state.bookIndex[a];return c&&c.chapters?c.chapters[b-1]||null:null},getBook:function(a){return this.bibleData&&this.bibleData.bookIndex?this.bibleData.bookIndex[a]:null},openChapter:function(a,b,c,d){var e,f=this,h=this.getPubSymbol();return this.bookID=a.id,this.chapterID=b,e=g.allForChapter(a.id,b,this.getPubSymbol()),this.studyPane.hide(),d||this.readingPane.hideContents(),this.fetchChapter(e).then(function(b){return f.studyPane.setChapter(b),f._updateChapterURLHash(e,c,b.link,d),o.updatePageTitle(f.createPageTitle(b.citation)),f.readingPane.showChapter(b,a,h)}).then(function(){return o.updatePageID("ChapterPage"),m.updateContextID("bc-"+a.id+("000"+b).slice(-3)+"_nwtsty"),d||f.readingPane.showContents(),f.updateStudyPaneView()}).then(function(){f.studyPane.show(),n.send("PageLoaded",f.readingPane.container),d||m.onPageLoad(),f._navigateToBibleVerseHash()})},onHashChange:function(){this._navigateToBibleVerseHash()},_navigateToBibleVerseHash:function(){var a,b=o.getCurrentHashValue();this.isBiblePage()&&g.isRange(b)&&(a=new g(b),this.readingPane.highlightVerse(""+a.startRangeIndex),this.studyPane.selectVerse(""+a.startRangeIndex),this.studyPane.restoreScrollStateAfterImagesLoad())},_updateChapterURLHash:function(a,b,c,d){var e,f,h,i=o.getCurrentHashValue();if(b&&b.length)return h=new g(b),void this.updateURL({urlString:c,hash:h.toRangeString(),preserveHash:d,state:this.bibleJumper.getState()});e=i&&i.length,f=e&&g.isRange(i)&&a.isVerseRangeInRange(i),f||(c=o.removeHash(c)),this.updateURL({urlString:c,hash:!!f&&i,preserveHash:f,state:this.bibleJumper.getState(),overwriteHistory:d})},showMediaPage:function(a,b,c){var d,e=this,f=b&&b.bookID,g=b&&b.bookID&&b.chapterID&&b.docID;return d=f?this.readingPane.showMediaPageForBook(a,b.bookID):this.readingPane.showMediaPage(a),d.then(function(){var d=a.hash.replace("#","");g&&(d=d+"/"+b.chapterID+"/"+b.docID),e.readingPane.showContents(),e.updateStudyPaneView(),o.getCurrentHashValue()!==d&&e.updateURL({urlString:e.bibleData.url,hash:d,preserveHash:!1,state:e.bibleJumper.getState(),overwriteHistory:c}),g&&n.send("MediaGallery:ShowItem",b),o.updatePageID(a.id),o.updatePageTitle(e.createPageTitle(k.PAGE_TITLE)),m.updateContextID("bible:nwtsty:media"+(f?":"+b.bookID:"")),m.onPageLoad(),e.bibleJumper.close()})},goHome:function(){return this.loadPage(this.bibleData.url)},restoreNavigationState:function(a){this.isReady()&&(this.historyNavigationInProgress=!0,this.bibleJumper.restoreState(a))},notifyHistoryNavigationStopped:function(){this.historyNavigationInProgress=!1},bindEventListeners:function(){var a="%s .chapterNum a, %s .verseNum a".format(".readingPane",".readingPane"),c="%s .footnoteLink".format(".readingPane"),d="%s .xrefLink".format(".readingPane"),e="%s .jsBibleBook:not(.unavailable)".format(".readingPane"),f="%s .xRef .jsExpandCollapse, %s .xRef .jsExpandCollapse".format(".studyPane","#mobileStudyPane"),g="a.pub-%s".format(b.PUB_SYMBOLS.NWTSTY),h="%s .jsBibleLink:not(.xrefLink)".format(".readingPane"),i="%s .jsBibleLink, %s .jsBibleLink".format(".studyPane","#mobileStudyPane"),j="%s .jsDialogContentLink, %s .jsDialogContentLink".format(".studyPane","#mobileStudyPane"),k="%s .jsVerselessPartialCommentary, %s .jsVerselessPartialCommentary".format(".studyPane","#mobileStudyPane"),l="%s .jsGalleryToggle a, %s .jsGalleryToggle a".format(".studyPane","#mobileStudyPane"),m="%s .jsGalleryToggle img, %s .jsGalleryToggle img".format(".studyPane","#mobileStudyPane"),n=[i,j,k,l,m].join(","),o="%s .jsHighlightAll, %s .jsHighlightAll".format(".studyPane","#mobileStudyPane"),p="%s .studyVerse, %s .studyVerse".format(".studyPane","#mobileStudyPane"),q="%s .tabContainer, %s .tabContainer".format(".studyPane","#mobileStudyPane");$(window).on("resize",_.throttle(_.bind(this.moveStudyPane,this),150)),$(window).on("hashchange",_.bind(this._routeUsingHash,this)),$(document).on("click",a,_.bind(this.onSelectVerse,this)).on("click",c,_.bind(this.onSelectFootnote,this)).on("click",d,_.bind(this.onSelectCrossReference,this)).on("click",e,_.bind(this.onBibleBookClick,this)).on("click",f,_.bind(this.onExpandCollapseCrossReference,this)).on("click",g,_.bind(this.onPubLinkClick,this)).on("click",".jsBibleChapter",_.bind(this.onBibleChapterClick,this)).on("click",h,_.bind(this.onReadingPaneBibleLinkClick,this)).on("click",n,_.bind(this.onStudyPaneBibleLinkClick,this)).on("click",o,_.bind(this.onHighlightAllClick,this)).on("click",p,_.bind(this.onSelectStudyNote,this)).on("tab:selected",q,_.bind(this.onTabChange,this))},setSelectedBook:function(a){a&&this.studyPane.setBookID(a.id)},onTabChange:function(){var a=$("%s .tabContainer.current".format(this.getStudyPaneSelector()));this.preserveHighlights||this.clearHighlights(),a.hasClass("discoveryTab")?this.readingPane.setKeepHighlights(!1):this.readingPane.setKeepHighlights(!0)},setPreserveHighlights:function(a){this.preserveHighlights=a},clearHighlights:function(){this.studyPane.clearHighlights(),this.readingPane.clearHighlights()},onBibleBookClick:function(a){a.preventDefault();var b=$(a.currentTarget),c=b.data("book");this.bibleJumper.selectBook(c,!0)},onReadingPaneBibleLinkClick:function(a){a.preventDefault();var b=$(a.currentTarget);this.studyPane.selectBibleLink(""+b.data("targetverses"))},onStudyPaneBibleLinkClick:function(a){a.stopPropagation()},onBibleChapterClick:function(a){a.preventDefault();var b,c=$(a.currentTarget),d=c.data("verse"),e=c.data("book"),f=c.data("chapter");if(p.close(),this.studyPane.close(),this.bibleJumper.isSelectedBookID(e)&&this.bibleJumper.isSelectedChapterID(f))return this.readingPane.clearHighlights(),d&&d.length&&(b=new g(d),o.updateHash(b.toRangeString(),!1,this.bibleJumper.getState())),n.send("PageLoaded",this.readingPane.container),void this.studyPane.selectVerse(d);this.bibleJumper.selectBook(e),this.bibleJumper.selectChapter(f,d)},onPubLinkClick:function(a){a.preventDefault();var b,c=$(a.currentTarget),d=c.data("page-id"),e=c.attr("href"),f=c.hasClass("jsBibleNavigation"),g=c.is("%s a".format(".studyPane"))||c.is("%s a".format("#mobileStudyPane")),h=!g&&c.is("%s a".format(".readingPane")),i=!!d&&this.bibleJumper.findPage(d);return a.stopPropagation(),d&&i?(this.bibleJumper.getSelectedPage().openLinksInReadingPane&&(f=!0),p.close(),g?(b=_.bind(this.navigateToPage,this,i,c),void this.studyPane.selectPubLink(c,d,b)):f?void this.navigateToPage(i,c):h?(b=_.bind(this.studyPane.showPubLinkContent,this.studyPane,c,i),void this.readingPane.selectPubLink(c,d,b,this.bibleJumper.getState())):void this.navigateToPage(i,c)):void(!e||c.hasClass("jsBibleBook")||c.hasClass("jsBibleChapter")||(window.location.href=e))},navigateToPage:function(a,b){if(l.getSetting("PAGE_ID")===a.id)return void this.readingPane.selectPubLink(b,a.id,!1,this.bibleJumper.getState());var c=b.attr("href"),d=o.getHashFromURL(c);!this.bibleJumper.navigateToPage(a.id,!0,d)&&c&&(window.location.href=c),this.studyPane.close()},onSelectFootnote:function(a){var b=$(a.currentTarget),c=b.data("anchor")||"",d=c.replace(/[^0-9]/g,""),e=$();a.preventDefault(),"#"===c.charAt(0)&&(e=$(c).html()),this.readingPane.selectFootnote(d,e),this.studyPane.selectFootnote(d,e),b.addClass(q)},onSelectVerse:function(a){var b=$(a.currentTarget),c=b.data("anchor")||"",d=c.replace(/[^0-9]/g,"");a.preventDefault(),this.readingPane.selectVerse(d),this.studyPane.open(),this.studyPane.selectVerse(d),o.updateHash(c.substring(1),!1,this.bibleJumper.getState())},onSelectStudyNote:function(a){var b=$(a.currentTarget),c=b.data("verse-id");a.preventDefault(),this.readingPane.selectVerse(c),o.updateHash("v%s".format(c),!1,this.bibleJumper.getState()),this.readingPane.scrollToSelection(),this.studyPane.selectVerse(c,!1)},onSelectCrossReference:function(a){var b=$(a.currentTarget),c=this._getCrossReferenceID(b.attr("id"));a.preventDefault(),this.readingPane.clearHighlights(".xrefLink"),this.readingPane.selectCrossReference(c),this.studyPane.selectCrossReference(c)},onExpandCollapseCrossReference:function(a){var b=$(a.currentTarget),c=b.parents(".xRef"),d=c.data("id"),e=b.data("collapseaction"),f=$("%s .xRef%s".format(this.getStudyPaneSelector(),d)).not(c);b.hasClass(e)?this.readingPane.selectCrossReference(d):f.find(".jsExpandCollapse").hasClass(e)||this.readingPane.deselectCrossReference(d),a.stopPropagation()},onMediaPageClick:function(){this.bibleJumper.selectMediaPage()},onHighlightAllClick:function(a){var b=$(a.currentTarget);a.stopPropagation(),b.is(":checked")&&(this.studyPane.close(),this.readingPane.clearHighlights(".xrefLink"))},_getCrossReferenceID:function(a){return a?a.replace(/[^0-9]/g,""):""},moveStudyPane:function(){var a=$(".studyPane"),b=$("#mobileStudyPane"),c=this.isMobile();!this.wasMobile&&c?(b.append(a.children().detach()),a.hide(),this.studyPane.setContainer(b)):this.wasMobile&&!c&&(a.append(b.children().detach()),a.show(),this.studyPane.setContainer(a)),this.wasMobile=c},isMobile:function(){return l.getSetting("IS_SMALL_LAYOUT")},getStudyPaneSelector:function(){return this.isMobile()?"#mobileStudyPane":".studyPane"},formatBibleVerseLinks:function(){var a=$(".jsBibleLink").not(".jsNoDialog");this.hideModalVerseLinks(a)},hideModalVerseLinks:function(a){if(this.bibleData&&this.bibleData.bookIndex){var b=this;a.not(".jsHiddenVerses").addClass("jsHiddenVerses").each(function(){var a=$(this);a.closest(".readingPane").exists()||a.data("available-bible-books",_.pluck(b.bibleData.bookIndex,"id"))})}},isBibleBookAvailable:function(a){return!!this.bibleData.bookIndex[a]},isReady:function(){return!!this.bibleJumper},createPageTitle:function(a){return this.bibleData&&this.bibleData.titleFormat?this.bibleData.titleFormat.format(a):""}}),a.EVENTS={CHANGE_CHAPTER_SIGNAL:"StudyBible:changeChapter",CHANGE_PAGE_SIGNAL:"StudyBible:changePage",MEDIA_PAGE_SIGNAL:"StudyBible:showMediaPage",CHANGE_BOOK_SIGNAL:"StudyBible:changeBook",NO_CHANGE_SIGNAL:"StudyBible:noChange"},module.define("StudyBible",a)}(),function(){"use strict";var a,b=module.require("settings"),c=module.require("BibleVerseRange"),d=module.require("Bible"),e=module.require("BibleVerse"),f=module.require("signal"),g=module.require("BibleVerseRangeCollection"),h=module.require("MarginalReference"),i=module.require("MediaPage"),j=module.require("UIController"),k=module.get("ScrollHelper"),l=module.require("HeadlessAudioPlayer"),m=module.require("RangeStreamingController"),n=module.require("LanguageUtils"),o=module.get("Navigation");a=j.extend({TEMPLATE_NAME:"ScriptureDialog",elem:null,loading:null,dialogClass:"",init:function(a,c,d){this._super(),d=d||{},_.defaults(d,{availableBibleBooks:_.range(1,67),bibleTextAPIBase:null}),b.getPageConfig("BIBLE_ALT_LANG_NAME")&&(this.alternateBibleLanguage="("+b.getPageConfig("BIBLE_ALT_LANG_NAME")+")"),this.audioPlayers={},this.streamingVideo={},this.verseRanges=new g(a,c),this.pubSymbol=c,this.requestedBible=d.requestedBible,this.availableBibleBooks=d.availableBibleBooks,this.resized=!1,this.translations=null,d.bibleTextAPIBase&&this.verseRanges.setTextAPIBase(d.bibleTextAPIBase),this.currentTab="scripture",this.scrollToXref=""},close:function(){this.elem.dialog("close"),this.__removePlayers(),this.changeTab("scripture"),$(document).off("click.closeOnOverlayClick-scriptureDialog"),this.elem.remove(),this.elem=null},load:function(){if(!this.loading){var a=this.verseRanges.getTextAPIURL();this.loading=$.getJSONCached(a)}return this.loading},loadTranslations:function(){var a=this.verseRanges.getHTMLTranslationsAPIURL(),b=this;if(!this.deferredTranslations&&this.hasTranslations)this.deferredTranslations=$.getJSONCached(a).then(function(a){b.translations=b._createTranslations(a.ranges)});else if(!this.deferredTranslations)return $.when();return this.deferredTranslations},open:function(){var a=$("body").hasClass("pub-nwtsty");this.resized=!1,this.elem=this.__buildDialog(),this._draw(),"nwtsty"!==this.requestedBible||"nwtsty"!==this.pubSymbol||a||this.changeTab("gems"),f.send("modalOrDialogOpened")},playRangeAudio:function(a,b){var c=b.controller,d=$(this),e=d.closest(".verseRange").data("verse-id"),f=c.verseRanges.getRange(e);if(c.__showAudioPauseButton(d,!0),c.audioPlayers[e])return void c.audioPlayers[e].play();c.__buildAudioPlayer(d,f).then(function(){c.audioPlayers[e].play()})},pauseRangeAudio:function(a,b){var c=b.controller,d=$(this),e=d.closest(".verseRange").data("verse-id");c.__showAudioPlayButton(d,!0),c.audioPlayers[e]&&c.audioPlayers[e].pause()},onScriptureClick:function(a,b){b.controller.close()},onTabButtonClick:function(a,b){var c=$(this),d=c.data("tab");a.preventDefault(),b.controller.changeTab(d)},onTabButtonClickTranslations:function(a,b){a.preventDefault(),b.controller.loadTranslations().then(function(){b.controller.__resizeTabContents()}),b.controller.changeTab("translations")},onClickCrossReference:function(a,b){var c=""+b.reference.id,d=b.controller.elem.find(".xRef"+c);return d.find(".jsExpandCollapse").hasClass("expanded")&&b.controller._pauseVideoInSection(d),b.controller.fetchCrossReference(b.reference).then(function(){if(b.controller.__buildXRefVideoPlayers(d,b.reference),b.controller.scrollToXref===c)return b.controller.goToGemsContent(d,!0,!0),void(b.controller.scrollToXref="");b.controller._highlightElement(d)})},_pauseVideoInSection:function(a){var b=this;a.find(".jsMediaPlayer").each(function(){var a=$(this).data("id"),c=b.streamingVideo[a];c&&c.pause()})},fetchCrossReference:function(a){return a.fetch()},changeTab:function(a){this.currentTab=a,this.__resizeTabContents(),this.updateTitle(),this._pauseVideoInSection(this.elem)},goToXref:function(a){var b=this.elem.find(".xRef"+a),c=b.find(".jsExpandCollapse");if(this.scrollToXref=""+a,c.hasClass("collapsed"))return c.click(),void this.changeTab("gems");this.goToGemsContent(b,!0)},goToFootnote:function(a,b){var c=this.elem.find(".fn"+a);b&&this._highlightElement(c),this.goToGemsContent(c.closest(".footnotes"),!1)},goToVerseGems:function(a,b){var c=this.elem.find('.jsVerseContent[data-id="'+a+'"]:not(.none)');c.length&&this.goToGemsContent(c,b)},goToGemsContent:function(a,b,c){var d=this.elem.find(".jsScriptureDialogGemsContent");c||this.changeTab("gems"),k.scrollTo(d,a),b&&this._highlightElement(a)},_highlightElement:function(a){this._removeAllHighlights(),$(a).addClass("highlight")},_removeAllHighlights:function(){this.elem.find(".highlight").removeClass("highlight")},_buildStateContext:function(){var a=this.load(),b=this,d={};return d.ranges=a.then(function(a){b.edition=a.editionData,b.vernacularSectionHeadings=a.vernacularSectionHeadings;var d=_.chain(a.ranges).map(function(a,b){return a.givenVerseRange=b,a}).sort(function(a,b){return c.compareRangeOrder(a.givenVerseRange,b.givenVerseRange)}).map(function(a){return b._createRange(a,a.givenVerseRange)}).value();return $.when.apply($,d)}).then(function(){var a=Array.prototype.slice.call(arguments);return b.hasStudyContent=_.reduce(a,function(a,b){var c=!1;return c=_.any(b.verses,function(a){return a.hasStudyContent}),a||c},!1),b.hasTranslations=_.any(a,function(a){return a.numTranslations>1}),a}),d.vernacularSectionHeadings=a.then(function(a){return a.vernacularSectionHeadings}),d.editionData=a.then(function(a){return a.editionData}),d},_createTranslations:function(a){var b;return b=_.chain(a).reduce(function(a,b){return _.each(b,function(b,c){a[c]={pubClass:"pub-"+c,editionData:b.editionData,ranges:[],multiVerse:!1}}),a},{}).value(),_.each(a,function(a,c){_.each(a,function(a,d){var e=$("<div></div>");e.append(a.html),e.find("sup.verseNum a, span.chapterNum a").contents().unwrap(),e.find("span.verse").removeAttr("id"),e.find(".xrefLink").remove(),e.find(".footnoteLink").remove(),b[d].ranges.push({citation:a.citation,html:e.html(),multiVerse:-1!==c.indexOf("-")})})}),b=_.map(b,function(a){return a.ranges.length>1?a.hasMultipleVerses=!0:a.hasMultipleVerses=_.any(a.ranges,function(a){return a.multiVerse}),a}),_.values(b)},_createRange:function(a,c){var e,f,g,h,i,j=_.isFunction(this.availableBibleBooks)?this.availableBibleBooks():this.availableBibleBooks,k=this.verseRanges.getRange(c),l=$("<div></div>"),m=this,n=!_.contains(j,k.start.book),o=b.getPageConfig("IS_SIGN_LANGUAGE");return l.append(a.html),g=_.map(a.crossReferences,function(a,b){var c=d.crossReferenceCharacters(m.vernacularSectionHeadings.MarginalReferenceChars);return a.referenceCharacter=c[b%c.length],a}),f=_.indexBy(g,"id"),l.find(".xrefLink").each(function(){var a=$(this),b=a.attr("id").replace(/[a-zA-Z]/g,"");f[b]&&a.html(f[b].referenceCharacter)}),_.each(a.multimedia,function(a){a.includedForRanges=[],"video"===a.type&&(a.posterURL=_.isObject(a.keyframe)?a.keyframe.zoom||a.keyframe.src:void 0,a.pubMediaURL=a.resource.src[0])}),e=_.map(a.verses,_.bind(this._mapVerse,this,a,g)),h=this._superscriptionData(a,g),h&&e.unshift(h),i={id:c,citation:a.citation,link:a.link,footnotes:a.footnotes,multimedia:a.multimedia,content:l.html(),audio:k.hasAudio(),video:k.hasVideo(),book:k.start.book,chapter:k.start.chapter,hideLink:n,startRange:k.startRange,verses:e,numTranslations:a.numTranslations,commentaries:k.commentaries,isMissingSignLanguageVideo:!1},o?k.hasVideo().then(function(a){return i.isMissingSignLanguageVideo=!a,i}):$.when(i)},_mapVerse:function(a,b,c){var d=""+c.vsID,e=this;return c.multimedia=_.chain(a.multimedia).filter(function(a){var b=new g(a.source,e.pubSymbol);return _.any(b.ranges,function(b){var d=b.isVerseRangeInRange(c.vsID);return!!(d=d&&!_.contains(a.includedForRanges,b.getID()))&&(a.includedForRanges.push(b.getID()),!0)})}).map(function(a){var b=e.edition.url;return a.url=b+"#"+i.createMediaItemHash(c.bookNumber,c.chapterNumber,a.docID),a}).value(),c.hasMultimedia=c.multimedia.length>0,c.commentaries=_.where(a.commentaries,{source:d}),c.hasCommentaries=c.commentaries.length>0,c.footnotes=_.where(a.footnotes,{source:d}),c.hasFootnotes=c.footnotes.length>0,c.crossReferences=_.chain(b).where({source:d}).map(function(a){return new h(_.extend(a,{targets:a.targets}))}).value(),c.hasCrossReferences=c.crossReferences.length>0,c.hasStudyContent=c.hasMultimedia||c.hasCommentaries||c.hasFootnotes||c.hasCrossReferences,c},_superscriptionData:function(a,b){var c,d;return(c=_.find(a.superscriptions,function(a){return/.*000$/.test(a.source)}))?(d=new e(c.source),c.vsID=c.source,c.bookNumber=d.book,c.chapterNumber=d.chapter,c.verseNumber=0,this._mapVerse(a,b,c)):null},_injectHTML:function(a){var b=this;this.elem.empty().append(a),this.__recenter(),this.elem.find("img").load(this.__recenter.bind(this)),this.__bindLinkEvents(),this.elem.on("click","a.jsBibleLink:not(.xrefLink)",function(){b.close()}),this.elem.find("a.jsBibleLink").each(function(){$(this).attr("target","_self")}),this.elem.find("a.xrefLink").addClass("jsNoScroll"),this.alternateBibleLanguage&&this.__addAlternateBibleLanguageInfo(),this.__resizeTabContents(),this.__buildVideoPlayers()},__buildVideoPlayers:function(){var a=this;this.elem.find(".jsScriptureDialogRangeContent .jsVideoPlayer").each(function(){var b=$(this).find(".jsMediaPlayer"),c=b.data("id"),d=a.verseRanges.getRange(c);a.__buildVideoPlayer(b,d,!0)})},__buildXRefVideoPlayers:function(a,b){var c=this;a.find(".xRefVerse").each(function(){var a,d=$(this),e=d.data("id");(a=b.rangeCollection.getRange(e))&&!d.find(".videoWrapper").length&&a.hasVideo().then(function(f){var g=$('<div class="videoWrapper"><div class="jsVideoPlayer"><div class="jsMediaPlayer" /></div></div>'),h=g.find(".jsMediaPlayer");f&&(h.data("id",b.id+"-"+e),c.__buildVideoPlayer(h,a,!1),d.find(".xRefVerseHeader").after(g))}).done()})},__buildVideoPlayer:function(a,b,c){var d=_.first(b.listVerseRangeResources()),e=a.data("id"),f={};d&&(c&&(f.playerReadyHandler=function(){this.__resizeTabContents()}.bind(this)),this.streamingVideo[e]=new m(a,d,f))},__bindLinkEvents:function(){var a=this;this.elem.on("click","a.xrefLink",function(b){var c=$(this),d=c.attr("id").replace(/[a-zA-Z]/g,"");b.preventDefault(),a.goToXref(d)}),this.elem.on("click","a.footnoteLink",function(b){var c=$(this),d=c.data("anchor").replace(/[a-zA-Z#]/g,"");b.preventDefault(),a.goToFootnote(d,!0)}),this.elem.on("click",".chapterNum a, .verseNum a",function(b){var c=$(this),d=c.data("anchor").replace(/[a-zA-Z#]/g,"");b.preventDefault(),a.goToVerseGems(d,!0)}),this.elem.on("click","a.jsMediaLink",function(){o.getHashFromURL($(this).attr("href"))!==o.getCurrentHashValue()?f.send("CloseAllModals"):a.close()})},__recenter:function(){this.elem.dialog("option","position",{my:"center",at:"center center+"+this.__dialogVerticalOffset()/2,of:window})},__buildDialog:function(){var a=b.getSetting("IS_MOBILE_LAYOUT"),c=a?300:400,d=.375*c,e=.9*$(window).height()-this.__dialogVerticalOffset(),f=.9*$(window).width(),g=$("<div><div class='loadingIndicator small'></div></div>"),h=$("body"),i=$("#article"),j=this;return g.addClass("scriptureDialog"),g.dialog({dialogClass:"scriptureDialog "+(this.dialogClass||""),title:this.__getTitle(),maxHeight:e,maxWidth:f,width:c,minHeight:d,modal:a,open:function(){j.dialogClass&&$(".ui-widget-overlay").addClass(j.dialogClass)},close:function(){j.close()},closeText:_t("CMSPUBS.LnkCloseUppCase"),position:{my:"center",at:"center",of:window},resize:function(){j.resized=!0,j.__resizeTabContents()}}),n.transferLanguageAttrs(i,g.parent()),n.transferLanguageAttrs(h,g.parent().children(".ui-dialog-titlebar")),n.transferLanguageAttrs(i,g),$(document).one("click.closeOnOverlayClick-scriptureDialog",".ui-widget-overlay",function(){j.close()}),g},__resizeVideoWrappers:function(){this.elem.find(".videoWrapper").each(function(){$(this).height("auto").height($(this).height())})},__resizeTabContents:function(){var a,b,c,d=parseInt(this.elem.css("max-height")),e=this.elem.find(".tabButtons").height(),f=0;if(this.__resizeVideoWrappers(),this.resized)return void this.elem.find(".scriptureDialogTabContainer").height(this.elem.height()-e);a=.9*$(window).height()-(this.elem.offset().top-$(window).scrollTop()),d-=e,a>d&&(a=d),c=this.elem.find('.scriptureDialogTab[data-name="'+this.currentTab+'"]'),c.length>0&&(f=c.get(0).scrollHeight),b=f>a?a:f,this.elem.find(".scriptureDialogTabContainer").height(b)},__addAlternateBibleLanguageInfo:function(){var a=b.getPageConfig("BIBLE_ALT_LANG_LOCALE"),c=b.getPageConfig("BIBLE_ALT_LANG_WT_LOCALE"),d=b.getPageConfig("BIBLE_ALT_LANG_DIR"),e=b.getPageConfig("BIBLE_ALT_LANG_SCRIPT");n.transferLanguageAttrs($("#article"),this.elem.find(".alternateLanguageName")),n.addLanguageAttrs(this.elem,a,"ml-"+c,d,e)},__buildAudioPlayer:function(a,b){var c=this;return b.buildAudioPlaylist().then(function(d){var e=b.getID();c.audioPlayers[e]=new l(d),c.audioPlayers[e].bind("play playing",function(){c.__showAudioPauseButton(a)}),c.audioPlayers[e].bind("ended pause remove",function(){c.__showAudioPlayButton(a)})})},updateTitle:function(){this.elem.dialog("option","title",this.__getTitle())},__getTitle:function(){var a;return a="gems"===this.currentTab?_t("CMSPUBS.HdgStudyNotesAndMedia"):"translations"===this.currentTab?_t("CMSPUBS.HdgParallelTranslations"):_t("CMSPUBS.HdgCitedScripture"),$("<textarea />").html(a).text()},__showAudioPlayButton:function(a,b){var c=a.parent(),d=c.children(".secondaryButton.play"),e=c.children(".secondaryButton.pause");d.show(),e.hide(),b&&d.focus()},__showAudioPauseButton:function(a,b){var c=a.parent(),d=c.children(".secondaryButton.play"),e=c.children(".secondaryButton.pause");e.show(),d.hide(),b&&e.focus()},__dialogVerticalOffset:function(){var a=$("#mobileNavTopBar:visible");return a.length>0?a.height():0},__removePlayers:function(){_.each(this.audioPlayers,function(a){a.remove()}),_.each(this.streamingVideo,function(a){a.remove()}),this.audioPlayers={},this.streamingVideo={}}}),a.closeAll=function(){$(".ui-dialog-content.scriptureDialog").dialog("close")},module.define("ScriptureDialog",a)}(),function(){"use strict";var a,b=module.require("signal"),c=module.require("ScriptureDialog"),d=module.require("StreamingController"),e=module.require("PubMediaResource");a=c.extend({TEMPLATE_NAME:"ScriptureAdditionalContentDialog",init:function(a,b,c){c=c||{},this._super(a,b,c),_.defaults(c,{additionalContent:null,additionalContentHeader:null}),this.additionalContent=c.additionalContent,this.additionalContentHeader=c.additionalContentHeader,this.showMedia=c.showMedia,this.videoPlayers={}},changeTab:function(){this.currentTab="scripture"},_buildStateContext:function(){var a=this._super();return a.additionalContent=this.additionalContent,a.additionalContentHeader=this.additionalContentHeader,a.hasAdditionalContent=!!this.additionalContent&&this.additionalContent.length>0,a},_injectHTML:function(a){var c=this;this._super(a),this.elem.on("click","a.jsMediaItemViewLink",function(a){b.send("ScriptureDialog:mediaSelected",{docID:$(this).data("docid"),chapter:$(this).data("chapter")}),a.preventDefault(),c.close()}),this.elem.find(".xrefLink, .footnoteLink").remove(),this.elem.find(".verseNum a, .chapterNum a").contents().unwrap()},__buildVideoPlayers:function(){var a=this;this.elem.find(".jsScriptureDialogRangeContent .jsVideoPlayer").each(function(){var b=$(this).find(".jsMediaPlayer");a._initVideo(b)})},_initVideo:function(a){var b,c=a.data("pubmediaurl"),f=a.data("posterurl"),g=a.data("id"),h=a.data("rangeid"),i=""+h+g;b=b||{},b.ignoreMarkers=!0,b.poster=f,this.videoPlayers[i]=new d(a,new e(c),b)},_removeAllVideoPlayers:function(){_.each(this.videoPlayers,function(a){a.remove()}),this.videoPlayers={}},close:function(){this._super(),this._removeAllVideoPlayers()}}),module.define("ScriptureAdditionalContentDialog",a)}(),function(){"use strict";var a,b,c=module.require("UIController"),d=module.require("SimpleModal"),e=module.require("FinderLink"),f=module.require("LanguageUtils");a={errorCorrectionLevel:"M",width:128,margin:0},b=c.extend({open:function(a){return this.element=$(a).closest(".shareButtonWrapper"),this._draw().then(this._updateTitleContainerLanguageClasses.bind(this))},_buildStateContext:function(){var b,c=this._buildShareLink();return b=QRCode.toString(c,a).then(function(a){var b,c,d=a.match(/<svg.*?>/i);return d&&(b=d.index+d[0].length,c="<title>"+_t("CMSPUBS.LblQRCode")+"</title>",a=a.slice(0,b-1)+' role="img">'+c+a.slice(b)),a}),{itemContextTitle:this._getModalData("contextTitle",!0),itemName:this._getFormattedTitle(),imageSource:this._getModalData("image"),itemLanguage:this._getPublicationLocalizedLanguage(),shareQR:b,shareURL:c,shareEmailURL:this._buildEmailLink()}},_getFormattedTitle:function(){var a=this.element.find(".synopsis h3 a").clone();return a.length?a.html():this.element.find(".title").html()},_getModalData:function(a,b){var c=this.element.find("."+a);return c=b?c.text():c.html(),c?c.trim():""},
_buildShareLink:function(){var a=this.element.find(".link").data();return _.isEmpty(a)?this._getModalData("link",!0):(a.srcid="share",e.create(a))},_buildEmailLink:function(){var a=encodeURIComponent(this._getModalData("emailSubject",!0)),b=encodeURIComponent(this._buildShareLink()),c="mailto:?";return a?(c+="body="+a+"%0a%0a"+b,c+="&subject="+a):this._getModalData("emailLink",!0)},_getPublicationLocalizedLanguage:function(){var a;return this.element.find(".language").data("use-default-language-name")?this._getModalData("language"):(a=$(".autoCompleteLanguageChoices").val(),a=a||this._getModalData("language"))},_injectHTML:function(a){var b=new d(a);this._super(a),b.open()},_renderTemplate:function(a){var b=$("#templates .template.shareModal").children().clone();return rivets.bind(b,a),this.__formalityPromise(b)},_updateTitleContainerLanguageClasses:function(){var a=this.html.find(".itemNameContainer"),b=this.html.find(".itemContextTitle"),c=this.element.find(".synopsis"),d=$("#article");c.length&&c.attr("lang")?f.transferLanguageAttrs(c,a):f.transferLanguageAttrs(d,a),f.transferLanguageAttrs(d,b)},canCopyToClipboard:function(){return!!navigator.clipboard},doCopy:function(a){var b=this.html.find(".copyToolTip");navigator.clipboard.writeText(a),b.addClass("showTooltip"),setTimeout(function(){b.removeClass("showTooltip")},2e3)},copyToClipboard:function(a,b){if(b.controller.canCopyToClipboard())return navigator.permissions?void navigator.permissions.query({name:"clipboard-write"}).then(function(a){"granted"!==a.state&&"prompt"!==a.state||b.controller.doCopy(b.state.shareURL)}).catch(function(a){a instanceof TypeError&&b.controller.doCopy(b.state.shareURL)}):void b.controller.doCopy(b.state.shareURL)}}),module.define("ShareModal",b)}(),function(){"use strict";var a,b=module.require("signal"),c=module.require("settings"),d=module.require("UIController"),e=module.require("LanguageUtils"),f=module.require("ArticleContentUtils");a=d.extend({TEMPLATE_NAME:"ExcerptDialog",elem:null,loading:null,dialogClass:"",init:function(a,b,c){this._super(),this.title=a,this.url=b,this.selectors=_.defaults(c||{},{header:"header h1",content:".docSubContent"})},close:function(){this.elem.dialog("close"),$(document).off("click.closeOnOverlayClick-excerptDialog")},load:function(){return this.loading||(this.loading=$.get(this.url)),this.loading},open:function(){this.elem=this.__buildDialog(),this._draw(),b.send("modalOrDialogOpened")},_buildStateContext:function(){var a=this.load(),b=this,c={};return c.excerpt=a.then(function(a){var c=_.reduce(b.selectors,function(b,c,d){return _.isFunction(c)?b[d]=c($(a)):b[d]=$(a).find(c).html(),b},{});return c.url=b.url,c}),c},_injectHTML:function(a){var b=this;this.elem.empty().append(a),this.elem.dialog("option","position",{my:"center",at:"center center+"+this.__dialogVerticalOffset()/2,of:window}),this.elem.on("click","a.jsBibleLink",function(){b.close()}),this.elem.find("a.jsBibleLink").each(function(){$(this).attr("target","_self")})},__buildDialog:function(){var a=c.getSetting("IS_MOBILE_LAYOUT"),b=a?300:400,d=.375*b,g=.9*$(window).height()-this.__dialogVerticalOffset(),h=.9*$(window).width(),i=$("<div><div class='loadingIndicator small'></div></div>"),j=this;return i.addClass("excerptDialog"),i.dialog({title:this.title,dialogClass:this.dialogClass||"",closeText:_t("CMSPUBS.LnkCloseUppCase"),maxHeight:g,maxWidth:h,width:b,minHeight:d,modal:a,open:function(){j.dialogClass&&$(".ui-widget-overlay").addClass(j.dialogClass)},position:{my:"center",at:"center",of:window}}),e.transferLanguageAttrs($("#article"),i.parent()),e.transferLanguageAttrs($("body"),i.parent().children(".ui-dialog-titlebar")),e.transferLanguageAttrs($("#article"),i),f.transferArticleClasses(i),$(document).one("click.closeOnOverlayClick-excerptDialog",".ui-widget-overlay",function(){j.close()}),i},__dialogVerticalOffset:function(){var a=$("#mobileNavTopBar:visible");return a.length>0?a.height():0}}),a.closeAll=function(){$(".ui-dialog-content.excerptDialog").dialog("close")},module.define("ExcerptDialog",a)}(),function(){"use strict";var a,b=module.require("settings");a=Class.extend({init:function(){this._cache={}},fetch:function(a){var b,c=this._getCached(a);return c||(b=this._getJWT().then(function(b){var c;return c={url:a,headers:{Authorization:"Bearer "+b.trim()}},$.ajax(c).then(function(a){var b={};return _.isObject(a)&&(b.alerts=_.isArray(a.alerts)?a.alerts:[],b.pagination=_.isObject(a.pagination)?a.pagination:{}),b})}),this._saveToCache(a,b),b)},_getJWT:function(){return $.get(b.getPageConfig("JWT_LOCATION"))},_getCached:function(a){return this._cache[a]},_saveToCache:function(a,b){this._cache[a]=b}}),module.define("AlertRetriever",a)}(),function(){"use strict";var a,b,c=module.require("LanguageUtils"),d=module.require("signal");b=[{name:"title",elem:"<h3>"},{name:"body",elem:"<p>"}],a=Class.extend({render:function(a,e){var f=$('<div class="alertItem">');return _.each(b,function(b){!_.has(a,b.name)||e&&!_.contains(e,b.name)||f.append($(b.elem).html(a[b.name])),"univ"===a.languageCode&&c.addLanguageAttrs(f,"E","ml-E","ltr","ROMAN")}),f.has("a").length>=1&&d.send("LinksAddedToElement",f),f}}),module.define("AlertRenderer",a)}(),function(){"use strict";var a,b=module.require("signal"),c=module.require("UIController"),d=module.require("SimpleModal"),e=module.require("DialogUtils"),f=module.require("AlertRetriever"),g=module.require("AlertRenderer"),h=new g;a=c.extend({TEMPLATE_NAME:"AlertsModal",init:function(a){this._super(),this.options=a||{}},openWithURL:function(a){var b=this;return this._draw().then(function(){return(new f).fetch(a)}).then(function(a){var c=a.alerts?a.alerts:[];b.renderAlerts(c)})},renderAlerts:function(a){var c=this.html.find(".standardModal-content");c.find(".loadingIndicator").remove(),_.each(a,function(a){c.append(h.render(a,["title","body"]))}),e.addSourceFlags(c,"alertsModalDialog"),b.send("DOMReady")},_buildStateContext:function(){return{title:this.options.title}},_injectHTML:function(a){var b=new d(a);this._super(a),b.open()}}),module.define("AlertsModal",a)}(),function(){"use strict";var a,b=module.require("UIController"),c=module.require("SimpleModal"),d=module.require("legalNotices"),e="userPref-appearance";a=b.extend({TEMPLATE_NAME:"AppearanceSettingsModal",open:function(){return this._draw()},_close:function(){c.close()},_injectHTML:function(a){var b=new c(a);this._super(a),d.listenForPrivacySettingsClick(a,this._close.bind(this)),b.open()},_buildStateContext:function(){return{selectedTheme:a.getSelectedTheme(),disabled:d.client.canPersistType(d.lib.CookieDataTypes.FUNCTIONAL).then(function(a){return!a}),themes:[{name:_t("CMSPUBS.LblSystemTheme"),value:a.THEME_SYSTEM},{name:_t("CMSPUBS.LblLightTheme"),value:a.THEME_LIGHT},{name:_t("CMSPUBS.LblDarkTheme"),value:a.THEME_DARK}]}},_setSelectedTheme:function(b){b=b||a.THEME_SYSTEM,this._addThemeClass(b),$.storedData(e,b)},_addThemeClass:function(b){$("body").removeClass(function(a,b){var c=new RegExp("\\b\\w*-theme--\\S+","g");return(b.match(c)||[]).join(" ")}),b!==a.THEME_SYSTEM&&($("body").addClass("cc-theme--"+b),$("body").addClass("mediaPlayer-theme--"+b))},onSelectThemeSetting:function(a,b){var c=$(a.target);b.controller._setSelectedTheme(c.data("theme")),b.controller._close()}}),a.THEME_LIGHT="light",a.THEME_DARK="dark",a.THEME_SYSTEM="system",a.getSelectedTheme=function(){function b(){return $.storedData(e)||a.THEME_SYSTEM}return d.callIfFunctionalAllowed(b,a.THEME_SYSTEM).then(function(a){return a.returnValue})},module.define("AppearanceSettingsModal",a)}(),function(){"use strict";var a,b=module.require("UIController"),c=module.require("SimpleModal"),d=module.require("legalNotices");a=b.extend({TEMPLATE_NAME:"FeatureDisabledModal",open:function(){return this._draw()},_close:function(){c.close()},_injectHTML:function(a){var b=new c(a);this._super(a),d.listenForPrivacySettingsClick(a,this._close.bind(this)),b.open()}}),module.define("FeatureDisabledModal",a)}(),function(){"use strict";var a=module.require("signal");$("body").hasClass("StudyBible")&&a.listen("DOMReady",function(){var a,b,c=$(".readingPane .jsViewportPin").not(".jsPinned");c.exists()&&(a=$("#article p.docNav"),b=a.find("a"),b.removeAttr("target").addClass("jsNoScroll"),c.exists()&&a.exists()&&(a.appendTo(c),c.addClass("jsPinned")))})}(),function(){"use strict";var a,b=module.require("signal"),c=module.require("url");a=function(a){var b=a.find("a");_.each(b,function(a){var b=$(a);c.isExternal(b.attr("href"))&&(b.attr("target","_blank"),b.attr("rel","noreferrer noopener"))})},b.listen("LinksAddedToElement",function(b){a(b)})}(),function(){"use strict";var a,b,c,d,e=module.require("signal");b=function(a){a.siblings(".current").removeClass("current"),a.addClass("current")},c=function(a){a.siblings(".current").removeClass("current").trigger("tab:deselected"),a.addClass("current").trigger("tab:selected")},a=function(a){var d=$(this),e=d.data("tab-target"),f=$(e);a.preventDefault(),c(f),b(d)},d=function(){var a=$(this),d=a.data("tab-target"),e=$(d);a.addClass("jsHasSelectedListener"),e.on("tab:select",_.partial(b,a)),e.on("tab:select",_.partial(c,e)),e.hasClass("current")&&(b(a),c(e))},e.listen("DOMReady",function(){$(".jsTab").not(".jsHasSelectedListener").each(d)}),$(document).on("click",".jsTab",a)}(),function(){"use strict";var a=module.require("ListViewSwitcher");module.require("signal").listen("DOMReady",function(){$(".jsSelectGridView").each(function(){var b,c,d=$(this);d.data("has-view-switcher")||(d.data("has-view-switcher",!0),b=d.parent().siblings().find(".jsSelectListView"),c=new a(d,b),c.start())})})}(),$(function(){"use strict";var a,b,c=$("select.jsAutoSelectLocation");a=function(){var a=navigator.userLanguage||navigator.language||navigator.browserLanguage||navigator.systemLanguage,b=!!a&&a.match(/([\w]+)\-([\w]+)/);return!b||b.length<2?"US":b[2].toUpperCase()}(),b=function(a,b){return a.filter("[data-iso2location~="+b+"]")},c.each(function(){var c,d=$(this).children();d.filter(":selected").val()||(c=b(d,a),c.exists()||"US"===a||(c=b(d,"US")),c.exists()&&(c.prop("selected",!0),$(this).trigger("change")))})}),function(){"use strict";var a,b,c="jsToolTipActive",d=module.require("signal");a=function(a,b){var e,f=!1,g=!0,h="click"===a.data("trigger"),i=h?"mouseleave":"mouseleave focusout";d.send("closeToolTips"),b.addClass(c),a.addClass(c),b.find("input:first").focus(),e=function(){f||g||(b.removeClass(c),a.removeClass(c))},d.listen("closeToolTips",e),b.on("mouseenter focusin",function(){f=!0}),a.on("mouseenter focusin",function(){g=!0}),b.on(i,function(){f=!1,h||setTimeout(e,500)}),a.on(i,function(){g=!1,h||setTimeout(e,500)}),$(document).on("click",e)},b=function(b){b.preventDefault();var c=$(this),d=c.find("~ .jsToolTip:first");a(c,d)},$(document).on("mouseenter focusin",'.jsToolTipTrigger[data-trigger!="click"]',b),$(document).on("click",'.jsToolTipTrigger[data-trigger="click"]',b)}(),function(){"use strict";var a,b=module.require("signal"),c=module.require("settings");a=function(){var a,b,d,e,f,g,h=$(this),i=!1;h.data("viewport-pin")||(f=h.data("pin-container")?$(h.data("pin-container")):window,h.data("viewport-pin",!0),h.wrap('<div class="jsViewportPinWrapper"></div>'),g=h.parent(),h.children(".jsAudioPlayer:not(.jsPlayerLoaded)").length>0?g.on("StreamingController:on:ready",function(){g.addClass("jsContainsStreamingAudio")}):h.children(".jsAudioPlayer.jsPlayerLoaded").length>0&&g.addClass("jsContainsStreamingAudio"),a=function(){var a,b,d,e=c.getSetting("IS_SMALL_LAYOUT");a=h.children(".excludePin:not(.jsAlwaysIncludeForPinHeight)"),b=_.reduce(a,function(a,b){return a+$(b).outerHeight(!0)},0),d=g.height()-b,g.height(d),h.width(e?"":g.width()),h.addClass("pinned"),h.removeClass("unpinned"),i=!0,h.find(".jsPinListener").trigger("pinned")},b=function(){h.removeClass("pinned"),i=!1,h.addClass("unpinned"),h.find(".jsPinListener").trigger("unpinned")},d=function(){var c=h.children(":not(.error):visible:not(.excludePin)"),d=$(f).scrollTop(),e=g.offset().top,j=e>=d&&i,k=e<d&&!i;c.exists()?j?b():k&&a():i&&b()},$(f).on("scroll",d),d(),e=function(){i&&a(),d()},$(window).on("resize",_.throttle(e,100)),h.on("class:add:excludePin",e),h.on("class:remove:excludePin",e),h.on("animationend",function(a){"animateUnpin"!==a.originalEvent.animationName||i||(g.height(""),h.width(""),h.removeClass("unpinned"))}))},b.listen("DOMReady",function(){$(".jsViewportPin").each(a)})}(),function(){"use strict";var a,b=module.require("signal");a=function(){$("body").removeClass("noJS").addClass("yesJS")},b.listen("DOMReady",function(){a(),$(".hideObj, .showObj, .jsHide").each(function(){var a=$(this);!function(){var b=a.css("display");a.css("display",b),a.removeClass("hideObj").removeClass("showObj").removeClass("jsHide")}()})})}(),function(){"use strict";var a,b,c,d,e,f,g,h=module.require("legalNotices"),i=module.require("url"),j=module.require("signal");a=function(a,b){return"userPref-accordion-"+a+"-"+b},b=function(b){return b.data("persistent-key")?b.data("persistent-key"):a($("body").attr("id"),b.attr("id"))},c=function(a){e(a,"collapseaction")},d=function(a){e(a,"expandaction")},e=function(a,b){a.preventDefault();var c=$(this),d=c.data("scope"),e=".jsExpandCollapse";d&&(e=d+" "+e),$(e).each(function(){var a=$(this),c=a.data(b);a.hasClass(c)&&$(a).click()})},g=function(a){return a.data("handle-root")?a.closest(a.data("handle-root")):a},f=function(a,c){var d=g(a),e=a.data("collapsable-block"),f=!0===a.data("find-all"),i=e||".jsCollapsableBlock:first",j=d.nextAll(i),k=a.data("expandaction"),l=a.data("collapseaction"),m=a.hasClass(l),n=m?l:k,o=m?k:l,p=m?"slideUp":"slideDown",q=b(a);j.length||(j=d.find(i)),j.length&&!f||!e||(j=$(i)),c=_.isNumber(c)?c:200,j[p](c),a.removeClass(n).addClass(o),a.attr("aria-expanded",m?"false":"true"),q&&h.callIfFunctionalAllowed(function(){$.storedData(q,o)})},$(document).on("click",".jsExpandAll",d).on("click",".jsCollapseAll",c),$(document).on("click",".jsExpandCollapse",function(a){a.preventDefault(),f($(this))}),h.callIfFunctionalAllowed(function(){var b,c=decodeURI(window.location.href),d=i.parse(c).hash.query;if(d.accordion)for(b in d.accordion)d.accordion.hasOwnProperty(b)&&d.accordion[b]&&$.storedData(a($("body").attr("id"),b),d.accordion[b])}),j.listen("DOMReady",function(){h.canPersistFunctional().then(function(a){$(".jsExpandCollapse:not(.jsExpandCollapseInitialized)").each(function(c,d){var e,h,i,j=$(d),k=g(j),l=a?$.storedData(b(j)):void 0;j.addClass("jsExpandCollapseInitialized"),e=j.hasClass("jsDefaultCollapsed")&&!j.hasClass(j.data("expandaction")),i=1===k.siblings("#accordionHeader.jsDefaultExpand").length&&(!l||j.hasClass("jsDisableSavedStates")),(e||i)&&f(j,0),(h=a&&l&&!j.hasClass("jsDisableSavedStates")&&!j.hasClass(l))&&f(j,0)})})})}(),function(){"use strict";function a(a){var c=a.originalEvent&&a.originalEvent.state;if(c)return!t.length&&f&&f.isReady()?void b(c):void t.push(c)}function b(a){t.length||t.push(!1),f.restoreNavigationState(a)}function c(){var a=t.pop();f&&a&&(t=[],b(a))}function d(){f.studyPane.showView("default"),g.send("CloseAllModals")}function e(a,b,c){var d;a=a||f.bookID,b=b||f.chapterID,(d=f.getBook(a))&&s.open().then(function(){return f.fetchMultimedia(a)}).then(function(e){var h,i,s,t,u,v=0;u=_.map(e,function(a){return new j(a)}),h={image:function(a){var b=new p;return b.url=a.resource.zoom||a.resource.src,b.zoomSrc=b.url,b},video:function(a){var b=new q;return b.jsonurl=a.resource.src[0],b.posterImage=_.isObject(a.keyframe)?a.keyframe.zoom||a.keyframe.src:void 0,b}},i=_.chain(u).pluck("verses").flatten().filter(function(a){return a.book===d.id}).pluck("chapter").unique().sortBy(function(a){return parseInt(a)}).map(function(a){var b=j.multimediaForChapter({id:a,bookID:d.id},u);return _.map(b,function(b){return _.extend({},b,{groupName:d.abbr+" "+a,groupID:a})})}).flatten().map(function(a){if(_.has(h,a.type)){var b=h[a.type](a),c=$("<div></div>"),d=$("<h4></h4>"),e=$(a.pictureCredit);return c.append(a.caption),e.addClass("imgCredit"),c.append(e),d.html(_t("CMSPUBS.HdgRelatedScriptures")),c.append(d),_.each(a.sourceStandardCitations,function(b,d){var e=$("<a></a>");e.addClass("jsBibleLink"),e.attr("data-bible",n.getPageConfig("PREFERRED_BIBLE")),e.attr("data-targetverses",b.vs),e.html(b.abbreviatedCitation),c.append(e),d<a.sourceStandardCitations.length-1&&c.append(_t("CMSNUMBERS.BibleMultiCitationSeparator")+" ")}),b.thumburl=a.thumbnail.src,b.title=a.label,b.caption=c.html(),b.groupName=a.groupName,b.hasCaptionAudio=a.hasCaptionAudio.bind(a),b.buildCaptionAudioPlaylist=a.buildCaptionAudioPlaylist.bind(a),b.docID=a.docID,b.groupID=a.groupID,b}return null}).filter(_.identity).map(function(a,d){return a.index=d,a.docID===c&&a.groupID===parseInt(b)&&(v=d),a}).value(),s=new o(i),s.isGrouped=!0,t=new r(s),t.on("slide:rendered",function(){g.send("DOMReady")}),t.open(),g.listen("ScriptureDialog:mediaSelected",function(a){s.setCurrentSlide({docID:a.docID,groupID:a.chapter}),t.showBackButton=!0}),s.on("currentIndex:update",function(){var b=s.slides[s.currentIndex],c=l.HASH_URL_FORMAT.format(a),d=k.createMediaItemHash(a,b.groupID,b.docID);-1!==m.getCurrentHashValue().indexOf(c)&&f.updateURL({urlString:f.bibleData.url,hash:d,preserveHash:!1,state:f.bibleJumper.getState()}),t.showBackButton=!1}),s.setCurrentIndex(v)}).then(s.close)}var f,g=module.require("signal"),h=module.require("StudyBible"),i=module.require("Bible"),j=module.require("BibleMultimedia"),k=module.require("MediaPage"),l=module.require("BookMediaPage"),m=module.get("Navigation"),n=module.require("settings"),o=module.require("GalleryCollection"),p=module.require("GalleryImage"),q=module.require("GalleryVideo"),r=module.require("MediaGalleryModal"),s=module.require("loadingIndicator"),t=[];$(document).ready(function(){var a=$("article"),b=a.data("booknum"),d=a.data("chapter"),e=a.data("bible-pub"),g=a.data("bookname");e===i.PUB_SYMBOLS.NWTSTY&&(s.open(),f=new h(e,g,b,d),f.open().then(c).then(s.close))}),g.listen(h.EVENTS.CHANGE_CHAPTER_SIGNAL,function(a){if((!a.book||a.book.isPlaceholder)&&!a.chapter)return d(),void s.open().then(function(){f.goHome().then(c).then(s.close)});a.chapter&&(d(),s.open().then(function(){f.openChapter(a.book,a.chapter,a.verseRange).then(c).then(s.close)}))}),g.listen(h.EVENTS.CHANGE_PAGE_SIGNAL,function(a){a.page&&a.page.url&&(d(),s.open().then(function(){var b;return b=a.page.pageID===k.PAGE_ID?f.showMediaPage(a.page):a.page.pageID&&0===a.page.pageID.indexOf(k.PAGE_ID)?f.showMediaPage(a.page,{bookID:a.page.bibleBookID}):f.loadPage(a.page.url,a.hashLocation),b.then(c).then(s.close)}))}),g.listen(h.EVENTS.CHANGE_BOOK_SIGNAL,function(a){a.book&&f.setSelectedBook(a.book)}),g.listen("DOMReady",function(){f&&f.formatBibleVerseLinks()}),g.listen(h.EVENTS.NO_CHANGE_SIGNAL,function(){c(),f&&(f.notifyHistoryNavigationStopped(),f.onHashChange())}),$(window).on("popstate",a),g.listen("DOMReady",function(){$(document).off("click","div.jsGalleryToggle img, div.jsGalleryToggle a").on("click","div.jsGalleryToggle img, div.jsGalleryToggle a",function(a){var b=$(this).closest("div.jsGalleryToggle"),c=b.data("bookid"),d=b.data("chapterid"),f=b.data("docid");a.preventDefault(),e(c,d,f)})}),g.listen("MediaGallery:ShowItem",function(a){e(parseInt(a.bookID),parseInt(a.chapterID),a.docID)})}(),$(function(){"use strict";var a,b,c,d,e,f=module.require("ScriptureDialog"),g=module.require("ScriptureAdditionalContentDialog"),h=module.require("ExcerptDialog"),i=module.require("LanguageUtils"),j=module.require("ArticleContentUtils"),k=module.require("signal");a=function(a){var b,c=a.split("#"),d=$.Deferred();return 2!==c.length?(d.reject(),d):(b=c.pop(),c=c.pop(),$.getCached(c,"html",!0).done(function(c){c=$(c);var e=$("<div></div>"),f=$("<a></a>").attr("href",a),g=$('<ul class="dl"></ul>'),h=$("<li></li>");e.addClass("ftnGlossaryTerm"),e.append("<h2>"+_t("CMSPUBS.HdgGlossaryTerm")+"</h2>"),h.append(c.find("#"+b).contents()),g.append(h),e.append(g),e.find("h3").has(".dt").wrapInner(f),e.find('a[target="_blank"]').removeAttr("target"),d.resolve(e)}),d)},b=function(){var a,b,c,d=$(this);d.addClass("jsHasModalListener"),c=function(){return d.data("available-bible-books")||_.range(1,67)},a=d.data("targetverses"),b=d.parent().hasClass("citationWithMedia")||d.data("add-content")?new g(a,d.data("bible"),{requestedBible:d.data("requested-bible"),bibleTextAPIBase:d.data("bible-text-api-base"),additionalContent:d.data("add-content"),additionalContentHeader:d.data("add-content-header"),showMedia:d.parent().hasClass("citationWithMedia"),availableBibleBooks:c}):new f(a,d.data("bible"),{availableBibleBooks:c,requestedBible:d.data("requested-bible"),bibleTextAPIBase:d.data("bible-text-api-base")}),d.on("click",function(a){$(a.currentTarget).hasClass("jsNoDialog")||(a.preventDefault(),b.isOpen||(b.dialogClass=$(this).data("dialogsource"),b.open()))})},c=function(){var b,c,d,e,f=$(this),g=$("<div></div>"),h=f.attr("href");f.addClass("jsHasModalListener"),f.hasClass("footnoteLink")?(c=_t("CMSPUBS.HdgFootnote"),d='a[href*="footnotesource"]',e="footnoteList"):f.hasClass("gen-footnote-link")?(c=_t("CMSPUBS.HdgFootnote"),e="footnoteList"):f.hasClass("endnoteLink")?(c=_t("CMSPUBS.HdgEndnote"),d='a[href*="endnotesource"]',e="endnoteList"):f.hasClass("jsVerselessPartialCommentary")&&(c=_t("CMSPUBS.HdgStudyNote"),g.append($('<div class="content"></div>').html(f.data("add-content")))),h&&(b=h.replace(/.*#/,""),g.append($("#"+b).clone())),g.attr("title",c),g.find(d).hide(),g.addClass(e),g.addClass("footnoteDialog"),g.find(".jsGlossaryLink").each(function(){var b=$(this),c=b.attr("href");a(c).done(function(a){g.append(a),b.replaceWith(b.contents())})}),f.on("click",function(a){var b=f.data("dialogsource");$(a.currentTarget).hasClass("jsNoDialog")||(a.preventDefault(),g.dialog({dialogClass:b,open:function(){$(".ui-widget-overlay").addClass(b),k.send("modalOrDialogOpened")},closeText:_t("CMSPUBS.LnkCloseUppCase")}),i.transferLanguageAttrs($("#article"),g.parent()),i.transferLanguageAttrs($("body"),g.parent().children(".ui-dialog-titlebar")),i.transferLanguageAttrs($("#article"),g),j.transferArticleClasses(g),g.parent().find(":button").first().focus())})},d=function(){var a,b=$(this);b.addClass("jsHasModalListener"),a=new h(b.data("title"),b.attr("href")),b.on("click",function(b){$(b.currentTarget).hasClass("jsNoDialog")||(b.preventDefault(),a.isOpen||(a.dialogClass=$(this).data("dialogsource"),a.open()))})},e=function(){var a=$("body.docClass-115 .jsBibleLink, body.BibleReadingPage #bibleChOutlineContainer .jsBibleLink");a.each(function(){$(this).removeAttr("target")}),$(".jsBibleLink").not(".jsNoDialog").not(".jsHasModalListener").not(a).each(b),$(".jsVerselessPartialCommentary").not(".jsNoDialog").not(".jsHasModalListener").each(c),$(".footnoteLink, .gen-footnote-link").not(".jsNoDialog").not(".jsHasModalListener").each(c),$(".endnoteLink").not(".jsNoDialog").not(".jsHasModalListener").each(c),$(".jsDialogContentLink").not(".jsNoDialog").not(".jsHasModalListener").each(d),$(".jsBibleLink, .footnoteLink, .gen-footnote-link, .endnoteLink").not(a).addClass("jsNoScroll")},e(),k.listen("DOMReady",e),k.listen("CloseAllModals",function(){$(".ui-dialog-content.footnoteDialog").dialog("close")})}),function(){"use strict";function a(a){return _.times(10,function(b){return'#article *[id^="'+a+b+'"]'}).join(", ")}var b,c,d=module.require("signal"),e=module.require("ContextMenu");b=function(){function a(a){var b=d.indexOf(a);d.splice(b,1),a.close()}function b(){_.each(d,a)}function c(b){var c,f;return _.each(d,a),c=new e(b,$("body")),f=c.open(),f&&d.push(c),f}var d=[];return $(window).hammer().on("click resize",b),{open:c,close:a,closeAll:b}}(),c=["#article .verse","#article *[data-pid]",a("p"),a("q")].join(", "),d.listen("DOMReady",function(){$(c).addClass("disableActiveState")}),$(document).on("click",c,function(a){var e=$(a.target),f=e.is(c)?e:e.closest(c);f.find(c).length>0||e.is("a")||e.closest("a").length>0||(b.open(f)&&a.stopPropagation(),d.send("ContentSelected",f))})}(),function(){"use strict";function a(a){var b,c,d,e,f,g,h,i,j,k=function(a){return $("*[id='%s'], *[class~='%s']".format(a,a))};if(a=a.split("-"),b=a.filter(function(a){return/^[pv]([0-9]+)$/.test(a)&&k(a).exists()}),b.length){if(1===b.length)c=k(b[0]);else for(d=b[0],e=b[1],f=parseInt(d.match(/\d+/)),g=parseInt(e.match(/\d+/)),i=d,c=k(d),h=f;h<g;h++)j=i.replace(h.toString(),(h+1).toString()),c=c.add(k(j)),i=j;return c}}var b=module.require("url"),c=module.require("signal"),d=/p\d+/;c.listen("DOMReady",function(){$("a[data-highlightrange]").each(function(){var a,c;a=$(this).data("highlightrange"),c=b.parse($(this).attr("href")),c.hash.path=a,c=b.build(c),$(this).attr("href",c)}),$("*[id^='p']").each(function(){var a=$(this),b=a.attr("id");b.match(d)&&a.addClass(b)})}),module.get("AnchorLinkController").addTargetResolver(function(b){function e(){var a,b;return a=$(".verse"),b=$("#article *[class^=p]").not("#bibleChOutlineContainer *").filter(function(){return this.className.match(d)}),a.add(b)}var f,g=a(b);if(g)return f=e(),g.length<f.length&&c.send("LinkedContentFound",g),c.listen("PageLoaded",function(){g=a(b),f=e(),g&&g.length<f.length&&c.send("LinkedContentFound",g)}),g.filter(":first")})}(),function(){"use strict";function a(a){if(h===a||a.el.hasClass(l))return void(h=a);b(),h=a,a.el.addClass(l)}function b(){h&&(h.el.removeClass(l),h=void 0)}function c(){g&&a(g)}function d(){return h&&h.type===f.SELECTED_CONTENT}function e(a){return i&&i.type===f.MARKER&&i.player===a}var f,g,h,i,j=module.require("signal"),k=module.require("settings"),l=k.getSetting("TEXT_HIGHLIGHT_CLASS"),m="."+l;f={SELECTED_CONTENT:"SELECTED_CONTENT",LINKED_CONTENT:"LINKED_CONTENT",MARKER:"MARKER"},j.listen("LinkedContentFound",function(b){g={type:f.LINKED_CONTENT,el:b},a(g)}),j.listen("ContentSelected",function(b){a({type:f.SELECTED_CONTENT,el:b})}),j.listen("MarkerStarted",function(b){i={type:f.MARKER,el:b.el,player:b.player},!d()&&b.player.isPlaying()&&a(i)}),j.listen("MarkerEnded",function(a){i&&a.player===i.player&&(i=void 0,c())}),j.listen("MediaPlayerPaused",function(a){e(a.player)&&!d()&&(b(),c())}),j.listen("MediaPlayerItemEnded",function(a){e(a.player)&&!d()&&(i=void 0,c())}),j.listen("MediaPlayerPlaying",function(b){i&&e(b.player)&&!d()&&a(i)}),j.listen("StreamingControllerDestroyed",function(a){var c=a.getPlayer();c&&(e(c)&&(i=void 0),h&&h.player===c&&b())}),$(document).on("click",function(d){var e,j,k=$(d.target);(e=1===k.closest("#content").length&&0===k.closest(m+", .video-js").length)&&(h&&h.type===f.LINKED_CONTENT&&(g=void 0),(j=h?h.type:void 0)&&(b(),j===f.SELECTED_CONTENT&&i?a(i):j!==f.SELECTED_CONTENT&&j!==f.MARKER||c()))})}(),$(function(){"use strict";var a,b=module.require("ChildWindow");a=function(a){a.preventDefault();var c,d;d={resizable:!!$(this).data("resizable")||null,scrollbars:!!$(this).data("scroll")||null,width:$(this).data("width")||null,height:$(this).data("height")||null,menubar:!!$(this).data("menubar")||null,toolbar:!!$(this).data("toolbar")||null,location:!!$(this).data("location")||null},c=new b,c.setURL($(this).attr("href")),c.setOptions(d),c.open()},$(document).on("click","a.jsPopup",a)}),$(function(){"use strict";$(document).on("click",".jsPrint",function(a){a.preventDefault(),window.print()})}),function(){"use strict";$(document).on("focus",".jsSkipToContentLink",function(){var a=$(this);a.css({position:"fixed",left:"20px",top:-(a.outerHeight()+5)+"px"}),a.animate({top:0},500)}),$(document).on("focusout",".jsSkipToContentLink",function(){var a=$(this);a.animate({top:-(a.outerHeight()+5)+"px"},500)})}(),function(){"use strict";var a,b,c,d,e,f=module.require("settings"),g=module.get("Navigation"),h=module.require("legalNotices"),i=module.require("signal");a=function(a){a.preventDefault();var b=$(this).children("option:selected"),c=b.data("url"),d=b.data("locale"),e=["#article","#pageConfig","#articleTopRelatedImage"];if("null"===c||""===c)return!1;d&&h.callIfFunctionalAllowed(function(){$.storedData("userPref-otherContentLang",d)}),window.ClientComponents.insight.makeEvent("contentLanguageChange").addParams({from:f.getPageConfig("WT_LANG"),to:b.data("langCode")}).send(),i.send("CloseAllModals"),g.swapContent(c,e).done()},b=function(a){a.preventDefault();var b=$(this),c=b.children(":selected").data("url"),d=b.data("contentswap");if(d&&(d=d.split(","),d=d.length?d:["#regionPrimaryNav","#regionMain","title"],c&&c!==window.location.href)){if(!(window.history&&"pushState"in window.history))return void(window.location.href=c);history.pushState("","",c),g.swapContent(c,d)}},c=function(){var a=$("#otherAvailLangsChooser"),b=$.storedData("userPref-otherContentLang"),c=d(b),e=f.getPageConfig("CONTENT_LANG"),g=!1,h=$("#otherLangRibbon");b&&c&&(a.find("option").each(function(a,c){var d=$(c).data("locale");!1===g&&d&&d===b&&(g=$(c))}),g&&e!==b&&(h.html(h.html().split("%%").join(c)),$(".jsYes",h).click(function(b){b.preventDefault();var c=a.data("autocomplete");c.selectOption(c.options.indexOf(g.val())),h.fadeOut()}),$(".jsNo",h).click(function(a){a.preventDefault(),$.removeStoredData("userPref-otherContentLang"),h.fadeOut()}),h.fadeIn()))},d=function(a){var b=$("#otherAvailLangsChooser"),c=b.find('[data-locale="%s"]'.format(a));return!!c&&c.html()},e=function(a){var b=$(a.target),c=b.data("autocomplete"),d=f.getPageConfig("CONTENT_LANG");c&&(b.val(d),c.selectOption(c.options.indexOf(d)))},$(document).on("change",".jsReplaceContent",b),$(document).on("change","#otherAvailLangsChooser",a),$(document).on("autocompleteAdded","#otherAvailLangsChooser",e),h.callIfFunctionalAllowed(c)}(),$(function(){"use strict";function a(a){$(".mobileNavLink.current").removeClass("current"),$(a).addClass("current")}var b,c,d,e,f=50,g=module.require("signal"),h=module.require("LanguagePicker"),i=$("#mobileNavTopBar .mobileMenu"),j=$("#mobileNavShelf .closePanel"),k=$("#mobileNavTopBar .mobileLang"),l=$("#mobileLangShelf .closePanel"),m=$("#mobileNav .jsExpandNav"),n=$("#mobileTOCHandle"),o=$("#mobileStudyPaneHandle"),p=$("#mobileNav, #mobileNavShelf"),q=$("#mobileLang, #mobileLangShelf"),r=$("#mobileTOC"),s=$("#mobileStudyPane"),t=[];$(document).on("change","select.jsSubmitOnChange",function(a){a.preventDefault(),$(this.form).submit()}),$(document).on("click",".jsChooseSiteLanguage, .jsChooseSignLanguage",function(a){var b=$(this),c=new h;a.preventDefault(),c.forceOnlySL=b.hasClass("jsChooseSignLanguage"),c.noBranding=b.hasClass("jsNoBranding"),c.open()}),c=function(){var a=$("#mobileUnderlay");return a.exists()||(a=$("<div></div>"),a.attr("id","mobileUnderlay"),$("body").append(a),$("#regionMain").height(screen.height-50)),a},d=function(){var a=$("#mobileUnderlay");a.exists()&&(a.remove(),$("#regionMain").height(""))},b=function(a,b,e){function h(){var a=Math.max(document.documentElement.clientWidth,window.innerWidth||0);e.width(a-f)}var i,j=!1,k={events:$({})};return i=_.throttle(h,50),$(window).resize(i),k.isOpen=!1,k.animationProperty=function(){var a=e.hasClass("leftPanel");return a=$("body").hasClass("dir-rtl")?!a:a,a?"left":"right"}(),k.trigger=function(a){this.events.trigger(a,this)},k.animate=function(a,b,c){var d={};d[this.animationProperty]=b,_.defer(function(){a.stop().animate(d,c)})},k.open=function(){_.each(t,function(a){a.close()}),this.isOpen||(c().click(this.close.bind(this)),a.addClass("open"),e.show(),this.animate(e,0,function(){a.attr("aria-expanded","true")}),this.isOpen=!0,h(),this.trigger("open"),g.send("mediaPause")),j||(j=!0,this.trigger("first-open"))},k.close=function(){d(),this.isOpen&&(a.removeClass("open"),this.animate(e,"-100%",function(){$(this).hide(),a.attr("aria-expanded","false"),a.focus()}),this.isOpen=!1,this.trigger("close"))},k.toggle=function(){this.isOpen?this.close():this.open()},a.click(k.toggle.bind(k)),b&&b.click(k.close.bind(k)),e.find(".mobileNavLink a").click(k.close.bind(k)),e.on("panel:toggle",k.toggle.bind(k)),e.on("panel:open",k.open.bind(k)),e.on("panel:close",k.close.bind(k)),
t.push(k),k},b(i,j,p),b(k,l,q).events.on("first-open",function(){var a=new h;a.noBranding=k.hasClass("jsNoBranding"),a.open(function(){$("#mobileLang").html(a.content),$("#mobileLangShelf").append(a.container.find("p.jsLanguageCount"))}).then(function(){q.show()})}),e=function(a,c){function d(){f.isOpen&&a.css(f.animationProperty,c.width())}var e,f=b(a,null,c);return f.events.on("open",function(b,d){var e=c.width();c.show(),d.animate(a,e)}).on("close",function(b,d){d.animate(a,0,function(){c.hide()})}),e=_.throttle(d,50),$(window).on("resize",e),f},e(o,s),e(n,r),$("#mobileNav .jsCollapsableBlock").hide(),m.click(function(){var a,b="expanded",c=$(this),d=c.parents(".mobileNavLink"),e=d.next(".jsCollapsableBlock");d.hasClass(b)?(d.removeClass(b),e.stop().slideUp(function(){c.attr("aria-expanded","false"),c.focus()}),e.removeClass(b)):(a=$(".mobileNavLink."+b),a.removeClass(b),a.next(".jsCollapsableBlock").slideUp(function(){a.children(".jsExpandNav").attr("aria-expanded","false")}),a.next(".jsCollapsableBlock").removeClass(b),d.addClass(b),e.stop().slideDown(function(){c.attr("aria-expanded","true")}),e.addClass(b))}),m.filter(".jsPreExpand").click(),g.listen("cmmRouteChanged",function(b){a("VODStudio"===(b&&b.categoryKey)?".jsVODStudioLink":".mobileNavLink.VideosPage:not(.jsVODStudioLink)")})}),function(){"use strict";var a,b,c,d=module.require("signal"),e=module.require("browser"),f=module.require("PubMediaResource"),g=module.require("DownloadModal"),h=module.require("BibleModal"),i=module.require("TourBrochureModal"),j=module.require("VideoModal"),k=module.require("VideoBibleModal"),l=module.require("configureDownloadModal");e.supportsTemplating()&&(a=function(a){var b,d,e,g,h=$("body"),i=$(this),j=i.data("jsonurl"),l=i.data("page-id");if(!h.hasClass("signLanguage")||h.hasClass("publications")||!i.hasClass("jsVideoModal")||!i.hasClass("jsCoverDoc")){if(a.preventDefault(),g=i.data("preselect"),i.hasClass("jsVideoBible"))return d=i.data("books"),e=new k(d,j),void e.open();b=new f(j),b.setPageID(l),c(b,i,g)}},b=function(){var a=$(this),b=a.data("jsonurl");$.getJSONCached(b).done(function(b){0===b.files.length&&a.remove()}).fail(function(){a.remove()})},c=function(a,b,c){var d;d=b.hasClass("jsTourBrochureDownload")?new i(a):b.hasClass("jsBible")?new h(a,{preselect:c,ignoreMarkers:!0}):b.hasClass("jsVideoModal")?new j(a,{preselect:c}):new g(a,{preselect:c,ignoreMarkers:!0}),l(d,b),d.open()},$(document).on("click",".jsDownload:not(.disabled)",a),$(document).on("click",".jsTourBrochureDownload:not(.disabled)",a),d.listen("DOMReady",function(){$(".jsTourBrochureDownload:not(.disabled)").each(b)}))}(),function(){"use strict";var a,b=module.require("PubMediaResource"),c=module.require("VideoModal"),d=module.require("VideoBibleModal"),e=module.require("signal");a=function(){var a,e,f,g=$(this),h=g.data("page-id"),i=g.data("style"),j=$("body").hasClass("jsBibleModal"),k=g.data("jsonurl"),l=!!g.parents(".slContent").length;j?(f=g.data("books"),e=new d(f,k)):(a=new b(k),a.setPageID(h),e=new c(a,{extraClasses:["embeddedVideo","jsEmbedded",i],poster:g.data("poster"),isEmbedded:!0,highlighterTarget:l?".slContentText":null})),e.open(function(a){a=$(a),g.replaceWith(a)})},e.listen("DOMReady",function(){$(".jsIncludeVideo").not(".jsHasVideo").addClass("jsHasVideo").each(a)})}(),function(){"use strict";var a,b,c=module.require("signal"),d=module.require("settings"),e=module.require("url");b=function(a){var b=d.getPageConfig("WT_LANG"),c=e.parse(d.getPageConfig("PUBMEDIA_URL"));return c.query.langwritten=b,c.query.txtCMSLang=b,c.query.alllangs=1,c.query.output="json",c.query.fileformat=d.getSetting("VIDEO_FORMATS"),e.build(c)+"&"+a},a=function(a){var c,e,f,g=a.attr("data-video"),h='a[data-video="webpubvid"] img',i=h.replace("webpubvid",g);c=1===$(i).length,e=g.split("webpubvid://?")[1],f=b(e),a.attr("data-jsonurl",f),a.addClass("jsLinkedVideo"),c?a.attr("data-poster",$(i).first().attr("src")):a.attr("data-poster",d.getSetting("VIDEO_BLANK_POSTER"))},c.listen("DOMReady",function(){_.each($("a[data-video]"),function(b){a($(b))})})}(),$(function(){"use strict";var a,b=module.require("PubMediaResource"),c=module.require("DownloadModal"),d=module.require("BibleModal"),e=module.require("VideoModal"),f=module.require("settings"),g=module.require("StringUtils");a=function(a,b){var h;a.listFileTypes().then(function(i){var j,k=f.getSetting("VIDEO_FORMATS").split(",");j=_.reduce(i,function(a,b){return _.contains(k,b.name)||a},!1),h=$("body").hasClass("jsBibleModal")?new d(a):j?new e(a,{extraClasses:["embeddedVideo","jsEmbedded"],poster:b.data("poster"),isEmbedded:!0}):new c(a),h.setCoverImage($(".cvr img").attr("src")),a.getPubName().then(function(a){var b=g.removeHTMLEntities(a);document.title=b}),h.open(function(a){var c=$("<div>").addClass("standardModal-flexWrapper");c.append(a),b.replaceWith(c),c.find(".jsLanguageTab:first").click()})})},$(".jsIncludeDownloadModal").each(function(){var c=$(this),d=new b(c.data("jsonurl"));a(d,c)})}),function(){"use strict";var a,b,c,d=module.require("signal"),e=module.require("StringUtils");a=function(a){a.preventDefault();var c=$(this);$(".jsPublicationFilterContainer").length>1&&b(c)},b=function(a){var b,e,f=a.closest("form"),g=$(f).attr("action")+"json/filters/",h=$(f).serialize();e=$(a).parents(".jsPublicationFilterContainer").nextAll(".jsPublicationFilterContainer").find(".jsPublicationFilter"),e.each(function(){var e=$(this).data("filtertype");e&&(b=g+e+"/?"+h,$.getJSONCached(b).done(function(b){var e=$("#"+b.id);c(e,b.choices),d.send("PublicationFilter:Refreshed",a)}))})},c=function(a,b){a=$(a);var c,d,f,g,h=0,i=a.children(":selected").val();if(a.children().remove(),0===b.length)return a.closest(".jsPublicationFilterContainer").hide(),0;for(a.closest(".jsPublicationFilterContainer").show(),f=0;f<b.length;f++)d=b[f],c=$(document.createElement("option")),c.val(d.optionValue),c.html(e.stripRubyText(d.optionName)),c.attr("data-alternative-spellings",d.altSpellings),c.attr("lang",d.optionLang),c.attr("xml:lang",d.optionLang),c.attr("dir",d.optionLangDir),c.addClass(d.optionClasses),c.val()===i&&(h=f,c.prop("selected",!0)),a.append(c);return g=a.data("autocomplete"),g&&(g.clearOptionCache(),g.loadOptions()),h},$(document).on("change",".jsPublicationFilter",a)}(),$(function(){"use strict";var a=module.require("settings"),b=module.require("url");module.require("browser").supportsTemplating()&&$(".jsDownload:not(.jsVideoModal.jsCoverDoc)").each(function(){var c=$(this),d=c.attr("href"),e=c.hasClass("jsBible")||c.hasClass("jsVideoBible"),f=decodeURIComponent(b.parse(d).query.fileformat);if(c.closest(".fwpContent .boxSupplement").length&&f.split(",").length<2)return void c.removeClass("jsDownload");d=d.split("?")[1],d+="&isBible="+(e?1:0),d=a.getSetting("DOWNLOAD_WINDOW_URL")+"?"+d,c.attr("href",d)})}),function(){"use strict";var a,b;a=function(){var a=$(this),b=a.parents(".filterOptions").has(".filterSubOptions").children('input[type="checkbox"]'),c=b.parents(".filterOptions").find('.filterSubOptions input[type="checkbox"]'),d=c.filter(":checked").length===c.length;b.prop("checked",d)},b=function(){var a=$(this);a.parents(".filterOptions").find('.filterSubOptions input[type="checkbox"]').prop("checked",a.prop("checked"))},$(document).on("change",'.jsToggleSubOptions .filterOptions:has(.filterSubOptions) > input[type="checkbox"]',b),$(document).on("change",'.jsToggleSubOptions .filterSubOptions input[type="checkbox"]',a)}(),function(){"use strict";function a(){var a=b(d());$(".jsRespImg").each(function(){var a=$(this);f(a)}),$(".syn-img.placeholder").addClass(a)}var b,c,d,e,f,g,h=["xs","sm","md","lg"],i=module.require("signal");b=function(a){var b="lg";return a>=801?b="lg":a>=460?b="md":a>=241?b="sm":a>0&&a<=240&&(b="xs"),b},c=function(a,c){var e="lg",f="lg",g=d();return g?(e=b(g),f=e,"cnt"!==a.data("img-type")&&"sub"!==a.data("img-type")||(c.hasClass("threequarter")?f="xs"===e?"sm":"md":c.hasClass("half")?f="xs"===e?"xs":"md":c.hasClass("quarter")?f="xs":"xs"===e?f="sm":"lg"!==e&&(f="md")),f):f},d=function(){var a=$(window).width();return screen&&(a=Math.max(a,screen.width,screen.height)),a},e=function(a,b){return!a.is(".suppressZoom")&&!a.parents(".suppressZoom").length&&(!b||"lsr"!==a.data("img-type")&&"sqr"!==a.data("img-type")?b:$("body").hasClass("PublicationArticle")||$("body").hasClass("NewsArticlePage"))},g=function(a,b,c){var d="",e=b||(c?"xs":"lg"),f=c?h.slice().reverse():h;return $.each(f,function(b,c){if(a.hasOwnProperty(c)&&(d=a[c]),c===e)return!1}),d},f=function(a){var b,d,f=$("<img />"),h=a.getAttributes("data-img-size-",!0),i=a.data("zoom"),j=a.data("ctv-image"),k="";if($.each(a.getAttributes("data-img-att-",!0),function(a,b){f.attr(a,b)}),d=c(a,f),k=g(h,d),e(a,i)||(i=""),f.data("zoom",i),f.attr("data-largest",g(h)),f.attr("data-smallest",g(h,"xs",!0)),f.attr("data-ctv-image",j),f.attr("src",k),i&&!a.parents("a").exists())return b=$("<a />"),b.addClass("zoom"),b.attr("href",i),b.attr("target","_blank"),b.attr("rel","noreferrer noopener"),b.append(f),void a.replaceWith(b);a.replaceWith(f)},i.listen("DOMReady",a)}(),$(function(){"use strict";$(".jsRandomImg").each(function(){var a=$(this),b=$("<img />"),c=a.getAttributes("data-img-",!0,!1),d=0;c.length&&(d=Math.floor(Math.random()*c.length),b.attr("src",c[d]),a.replaceWith(b))})}),$(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m=module.require("GalleryCollection"),n=module.require("GalleryImage"),o=module.require("GalleryVideo"),p=module.require("MediaGalleryModal"),q=module.require("signal");b=function(a){var b=_.map($("img.sub, img.seg"),function(b){return{url:$(b).attr("src"),zoomSrc:$(b).data("zoom")||$(b).attr("data-largest"),selected:$(b).attr("src")===a,type:"image"}});d(b)},g=function(a){var b={};return b.url=a.attr("data-jsonurl"),b.posterImage=a.attr("data-poster"),b.type="video",b},h=function(a){var b={},c=a.find("video");return b.url=a.attr("data-jsonurl"),b.posterImage=c.attr("poster"),b.type="video",b},i=function(a,b){var c={};return c.url=a.attr("src"),c.zoomSrc=a.attr("data-largest"),c.type="image",c.selected=b===a.attr("src"),c},j=function(a,b){var c={};return c.url=a.data("zoom"),c.type="image",c.selected=b===c.url,c.zoomSrc=c.url,c},k=function(a,b){var c={},d=a.find("img"),e=d.data("zoom")||d.attr("src");return d.hasClass("seg")||d.hasClass("sub")?null:(c.url=d.attr("src"),c.zoomSrc=d.data("zoom")||d.attr("data-largest"),c.type="image",c.selected=e===b,c)},l=function(a,b){var c={},d=a.attr("src");return a.hasClass("seg")||a.hasClass("sub")?null:(c.url=a.data("ctv-image"),c.zoomSrc=a.data("ctv-image"),c.type="image",c.selected=d===b,c)},e=function(a){var b=[],c={};_.forEach($("a.zoom, img[data-ctv-image], div.dc-bgImageZoomable, img.gen-flipbook, a.jsLinkedVideo, div.jsMediaPlayer"),function(c){$(c).hasClass("jsLinkedVideo")?b.push(g($(c))):$(c).hasClass("jsMediaPlayer")?b.push(h($(c))):$(c).hasClass("gen-flipbook")?b.push(i($(c),a)):$(c).hasClass("dc-bgImageZoomable")?b.push(j($(c),a)):$(c).hasClass("zoom")?b.push(k($(c),a)):$(c).data("ctv-image")&&b.push(l($(c),a))}),c={},b=b.filter(function(a){return!(!a||c[a.url])&&(c[a.url]=!0,!0)}),d(b)},f=function(a){var b,c;return c=a.find(function(a){return!0===a.selected}),c&&(b=c.src),e(b)},c=function(a){var c=$(this).find("img"),d=c.data("zoom")||c.attr("src");return a.preventDefault(),c.hasClass("seg")||c.hasClass("sub")?b(c.attr("src")):e(d)},a=function(a){var b=$(this),c=b.data("zoom"),d=b.css("background-image");c&&d&&d.includes("url")&&a.target===this&&(a.preventDefault(),e(c))},d=function(a){var b,c,d,e,f=0;b=_.map(a,function(a,b){return"image"===a.type?(a.selected&&(f=b),new n({url:a.url,zoomSrc:a.zoomSrc,index:b,caption:a.caption,thumburl:a.url})):(e=new o,e.jsonurl=a.url,e.index=b,e.posterImage=a.posterImage,e.thumburl=a.posterImage,e)}),c=new m(b),c.setCurrentIndex(f),d=new p(c),d.open()},$(document).on("click","a.zoom",c),$(document).on("click",".dc-bgImageZoomable",a),q.listen("ZoomImage:OpenGalleryForFlipbookImages",f)}),function(a,b){"use strict";var c=module.require("signal"),d=module.require("autocomplete");c.listen("DOMReady",function(){b("select.jsAutoComplete").each(function(){var a=b(this),c=a.data("max-columns")||4,e=a.hasClass("jsShowFeatured");d.init(a,{maxColumns:c,showFeatured:e})})})}(window,jQuery),function(){"use strict";var a,b=module.require("signal"),c=module.require("StreamingController");a=function(){$(":not(.jsPlayerLoading):not(.jsPlayerLoaded) > .jsMediaPlayer").each(function(){var a=$(this),b=a.data("jsonurl");c.from_url(b,a)})},b.listen("DOMReady",function(){a()})}(),$(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p=module.require("signal"),q=module.require("PubMediaResource"),r=module.require("loadingIndicator"),s=module.require("BibleVerseRange"),t=module.require("url"),u=module.require("settings"),v=module.require("FinderLink");$("#signLanguageBibleData").length&&($(".slContentText .verseNum a, .slContentText .chapterNum a").each(function(){var a=$(this),b=a.attr("href");a.attr("href",b+"-")}),l=function(){return $(".jsSignLanguageChapters").length<1?$.when():i().then(function(a){$(".jsSignLanguageChapters").each(function(){$(this).find("a.chapter, li.chapter a").each(function(){var b=$(this);_.contains(a,b.data("chapter"))||(b.addClass("disabled").removeAttr("href"),b.attr("aria-disabled",!0))})})})},m=function(){return $(".outline .chapterNo").length?i().then(function(a){$(".outline .chapterNo").each(function(){var b,c=$(this),d=c.children("p").children("a").first();d.length&&(b=new s(d.data("targetverses"),d.data("bible")),_.contains(a,b.start.chapter)||c.find("a.jsBibleLink").contents().unwrap())})}):$.when()},k=function(a,b){var c;return c={docid:f,wtlocale:u.getPageConfig("WT_LANG")},a&&(c.book=a,b&&(c.chapter=b)),v.create(c)},j=function(a,b){var c,d,e={};return a.sort(function(a,b){return a-b}),c=_.filter(a,function(a){return a>b}),c.length?e.next=_.first(c):e.next=-1,d=_.filter(a,function(a){return a<b}),d.length?e.prev=_.last(d):e.prev=-1,e},n=function(c,d){function f(a,b){-1===b?a.attr("href",k()):a.attr("href",k(b)),a.data("book",b),a.data("chapter",null)}var g,l,m=c.data("book"),n=c.data("chapter");return m?"prev"!==d||b?_.contains(e,m)?n?i().then(function(b){if(!_.contains(b,n)){if(-1===(l=j(b,n)[d]))return g="next"===d?j(e,m).next:a,void f(c,g);c.attr("href",k(m,l)),c.data("chapter",l)}}):$.when():(g=j(e,m)[d],f(c,g),$.when()):(g=j(e,a).prev,-1===g?(f(c),$.when()):h(g).then(function(a){l=_.max(a),c.attr("href",k(g,l)),c.data("chapter",l),c.data("book",g)})):$.when()},i=function(){return g||(g=h(a))},h=function(a){var b,d,e=u.getPageConfig("WT_LANG");return b=t.parse(u.getPageConfig("PUBMEDIA_URL")),b.query.pub=c,b.query.langwritten=e,b.query.txtCMSLang=e,b.query.booknum=a,b.query.alllangs=0,b.query.output="json",b.query.fileformat=u.getSetting("VIDEO_FORMATS"),d=new q(t.build(b)),d.listFileTypes().then(function(a){return _.reduce(a,function(a,b){return a.then(function(a){return d.listTrackNums(e,b.name).then(function(b){return _.union(b,a)})})},$.when([]))}).then(function(a){return _.chain(a).unique().value().sort(function(a,b){return a-b})})},o=function(){var a=$(".bibleNav select#Book").val();return $(".bibleNav select#Chapter").length?h(a).then(function(a){$(".bibleNav select#Chapter").each(function(){$(this).find("option").each(function(){var b=$(this);_.contains(a,parseInt(b.val()))||b.remove()})})}):$.when()},p.listen("PublicationFilter:Refreshed",function(a){"Book"===a.attr("id")&&o()}),p.listen("DOMReady",function(){return d=$("#signLanguageBibleData").data("available-video-books"),e=_.map(d,function(a,b){return parseInt(b,10)}),a=$("#signLanguageBibleData").data("book"),b=$("#signLanguageBibleData").data("chapter"),c=$("#signLanguageBibleData").data("bible"),f=$("#signLanguageBibleData").data("reading-page-doc-id"),r.open(),l().then(m).then(function(){return o(a)}).then(function(){$(".navLinkNext a").each(function(){n($(this),"next")}),$(".navLinkPrev a").each(function(){n($(this),"prev")})}).then(r.close)}))}),function(){"use strict";var a,b=module.require("Chart"),c=module.require("settings"),d=module.require("signal"),e=c.getSetting("IS_RTL");a=function(){var a,c=$(this),d=c.data("json-id"),f=c.data("json-schema"),g=c.data("json-config"),h=c.data("json-payload");d&&f&&g&&h&&(a=$.extend(!0,{RTL:e},g,h),c.children().hide(),c.append('<div id="'+d+'" class="jsChart" />'),new b(f,d,a).create())},Modernizr.canvas&&d.listen("DOMReady",function(){$("[data-json-schema]").not(".jsChartInitialized").addClass("jsChartInitialized").each(a)})}(),function(a,b){"use strict";var c,d,e,f,g=module.require("settings");b("html").hasClass("ie8")||(c=module.require("signal"),d=module.require("MediaGallery"),e=module.require("GalleryCollection"),f=module.require("MediaGalleryModal"),c.listen("DOMReady",function(){b(".jsMediaGallery").not(".jsHasMediaGallery").each(function(c,h){var i,j,k;h=b(h),h.addClass("jsHasMediaGallery"),i=e.fromElement(h.find(".jsGalleryDataSource").first()),j=new d(h,i),j.on("firstRender:post",function(){b(".jsGalleryDataSource").css("display","none"),j.goToFirstSlide(),h.find(".jsGalleryFullscreenBtn").on("click",function(){var a=new f(i);a.on("close:pre",function(){j.prepareForDisplay()}),a.open()})}),k=function(){var a=this.lookupScope.find(".jsSlideContainer"),b=this.lookupScope.find(".jsDisplayArea"),c=g.getSetting("IMAGE_GALLERY_IMAGE_RATIO"),d=a.width()*c;b.height(d),a.find("img").css("max-height",d+"px")}.bind(j),j.on("slide:rendered",k),b(a).resize(function(){k()}),j.render()})}))}(window,jQuery),function(){"use strict";var a,b,c=module.require("SimpleModal"),d=module.require("legalNotices"),e=$("#templates .template.preDisplayVerification").children(),f=$("body").attr("id"),g=new Date,h=g.getFullYear(),i="userPref-preDisplayVerification-"+f+"-verified-"+h;e.length&&d.canPersistFunctional().then(function(d){d&&$.storedData(i)||(b=e.clone(),b.find(".jsYes").on("click",function(a){a.preventDefault(),d&&$.storedData(i,!0),c.close()}),a=new c(b),a.updateSettings({closeOnEscapeKey:!1,closeOnOverlayClick:!1,maxWidth:400}),a.open())})}(),function(){"use strict";var a,b,c,d,e=module.require("signal"),f=module.require("url"),g=module.require("legalNotices"),h=".jsDocSubImgToggleWrapper .toggle";a=function(){return $("#docSubImgWrapper").data("setting")},b=function(){var b=a();return b?$.storedData(b):void 0},c=function(b){var c=a();c&&$.storedData(c,b)},d=function(a){var b=$("#"+a),c=$(h+".current").data("target-type"),d=b.data("hide-on-open"),f=b.data("show-on-open");"docSubVideo"!==a&&"docSubVideo"!==c||e.send("requestSilence"),$("#docSubImgWrapper .docSubContent").removeClass("current"),b.addClass("current"),$(h).removeClass("current"),$(h+'[data-target-type="'+a+'"]').addClass("current"),d&&$(d).slideUp().animate({opacity:0},{queue:!1,duration:"slow"}),f&&$(f).slideDown().animate({opacity:1},{queue:!1,duration:"slow"}),$(h).attr("aria-pressed","false"),$(h+".current").attr("aria-pressed","true"),e.send("docSubImageChange")},$(document).on("click",h,function(a){var b=$(this).data("target-type");a.preventDefault(),d(b),g.callIfFunctionalAllowed(function(){c(b)}),$("#docSubImgWrapper").trigger("on:change:DocSubContent",{newTargetType:b})}),$(document).on("StreamingController:on:ready",function(a){$(a.target).closest("#docSubImgWrapper").siblings(".jsDocSubImgToggleWrapper").find('.toggle[data-target-type="docSubVideo"]').removeClass("hidden")}),e.listen("DOMReady",function(){var a;a=$("#docSubImgWrapper").siblings(".jsDocSubImgToggleWrapper").find('.toggle[data-target-type="docSubVideo"]'),a.hasClass("current")&&$(".jsHideForDocSubVideo").hide(),$(h+".current").attr("aria-pressed","true"),g.callIfFunctionalAllowed(function(){var a,c;a=f.parse(decodeURI(window.location.href)),a.query&&a.query.content||(c=b())&&$(h+'[data-target-type="'+c+'"]').length&&d(c)})})}(),function(){"use strict";var a,b=module.require("signal");a=function(){var a=new Date,b=a.getFullYear();$(this).html(b)},b.listen("DOMReady",function(){$(".jsCurrentYear").each(a)})}(),function(a,b){"use strict";var c,d,e=b.require("ShareModal"),f=b.require("signal");c=function(b){var c=a(b).closest("div").find("input");c.focus().get(0).setSelectionRange(0,c.val().length)},d=function(b,c,d){a(".shareButtonWrapper .data").each(function(){d&&!a(this).data("is-current-page")||a(this).find(".link").data(b,c)})},a(document).on("click",".jsShare",function(a){a.preventDefault(),(new e).open(a.target)}),a(document).on("click","input.shareLink[type=text]",function(a){c(a.target)}),f.listen("VideoModal:languageChanged",function(a){a.isModalEmbedded&&d("vidlang",a.currentLang,!0)})}(jQuery,module),function(){"use strict";function a(a,b){var c,d,e;if(a.verseNumber){for(e=a.verseNumber.toString();e.length<3;)e="0"+e;d=b.find("[id^=v][id$="+e+"]").filter(function(){return this.id.match(/v\d{7,8}/)}).first(),d&&(c="*[id='%s'], *[class~='%s']".format($(d).attr("id"),$(d).attr("id")))}return a.mepsParagraphId&&(c="*[data-pid='"+a.mepsParagraphId+"']"),!!c&&b.find(c)}var b=module.require("signal");b.listen("StreamingControllerInitialized",function(c){function d(d,f){var g=a(f,$(e));g&&b.send(d,{marker:f,player:c.getPlayer(),el:g})}var e,f=c.getWrapperElem(),g=c.getPlayer();f.hasClass("jsMarkersEnabled")&&(e=f.data("highlighter_target"))&&(g.on("markerStarted",function(a){d("MarkerStarted",a)}),g.on("markerEnded",function(a){d("MarkerEnded",a)}))})}(),function(a,b){"use strict";var c,d,e,f,g,h=module.require("signal");c=function(a){var c,f=b(a.data("results-selector")),h=b(a).data("initial-tag"),i=b(a.find(".jsPubviewsSectionFilter"));h||b(a).find(".jsPubviewsGridButtonAll").exists()||(c=b(i.find("a")[0]))&&(h=c.data("target-tag")),d(i,f),e(b(a.find(".jsPubviewsTagFilter")),f),h&&g(f,b(a.find(".jsPubviewsSectionFilter")),h)},d=function(a,c){a.find("a").each(function(){var a=b(this);a.removeAttr("href"),a.attr("role","button")}).click(function(d){d.preventDefault(),g(c,a,b(this).data("target-tag"))})},g=function(a,b,c){f(a,b,c),f(b,b,c)},e=function(a,c){a.find("input[type=radio]").change(function(){f(c,a,b(this).data("target-tag"))})},f=function(a,c,d){var e=a.find("[data-tags]"),f=c.data("filter-class"),g=c.data("highlight-class");a.removeClass(f),e.removeClass(g),void 0!==d&&(a.addClass(f),e.each(function(){var a=b(this);-1!==a.data("tags").indexOf(d)&&a.addClass(g)})),a.trigger("on:filter:pubviews-results")},h.listen("DOMReady",function(){if(b(".jsPubviewsFilter").each(function(){c(b(this))}),a.location.hash){var d,e=a.location.hash.replace("#",""),f=b(".jsPubviewsSectionFilter");d=f.find("a").map(function(){return b(this).data("target-tag")}),_.contains(d,e)&&g(b("#jsPubviewsTOCResults"),f,e)}})}(window,jQuery),function(a,b){"use strict";module.require("signal").listen("DOMReady",function(){b("#jsPubviewsTOCResults").on("on:filter:pubviews-results",function(){var a,c=b(this);c.find(".pubviewsTOCSection").removeClass("jsPubviewHasFilteredResults").not(function(){return 0===b(this).find(".termFilterHighlight").length}).each(function(){b(this).addClass("jsPubviewHasFilteredResults")}),a=function(a,b,c){a.removeClass(c),a.find(b).length>0&&a.addClass(c)},a(c,".pubviewsTOCSection.sectionFilterHighlight.jsPubviewHasFilteredResults","jsPubviewFilteredSectionsHaveResults"),a(c,".pubviewsTOCSection .termFilterHighlight","jsPubviewTermFilterHasResults")})})}(window,jQuery),function(a,b){"use strict";module.require("signal").listen("DOMReady",function(){var c=b(".jsDropdownSearchBar"),d=c.data("autocomplete");c.on("autocomplete-option-selected",function(){var b=c.find(":selected[data-url]");a.location.href=b.data("url")}),d&&c.parents("#sidebarTOC").length&&d.configureSelector(c.parents("#sidebarTOC"),!1,!0)})}(window,jQuery),function(){"use strict";function a(){c.close(),d.closeAll(),e.closeAll()}var b=module.require("signal"),c=module.require("SimpleModal"),d=module.require("ScriptureDialog"),e=module.require("ExcerptDialog");b.listen("CloseAllModals",a)}(),function(){"use strict";var a=module.require("signal"),b=module.require("autocomplete"),c=module.require("url"),d=module.get("Navigation");a.listen("DOMReady",function(){var a=$("select.jsAutoCompleteFilter");a.exists()&&(b.init(a,{maxColumns:a.data("max-columns"),showFeatured:a.hasClass("jsShowFeatured")}),a.on("change",function(){var a=$(this).attr("name"),b=d.getURL(),e=c.parse(b);e.query[a]=$(this).val(),$("article").html('<div class="loadingIndicator" />'),$("#pubListResults").html(""),d.navigateToURL(c.build(e))}))})}(),function(a,b){"use strict";var c,d=module.require("signal"),e=module.require("settings"),f=module.require("url"),g=module.require("guid"),h=module.require("StreamingController"),i=module.require("StringUtils"),j=module.require("PubMediaResourcePreloader");c=Class.extend({init:function(c){var d=this,e=new j;this.setupExtraAudioControls(),e.preload(c).then(function(c){var e,g=f.parse(a.location.href).query,h=g.media;if(0===c.length)return void b("#content").addClass("jsNoFilesFound");b("#content").removeClass("jsNoFilesFound"),e=d.findMediaResource(c,h),c.length>1?d.setupResourcePicker(c,e.pubSymbol):d.setupSingleResourceDisplay(e),d.selectMediaResource(e)})},setupResourcePicker:function(a,c){var d=this,e=b(".jsMediaVariationSelector"),f=b(".jsMediaVariationSelectorContainer");e.empty(),_.each(a,function(a){var d=b("<option></option>");d.html(i.stripRubyText(a.title)),d.val(a.pubSymbol),a.pubSymbol===c&&d.prop("selected",!0),e.append(d)}),f.addClass("select-icons"),e.on("change",function(){var c=b(this).find("option:selected");d.selectMediaResource(d.findMediaResource(a,c.val()))})},setupSingleResourceDisplay:function(a){var c=b("<p></p>");c.html(a.title),b(".jsMediaVariationSelector").replaceWith(c)},setupExtraAudioControls:function(){var a,c=this;a=function(a){var b;c.streamingController&&(b=c.streamingController.getPlayer())&&a(b)},b("#playContinuouslyCheckbox").click(function(){var c=!this.checked;c&&b("#shuffleCheckbox").prop("checked",!1),a(function(a){c&&a.unshuffle(),a.setAutoAdvanceEnabled(!c)})}),b("#shuffleCheckbox").click(function(){var c=this.checked;c&&b("#playContinuouslyCheckbox").prop("checked",!0),a(function(a){c?(a.setAutoAdvanceEnabled(!0),a.shuffle(a.hasCurrentItemPlayed()&&!a.hasCurrentItemEnded())):a.unshuffle()})})},addMediaTypeToLinks:function(a){function c(b){var c=f.parse(b);return c.query.media=a,f.build(c)}b("#musicTOC .musicFileContainer .fileTitle a, #musicTOC .song a, .articleNavLinks a").each(function(){var a=b(this);a.attr("href",c(a.attr("href")))}),b('select[data-autocompleteclass="autoCompleteSongSearch"] option').each(function(){var a=b(this);a.data("url",c(a.data("url")))})},selectMediaResource:function(a){var c=a.pubMedia.getPlaylist().build(),d=b(".musicDownloadOnlyContent");this.streamingController?a.pubMedia.listFiles().then(function(c){this.streamingController.loadPlaylist(c,a.pubMedia.sourceURL,{ignoreMarkers:!1,shouldShuffle:!!b("#shuffleCheckbox").prop("checked")})}.bind(this)):this.initStreamingController(a.pubMedia,{playOne:!b("#playContinuouslyCheckbox").prop("checked"),playShuffled:!!b("#shuffleCheckbox").prop("checked"),trackIdentifierField:"track"}),this.addMediaTypeToLinks(a.pubSymbol),c.then(function(a){var c=b("#musicTOC .musicList"),e=b(".jsMusicFileContainerTemplate").find(".musicFileContainer"),f=b(".jsMediaVariationContainer").attr("id"),g=b("#musicTOC .musicFileContainer button");d.length?(d.removeClass("loading"),c.empty(),_.each(a,function(a){var b=e.clone();b.find(".fileTitle").html(a.title),b.attr("data-trackid",a.track),b.attr("data-mediaplayer",f),b.find(".jsTrackPlay").attr("data-trackid",a.track),b.find(".jsTrackPlay").attr("data-mediaplayer",f),c.append(b)})):(g.addClass("disabled"),g.attr("aria-disabled",!0),_.each(a,function(a){g.filter("*[data-trackid="+a.track+"]").removeClass("disabled").attr("aria-disabled",!1)}))})},initStreamingController:function(a,c){var d=b(".jsMediaVariationPlayer"),e="MediaVariationController-"+g.generate("xxxxxxxx");!this.streamingController&&d.exists()&&(b("#musicTOC .musicFileContainer button").attr("data-mediaplayer",e),b("#musicTOC .musicFileContainer").attr("data-mediaplayer",e),d.attr("id",e),b(".jsMediaVariationContainer").attr("id",e),d.attr("data-jsonurl",a.sourceURL),this.streamingController=new h(d,a,c))},findMediaResource:function(a,b){var c=a[0];return b&&(c=_.findWhere(a,{pubSymbol:b.toLowerCase()})||c),c}}),d.listen("DOMReady",function(){var a=e.getPageConfig("MEDIA_RESOURCES"),d=b(".jsMediaVariationContainer").not(".jsMediaVariationControllerInitialized");a&&d.length&&(d.addClass("jsMediaVariationControllerInitialized"),new c(a))})}(window,jQuery),function(){"use strict";module.require("signal").listen("DOMReady",function(){$("#jsPanoSliderList").not(".jsPanoSliderInitialized").addClass("jsPanoSliderInitialized").slippry({elements:"li",adaptiveHeight:!1,start:"random",captions:!1,pager:!1,prevClass:"panoSliderPrevButton",nextClass:"panoSliderNextButton",transition:"horizontal",speed:800,autoHover:!1,pause:8e3})})}(),function(){"use strict";var a,b=module.require("signal");a=function(a,b){var c;return c=$("<span>").attr("aria-hidden","true").addClass("button-icon"),$("<a>").attr("role","button").addClass(a).attr("aria-label",b).html(c).prop("outerHTML")},b.listen("DOMReady",function(){$(".jsSynCarousel:not(.slick-initialized)").each(function(){var b=$(this);b.children("div.synopsis").wrap("<div></div>"),b.slick({infinite:!1,mobileFirst:!0,rtl:"rtl"===b.css("direction"),swipe:!1,arrows:!1,prevArrow:a("slick-prev",_t("CMSPUBS.LnkPrev")),nextArrow:a("slick-next",_t("CMSPUBS.LnkNext")),responsive:[{breakpoint:759,settings:{swipe:!0,arrows:!0,slidesToShow:3,slidesToScroll:3}}]})})})}(),function(){"use strict";var a,b,c=module.require("signal"),d=module.require("AlertRetriever"),e=module.require("AlertRenderer"),f=module.require("settings"),g=new e,h=window.sprintf;a=function(a,b,c){var d,e,f=b.alerts||[],i=b.pagination||{},j=i.totalCount||0;_.each(f,function(b){a.append(g.render(b,c.fields))}),j>1?(d=$(".jsAlertItemCount"),e=h(_t("CMSJSUISTR.LblItemOf"),f.length,j),d.text(e)):$(".jsAlertItemCount").remove()},b=function(a){var b=$(a).offset().top;f.getSetting("IS_MOBILE_LAYOUT")&&(b-=$("#mobileNavTopBar").outerHeight()),$(window).scrollTop(b)},c.listen("DOMReady",function(){var e=$(".jsAlertModule").not(".jsAlertsLoading").not(".jsAlertsLoaded").not(".jsNoAlerts"),f=new d;e.length<1||e.each(function(){var d=$(this),e="#"+d.attr("id"),g=d.data("fields")?d.data("fields").split(","):void 0;d.addClass("jsAlertsLoading"),f.fetch(d.data("url")).then(function(f){var h;if(d.removeClass("jsAlertsLoading"),!f||!f.alerts||0===f.alerts.length)return void d.addClass("jsNoAlerts");h=d.find(".jsAlertList"),a(h,f,{fields:g}),d.addClass("jsAlertsLoaded"),window.location.hash===e&&b(e),c.send("DOMReady")})})})}(),function(){"use strict";var a,b=module.require("signal"),c=module.require("settings"),d=module.require("url"),e=module.require("BibleVerseRange"),f=module.require("BibleVerseRangeCollection"),g=module.require("ScriptureDialog"),h=c.getPageConfig("PREFERRED_BIBLE"),i=c.getPageConfig("PREFERRED_BIBLE_AVAILABLE_VERSES"),j=i?new e(i):void 0;a=function(a){return d.parse(a).query.ranges},b.listen("DOMReady",function(){$('a[href^="https://www.jw.org/bible"]').each(function(){var b,c=$(this),d=a(c.attr("href")),e=new f(d);if(!(d&&h&&j&&j.doesContainRangesInCollection(e)))return void c.replaceWith($("<span>").addClass("inactiveBibleLink").html(c.html()));c.addClass("jsPseudoBibleLink"),c.attr("href","#"),b=new g(d,h),c.on("click",function(a){a.preventDefault(),b.isOpen||(b.dialogClass=$(this).data("dialogsource"),b.open())})})})}(),function(){"use strict";var a=module.require("AlertsModal");$(document).on("click",".jsAlertsModal[data-alerts-url]",function(b){var c=$(this),d=new a({title:c.data("title")});b.preventDefault(),d.openWithURL(c.data("alerts-url"))})}(),function(){"use strict";var a=module.require("AppearanceSettingsModal")
;$(document).on("click",".jsShowAppearanceSettings",function(b){var c=new a;b.preventDefault(),c.open()})}(),function(){"use strict";var a,b,c,d=module.require("signal"),e=module.require("settings"),f=e.getSetting("IS_RTL");a=function(a){var b,c,d,e=a,g=$(a.data("scroll-state-notify"));g.length>0&&(e=g),e.removeClass("jsScrollStateXAtStart jsScrollStateXAtEnd"),b=a.scrollLeft()<=20,c=a.prop("scrollWidth")-a.scrollLeft()-a.prop("clientWidth")<=20,f&&(d=b,b=c,c=d),b&&e.addClass("jsScrollStateXAtStart"),c&&e.addClass("jsScrollStateXAtEnd")},b=_.throttle(a,100),c=function(){$(".jsScrollState").each(function(){a($(this))})},d.listen("DOMReady",function(){c(),$(".jsScrollState").not(".jsHasScrollStateListener").addClass("jsHasScrollStateListener").scroll(function(){b($(this))})}),$(window).on("resize",_.throttle(c,100))}(),function(){"use strict";function a(){$('link[rel="canonical"]').attr("href",document.location.href)}module.require("signal").listen("cmmRouteChanged",function(){a()})}(),function(){"use strict";function a(a){var c=a.closest(".jsDropdownNav"),f=a.find(".jsDropdownNavButton"),g=a.find(".jsDropdownSubNav"),i=a.position().top+a.outerHeight(!0);b(c.find(".jsDropdownNavItem.jsDropdownNavOpen")).then(function(){f.attr("aria-expanded","true"),a.addClass("jsDropdownNavOpen"),g.css("top",i),g.hide().slideDown(h),$(document).on("click",d),$(document).on("keydown",null,"esc",e)})}function b(a){var b=a.find(".jsDropdownNavButton");return a.length?(a.addClass("jsDropdownNavClosing"),$(document).off("click",d),$(document).off("keydown",e),a.find(".jsDropdownSubNav").slideUp(h).promise().then(function(){b.attr("aria-expanded","false"),a.removeClass("jsDropdownNavOpen jsDropdownNavClosing")})):$.Deferred().resolve()}function c(c){var d=$(c.target),e=d.closest(".jsDropdownNavItem");if(!f.getSetting("IS_SMALL_LAYOUT")){if(c.preventDefault(),e.hasClass("jsDropdownNavOpen"))return void b(e);a(e)}}function d(a){$(a.target).closest(".jsDropdownNavItem").length||b($(".jsDropdownNavItem.jsDropdownNavOpen"))}function e(){var a=$(".jsDropdownNavItem.jsDropdownNavOpen");b(a).then(function(){a.find(".jsDropdownNavButton").focus()})}var f=module.require("settings"),g=module.require("signal"),h="fast";$(document).on("click",".jsDropdownNavItem .jsDropdownNavButton",c),$(document).on("keydown",".jsDropdownNavItem .jsDropdownNavButton","space",c),$(document).on("click",".jsDropdownNavCloseButton",e),$(document).on("click",".subNavItem a",e),g.listen("DOMReady",function(){f.getSetting("IS_SMALL_LAYOUT")||($(".jsDropdownNavItem .jsDropdownNavButton").attr("aria-expanded","false"),$(".jsDropdownNavItem .jsDropdownNavButton").attr("aria-haspopup","true"))})}(),function(){"use strict";function a(a){a?$(".jwac").addClass(l):$(".jwac").removeClass(l)}function b(){document.body.classList.contains(k)||document.body.classList.add(k)}function c(){document.querySelectorAll("."+k).forEach(function(a){a.classList.remove(k)})}function d(){return null!==document.querySelector("ruby")}function e(){d()?b():c()}function f(){function a(){var a=document.getElementById("article");return a&&a.classList.contains(l)}function b(){e(),a()&&document.querySelectorAll(".jwac:not(."+l+")").forEach(function(a){a.classList.add(l)})}return p.create(b,document.body)}function g(){j||(j=f())}function h(){j&&(j.disconnect(),j=null)}var i,j,k="hasRuby",l="showRuby",m="userPref-rubyTextEnabled",n=module.require("signal"),o=module.require("legalNotices"),p=module.require("ClassPresenceObserver");i=[{code:"J",className:"ml-J",controlLabel:_t("CMSPUBS.LblDisplayFurigana")},{code:"CHS",className:"ml-CHS",controlLabel:_t("CMSPUBS.LblDisplayPinyin")},{code:"CH",className:"ml-CH",controlLabel:_t("CMSPUBS.LblDisplayPinyin")},{code:"CHC",className:"ml-CHC",controlLabel:_t("CMSPUBS.LblDisplayYaleRomanization")},{code:"CNS",className:"ml-CNS",controlLabel:_t("CMSPUBS.LblDisplayYaleRomanization")}],n.listen("DOMReady",function(){o.canPersistFunctional().then(function(b){var d,f=$("#article"),j=b?$.storedData(m)||{}:{};if(!(d=_.find(i,function(a){return f.hasClass(a.className)})))return c(),void h();e(),g(),a(!!j[d.code]),$("#displayRubyCheckbox").prop("checked",!!j[d.code]).data("ml-code",d.code),$(".rubyCheckboxLabel .rubyCheckboxText").html(d.controlLabel)})}),$(document).on("click","#displayRubyCheckbox",function(){var b=$(this).data("ml-code"),c=this.checked;a(c),o.callIfFunctionalAllowed(function(){var a=$.storedData(m)||{};a[b]=c,$.storedData(m,a)})})}(),function(){"use strict";var a,b=module.require("signal");a=function(a,b){var c;return c=$("<span>").attr("aria-hidden","true").addClass("button-icon"),$("<a>").attr("role","button").addClass(a).attr("aria-label",b).html(c).prop("outerHTML")},b.listen("DOMReady",function(){$(".jsDocumentSegmentCarousel:not(.slick-initialized)").each(function(){var b=$(this);b.children().wrap("<div></div>"),b.on("init",function(){b.find(".slick-slide:not(.slick-active)").addClass("slick-hidden")}),b.on("beforeChange",function(){b.find(".slick-slide:not(.slick-active)").removeClass("slick-hidden")}),b.on("afterChange",function(){b.find(".slick-slide:not(.slick-active)").addClass("slick-hidden")}),b.slick({infinite:!1,rtl:"rtl"===b.css("direction"),swipe:!1,arrows:!0,prevArrow:a("slick-prev",_t("CMSPUBS.LnkPrev")),nextArrow:a("slick-next",_t("CMSPUBS.LnkNext"))})})}),b.listen("docSubImageChange",function(){$(".jsDocumentSegmentCarousel.slick-initialized").slick("setPosition")})}(),function(){"use strict";function a(a,b,c){return $.getJSONCached(e.join(g,a,b)).then(function(a){var b=a.url;return c&&(b+="#"+c),b})}function b(a,b){var c,d={};return $.each(a[0].attributes,function(a,b){d[b.nodeName]=b.nodeValue}),c=$("<"+b+"/>",d).append(a.contents()),a.replaceWith(c),c}var c,d=module.require("signal"),e=module.require("url"),f=module.require("settings"),g=f.getPageConfig("WOL_LINK_API_URL");c=function(){var c=$(this),d=c.data("lank");a(c.data("lang"),d,c.data("highlightrange")).then(function(a){var d;if(!a)return void c.addClass("noDocLink");d=b(c,"a"),d.attr("href",a),d.removeClass("disabled")}).fail(function(){c.addClass("noDocLink")})},d.listen("DOMReady",function(){$(".jsReadOnWOLLink").each(c)})}(),function(){"use strict";function a(a){a.preventDefault(),b.client.showSettings()}var b=module.require("legalNotices");$(document).on("click",".jsPrivacySettings",a),$(document).ready(function(){"#privacy-settings"===window.location.hash&&b.client.showSettings()})}(),function(){"use strict";function a(){return $("body").hasClass("docId-1001070103")}if($("body").hasClass("StudyBible")){var b,c,d=module.require("MediaPage"),e=module.require("signal");c=$("<span></span>").addClass("pageName").html(d.PAGE_TITLE),b=$("<a></a>").attr("href",window.location.href).attr("data-page-id",d.PAGE_ID).addClass($("body").attr("class")).addClass("appendix jsBibleNavigation jsMediaPageLink").append(c),e.listen("DOMReady",function(){if(a()){var c=$(".jsStudyBibleAddPages");c.find(".jsMediaPageLink").exists()||c.append(b)}})}}(),function(){"use strict";var a,b,c,d,e,f,g=$("body"),h=module.require("settings");g.hasClass("BiblePublicationArticle")&&g.hasClass("docId-1001061173")&&g.hasClass("docId-1001061175")&&(a=$("#article p.docNav"),b=a.find("a"),c=$(".jsViewportPin"),d=$("#article h2"),e=module.get("AnchorLinkController"),b.removeAttr("target"),c.exists()&&a.exists()&&a.appendTo(c),d.each(function(){var a=$(this),b=$("<button></button>").attr("type","button"),c=a.html(),d=$("<i></i>"),e=a.next();d.addClass("jwf-jw-icons-external jwi-chevron-left"),b.addClass("accordionButton"),b.append($("<span></span>").addClass("accordionButton-text").html(c)),b.append($("<span></span>").addClass("accordionButton-icon").html(d)),a.html(b),a.addClass("jsExpandCollapse").addClass("accordionHeading").addClass("viewHdgCollapse").data("expandaction","viewHdgCollapse").data("collapseaction","viewHdgExpand"),e.addClass("jsCollapsableBlock").hide()}),f=function(a){var b,c,d=$("#"+a),f=h.getSetting("TEXT_HIGHLIGHT_CLASS");if(d.exists()&&(c=d.is("h2")?d.next("ul,.pGroup"):d.closest("ul,.pGroup"),b=c.prev("h2"),c.exists()&&b.exists()))return b.filter(".viewHdgCollapse").click(),$("."+f).removeClass(f),$(".jsCollapsableBlock").promise().done(function(){e.scrollTo(d,$(window))}),d.addClass(f),d},e.addTargetResolver(f))}(),function(){"use strict";var a=module.require("StringUtils");rivets.formatters.length=function(a){return a.length},rivets.formatters.addOne=function(a){return a+1},rivets.formatters["!"]=function(a){return!a},rivets.formatters.default=function(a,b){return null===a||_.isUndefined(a)?b:a},rivets.formatters.defaultLiteral=function(a,b){return null===a||_.isUndefined(a)?_t(b):a},rivets.formatters.concat=function(){var a=Array.prototype.slice.call(arguments);return _.reduce(a,function(a,b){return a+" "+b},"")},rivets.formatters.strictlyEquals=function(a,b){return a===b},rivets.formatters.strfmt=function(a,b){return b.format(a)},rivets.formatters.stripRubyText=function(b){return a.stripRubyText(b)},rivets.formatters.safeScreenReaderAttribute=function(b){return a.safeScreenReaderAttribute(b)}}(),function(){"use strict";var a=module.require("LanguageUtils");rivets.binders["update-gallery-index"]={publishes:!0,bind:function(a){var b=this,c=$(a);this.callback=function(){var a=c.data("item-index");b.view.models.controller.dataSource.setCurrentIndex(a)},$(a).on("click",this.callback)},unbind:function(a){$(a).off("click",this.callback)},routine:function(a,b){$(a).data("item-index",b)}},rivets.binders.addclass=function(a,b){b&&$(a).addClass(b)},rivets.binders["responsive-image"]=function(a,b){$(a).addClass("jsRespImg"),_.each(b,function(b,c){$(a).attr("data-img-size-"+c,b)})},rivets.binders["data-*"]=function(a,b){var c;return this.type&&(c=this.type.replace("data-",""),$(a).data(c,b)),void 0!==b?a.setAttribute(this.type,""+b):a.removeAttribute(this.type)},rivets.binders["lang-attrs"]=function(a,b){if(!b)return void $(a).removeAttr("lang").removeAttr("xml:lang").removeAttr("dir");$(a).attr("lang",b.locale).attr("xml:lang",b.locale).attr("dir",b.direction)},rivets.binders["lang-classes"]=function(b,c){var d,e=$(b),f=e.data("previous-lang-classes");f&&e.removeClass(f),c&&(d=a.createLanguageClasses(c),e.addClass(d),e.data("previous-lang-classes",d))}}(),function(){"use strict";function a(a,b,c){"string"==typeof c&&_.each(c.split(" "),function(c){a.trigger("class:"+b+":"+c,a)})}var b=$.fn.addClass,c=$.fn.removeClass;$.fn.addClass=function(c){var d=b.apply(this,arguments);return a(this,"add",c),d},$.fn.removeClass=function(b){var d=c.apply(this,arguments);return a(this,"remove",b),d}}();